<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>28.4 Endogenous Sample Selection | A Guide on Data Analysis</title>
  <meta name="description" content="This is a guide on how to conduct data analysis in the field of data science, statistics, or machine learning." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="28.4 Endogenous Sample Selection | A Guide on Data Analysis" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://bookdown.org/mike/data_analysis/" />
  <meta property="og:image" content="https://bookdown.org/mike/data_analysis//images/cover.jpg" />
  <meta property="og:description" content="This is a guide on how to conduct data analysis in the field of data science, statistics, or machine learning." />
  <meta name="github-repo" content="mikenguyen13/data_analysis" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="28.4 Endogenous Sample Selection | A Guide on Data Analysis" />
  
  <meta name="twitter:description" content="This is a guide on how to conduct data analysis in the field of data science, statistics, or machine learning." />
  <meta name="twitter:image" content="https://bookdown.org/mike/data_analysis//images/cover.jpg" />

<meta name="author" content="Mike Nguyen" />


<meta name="date" content="2022-09-17" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  <link rel="apple-touch-icon-precomposed" sizes="120x120" href="logo.png" />
  <link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<link rel="prev" href="endogenous-treatment.html"/>
<link rel="next" href="mediation.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="libs/proj4js-2.3.15/proj4.js"></script>
<link href="libs/highcharts-9.3.1/css/motion.css" rel="stylesheet" />
<script src="libs/highcharts-9.3.1/highcharts.js"></script>
<script src="libs/highcharts-9.3.1/highcharts-3d.js"></script>
<script src="libs/highcharts-9.3.1/highcharts-more.js"></script>
<script src="libs/highcharts-9.3.1/modules/stock.js"></script>
<script src="libs/highcharts-9.3.1/modules/map.js"></script>
<script src="libs/highcharts-9.3.1/modules/data.js"></script>
<script src="libs/highcharts-9.3.1/modules/exporting.js"></script>
<script src="libs/highcharts-9.3.1/modules/offline-exporting.js"></script>
<script src="libs/highcharts-9.3.1/modules/drilldown.js"></script>
<script src="libs/highcharts-9.3.1/modules/item-series.js"></script>
<script src="libs/highcharts-9.3.1/modules/overlapping-datalabels.js"></script>
<script src="libs/highcharts-9.3.1/modules/annotations.js"></script>
<script src="libs/highcharts-9.3.1/modules/export-data.js"></script>
<script src="libs/highcharts-9.3.1/modules/funnel.js"></script>
<script src="libs/highcharts-9.3.1/modules/heatmap.js"></script>
<script src="libs/highcharts-9.3.1/modules/treemap.js"></script>
<script src="libs/highcharts-9.3.1/modules/sankey.js"></script>
<script src="libs/highcharts-9.3.1/modules/dependency-wheel.js"></script>
<script src="libs/highcharts-9.3.1/modules/organization.js"></script>
<script src="libs/highcharts-9.3.1/modules/solid-gauge.js"></script>
<script src="libs/highcharts-9.3.1/modules/streamgraph.js"></script>
<script src="libs/highcharts-9.3.1/modules/sunburst.js"></script>
<script src="libs/highcharts-9.3.1/modules/vector.js"></script>
<script src="libs/highcharts-9.3.1/modules/wordcloud.js"></script>
<script src="libs/highcharts-9.3.1/modules/xrange.js"></script>
<script src="libs/highcharts-9.3.1/modules/tilemap.js"></script>
<script src="libs/highcharts-9.3.1/modules/venn.js"></script>
<script src="libs/highcharts-9.3.1/modules/gantt.js"></script>
<script src="libs/highcharts-9.3.1/modules/timeline.js"></script>
<script src="libs/highcharts-9.3.1/modules/parallel-coordinates.js"></script>
<script src="libs/highcharts-9.3.1/modules/bullet.js"></script>
<script src="libs/highcharts-9.3.1/modules/coloraxis.js"></script>
<script src="libs/highcharts-9.3.1/modules/dumbbell.js"></script>
<script src="libs/highcharts-9.3.1/modules/lollipop.js"></script>
<script src="libs/highcharts-9.3.1/modules/series-label.js"></script>
<script src="libs/highcharts-9.3.1/plugins/motion.js"></script>
<script src="libs/highcharts-9.3.1/custom/reset.js"></script>
<script src="libs/highcharts-9.3.1/modules/boost.js"></script>
<script src="libs/highchart-binding-0.9.4/highchart.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=GA_MEASUREMENT_ID"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){window.dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-DMNX2X65HQ');
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Guide on Data Analysis</a></li>

<li class="divider"></li>
<li><a href="index.html#preface" id="toc-preface">Preface</a></li>
<li><a href="introduction.html#introduction" id="toc-introduction"><span class="toc-section-number">1</span> Introduction</a></li>
<li><a href="prerequisites.html#prerequisites" id="toc-prerequisites"><span class="toc-section-number">2</span> Prerequisites</a>
<ul>
<li><a href="matrix-theory.html#matrix-theory" id="toc-matrix-theory"><span class="toc-section-number">2.1</span> Matrix Theory</a>
<ul>
<li><a href="matrix-theory.html#rank" id="toc-rank"><span class="toc-section-number">2.1.1</span> Rank</a></li>
<li><a href="matrix-theory.html#inverse" id="toc-inverse"><span class="toc-section-number">2.1.2</span> Inverse</a></li>
<li><a href="matrix-theory.html#definiteness" id="toc-definiteness"><span class="toc-section-number">2.1.3</span> Definiteness</a></li>
<li><a href="matrix-theory.html#matrix-calculus" id="toc-matrix-calculus"><span class="toc-section-number">2.1.4</span> Matrix Calculus</a></li>
<li><a href="matrix-theory.html#optimization" id="toc-optimization"><span class="toc-section-number">2.1.5</span> Optimization</a></li>
</ul></li>
<li><a href="probability-theory.html#probability-theory" id="toc-probability-theory"><span class="toc-section-number">2.2</span> Probability Theory</a>
<ul>
<li><a href="probability-theory.html#axiom-and-theorems-of-probability" id="toc-axiom-and-theorems-of-probability"><span class="toc-section-number">2.2.1</span> Axiom and Theorems of Probability</a></li>
<li><a href="probability-theory.html#central-limit-theorem" id="toc-central-limit-theorem"><span class="toc-section-number">2.2.2</span> Central Limit Theorem</a></li>
<li><a href="probability-theory.html#random-variable" id="toc-random-variable"><span class="toc-section-number">2.2.3</span> Random variable</a></li>
<li><a href="probability-theory.html#moment-generating-function" id="toc-moment-generating-function"><span class="toc-section-number">2.2.4</span> Moment generating function</a></li>
<li><a href="probability-theory.html#moment" id="toc-moment"><span class="toc-section-number">2.2.5</span> Moment</a></li>
<li><a href="probability-theory.html#distributions" id="toc-distributions"><span class="toc-section-number">2.2.6</span> Distributions</a></li>
</ul></li>
<li><a href="general-math.html#general-math" id="toc-general-math"><span class="toc-section-number">2.3</span> General Math</a>
<ul>
<li><a href="general-math.html#law-of-large-numbers" id="toc-law-of-large-numbers"><span class="toc-section-number">2.3.1</span> Law of large numbers</a></li>
<li><a href="general-math.html#law-of-iterated-expectation" id="toc-law-of-iterated-expectation"><span class="toc-section-number">2.3.2</span> Law of Iterated Expectation</a></li>
<li><a href="general-math.html#convergence" id="toc-convergence"><span class="toc-section-number">2.3.3</span> Convergence</a></li>
<li><a href="general-math.html#sufficient-statistics" id="toc-sufficient-statistics"><span class="toc-section-number">2.3.4</span> Sufficient Statistics</a></li>
<li><a href="general-math.html#parameter-transformations" id="toc-parameter-transformations"><span class="toc-section-number">2.3.5</span> Parameter transformations</a></li>
</ul></li>
<li><a href="data-importexport.html#data-importexport" id="toc-data-importexport"><span class="toc-section-number">2.4</span> Data Import/Export</a>
<ul>
<li><a href="data-importexport.html#medium-size" id="toc-medium-size"><span class="toc-section-number">2.4.1</span> Medium size</a></li>
<li><a href="data-importexport.html#large-size" id="toc-large-size"><span class="toc-section-number">2.4.2</span> Large size</a></li>
</ul></li>
<li><a href="data-manipulation.html#data-manipulation" id="toc-data-manipulation"><span class="toc-section-number">2.5</span> Data Manipulation</a></li>
</ul></li>
<li><a href="#part-i.-basic" id="toc-part-i.-basic">(PART*) I. BASIC</a></li>
<li><a href="descriptive-stat.html#descriptive-stat" id="toc-descriptive-stat"><span class="toc-section-number">3</span> Descriptive Statistics</a>
<ul>
<li><a href="numerical-measures.html#numerical-measures" id="toc-numerical-measures"><span class="toc-section-number">3.1</span> Numerical Measures</a></li>
<li><a href="graphical-measures.html#graphical-measures" id="toc-graphical-measures"><span class="toc-section-number">3.2</span> Graphical Measures</a>
<ul>
<li><a href="graphical-measures.html#shape" id="toc-shape"><span class="toc-section-number">3.2.1</span> Shape</a></li>
<li><a href="graphical-measures.html#scatterplot" id="toc-scatterplot"><span class="toc-section-number">3.2.2</span> Scatterplot</a></li>
</ul></li>
<li><a href="normality-assessment.html#normality-assessment" id="toc-normality-assessment"><span class="toc-section-number">3.3</span> Normality Assessment</a>
<ul>
<li><a href="normality-assessment.html#graphical-assessment" id="toc-graphical-assessment"><span class="toc-section-number">3.3.1</span> Graphical Assessment</a></li>
<li><a href="normality-assessment.html#summary-statistics" id="toc-summary-statistics"><span class="toc-section-number">3.3.2</span> Summary Statistics</a></li>
</ul></li>
<li><a href="bivariate-statistics.html#bivariate-statistics" id="toc-bivariate-statistics"><span class="toc-section-number">3.4</span> Bivariate Statistics</a></li>
<li><a href="two-continuous.html#two-continuous" id="toc-two-continuous"><span class="toc-section-number">3.5</span> Two Continuous</a>
<ul>
<li><a href="two-continuous.html#pearson-correlation" id="toc-pearson-correlation"><span class="toc-section-number">3.5.1</span> Pearson Correlation</a></li>
<li><a href="two-continuous.html#spearman-correlation" id="toc-spearman-correlation"><span class="toc-section-number">3.5.2</span> Spearman Correlation</a></li>
</ul></li>
<li><a href="categorical-and-continuous.html#categorical-and-continuous" id="toc-categorical-and-continuous"><span class="toc-section-number">3.6</span> Categorical and Continuous</a>
<ul>
<li><a href="categorical-and-continuous.html#point-biserial-correlation" id="toc-point-biserial-correlation"><span class="toc-section-number">3.6.1</span> Point-Biserial Correlation</a></li>
<li><a href="categorical-and-continuous.html#logistic-regression" id="toc-logistic-regression"><span class="toc-section-number">3.6.2</span> Logistic Regression</a></li>
</ul></li>
<li><a href="two-discrete.html#two-discrete" id="toc-two-discrete"><span class="toc-section-number">3.7</span> Two Discrete</a>
<ul>
<li><a href="two-discrete.html#distance-metrics" id="toc-distance-metrics"><span class="toc-section-number">3.7.1</span> Distance Metrics</a></li>
<li><a href="two-discrete.html#statistical-metrics" id="toc-statistical-metrics"><span class="toc-section-number">3.7.2</span> Statistical Metrics</a></li>
<li><a href="two-discrete.html#ordinal-association-rank-correlation" id="toc-ordinal-association-rank-correlation"><span class="toc-section-number">3.7.3</span> Ordinal Association (Rank correlation)</a></li>
<li><a href="two-discrete.html#summary-1" id="toc-summary-1"><span class="toc-section-number">3.7.4</span> Summary</a></li>
<li><a href="two-discrete.html#visualization" id="toc-visualization"><span class="toc-section-number">3.7.5</span> Visualization</a></li>
</ul></li>
</ul></li>
<li><a href="basic-statistical-inference.html#basic-statistical-inference" id="toc-basic-statistical-inference"><span class="toc-section-number">4</span> Basic Statistical Inference</a>
<ul>
<li><a href="one-sample-inference.html#one-sample-inference" id="toc-one-sample-inference"><span class="toc-section-number">4.1</span> One Sample Inference</a>
<ul>
<li><a href="one-sample-inference.html#the-mean" id="toc-the-mean"><span class="toc-section-number">4.1.1</span> The Mean</a></li>
<li><a href="one-sample-inference.html#single-variance" id="toc-single-variance"><span class="toc-section-number">4.1.2</span> Single Variance</a></li>
<li><a href="one-sample-inference.html#single-proportion-p" id="toc-single-proportion-p"><span class="toc-section-number">4.1.3</span> Single Proportion (p)</a></li>
<li><a href="one-sample-inference.html#power" id="toc-power"><span class="toc-section-number">4.1.4</span> Power</a></li>
<li><a href="one-sample-inference.html#sample-size" id="toc-sample-size"><span class="toc-section-number">4.1.5</span> Sample Size</a></li>
<li><a href="one-sample-inference.html#note" id="toc-note"><span class="toc-section-number">4.1.6</span> Note</a></li>
<li><a href="one-sample-inference.html#one-sample-non-parametric-methods" id="toc-one-sample-non-parametric-methods"><span class="toc-section-number">4.1.7</span> One-sample Non-parametric Methods</a></li>
</ul></li>
<li><a href="two-sample-inference.html#two-sample-inference" id="toc-two-sample-inference"><span class="toc-section-number">4.2</span> Two Sample Inference</a>
<ul>
<li><a href="two-sample-inference.html#means" id="toc-means"><span class="toc-section-number">4.2.1</span> Means</a></li>
<li><a href="two-sample-inference.html#variances" id="toc-variances"><span class="toc-section-number">4.2.2</span> Variances</a></li>
<li><a href="two-sample-inference.html#power-1" id="toc-power-1"><span class="toc-section-number">4.2.3</span> Power</a></li>
<li><a href="two-sample-inference.html#sample-size-1" id="toc-sample-size-1"><span class="toc-section-number">4.2.4</span> Sample Size</a></li>
<li><a href="two-sample-inference.html#matched-pair-designs" id="toc-matched-pair-designs"><span class="toc-section-number">4.2.5</span> Matched Pair Designs</a></li>
<li><a href="two-sample-inference.html#nonparametric-tests-for-two-samples" id="toc-nonparametric-tests-for-two-samples"><span class="toc-section-number">4.2.6</span> Nonparametric Tests for Two Samples</a></li>
</ul></li>
<li><a href="categorical-data-analysis.html#categorical-data-analysis" id="toc-categorical-data-analysis"><span class="toc-section-number">4.3</span> Categorical Data Analysis</a>
<ul>
<li><a href="categorical-data-analysis.html#inferences-for-small-samples" id="toc-inferences-for-small-samples"><span class="toc-section-number">4.3.1</span> Inferences for Small Samples</a></li>
<li><a href="categorical-data-analysis.html#test-of-association" id="toc-test-of-association"><span class="toc-section-number">4.3.2</span> Test of Association</a></li>
<li><a href="categorical-data-analysis.html#ordinal-association" id="toc-ordinal-association"><span class="toc-section-number">4.3.3</span> Ordinal Association</a></li>
</ul></li>
<li><a href="divergence-metrics-and-test-for-comparing-distributions.html#divergence-metrics-and-test-for-comparing-distributions" id="toc-divergence-metrics-and-test-for-comparing-distributions"><span class="toc-section-number">4.4</span> Divergence Metrics and Test for Comparing Distributions</a>
<ul>
<li><a href="divergence-metrics-and-test-for-comparing-distributions.html#kullback-leibler-divergence" id="toc-kullback-leibler-divergence"><span class="toc-section-number">4.4.1</span> Kullback-Leibler Divergence</a></li>
<li><a href="divergence-metrics-and-test-for-comparing-distributions.html#jensen-shannon-divergence" id="toc-jensen-shannon-divergence"><span class="toc-section-number">4.4.2</span> Jensen-Shannon Divergence</a></li>
<li><a href="divergence-metrics-and-test-for-comparing-distributions.html#wasserstein-distance" id="toc-wasserstein-distance"><span class="toc-section-number">4.4.3</span> Wasserstein Distance</a></li>
<li><a href="divergence-metrics-and-test-for-comparing-distributions.html#kolmogorov-smirnov-test-1" id="toc-kolmogorov-smirnov-test-1"><span class="toc-section-number">4.4.4</span> Kolmogorov-Smirnov Test</a></li>
</ul></li>
</ul></li>
<li><a href="#part-ii.-regression" id="toc-part-ii.-regression">(PART*) II. REGRESSION</a></li>
<li><a href="linear-regression.html#linear-regression" id="toc-linear-regression"><span class="toc-section-number">5</span> Linear Regression</a>
<ul>
<li><a href="ordinary-least-squares.html#ordinary-least-squares" id="toc-ordinary-least-squares"><span class="toc-section-number">5.1</span> Ordinary Least Squares</a>
<ul>
<li><a href="ordinary-least-squares.html#simple-regression-basic-model" id="toc-simple-regression-basic-model"><span class="toc-section-number">5.1.1</span> Simple Regression (Basic Model)</a></li>
<li><a href="ordinary-least-squares.html#multiple-linear-regression" id="toc-multiple-linear-regression"><span class="toc-section-number">5.1.2</span> Multiple Linear Regression</a></li>
<li><a href="ordinary-least-squares.html#ols-assumptions" id="toc-ols-assumptions"><span class="toc-section-number">5.1.3</span> OLS Assumptions</a></li>
<li><a href="ordinary-least-squares.html#theorems" id="toc-theorems"><span class="toc-section-number">5.1.4</span> Theorems</a></li>
<li><a href="ordinary-least-squares.html#variable-selection" id="toc-variable-selection"><span class="toc-section-number">5.1.5</span> Variable Selection</a></li>
<li><a href="ordinary-least-squares.html#diagnostics-1" id="toc-diagnostics-1"><span class="toc-section-number">5.1.6</span> Diagnostics</a></li>
<li><a href="ordinary-least-squares.html#model-validation" id="toc-model-validation"><span class="toc-section-number">5.1.7</span> Model Validation</a></li>
<li><a href="ordinary-least-squares.html#finite-sample-properties" id="toc-finite-sample-properties"><span class="toc-section-number">5.1.8</span> Finite Sample Properties</a></li>
<li><a href="ordinary-least-squares.html#large-sample-properties" id="toc-large-sample-properties"><span class="toc-section-number">5.1.9</span> Large Sample Properties</a></li>
</ul></li>
<li><a href="feasible-generalized-least-squares.html#feasible-generalized-least-squares" id="toc-feasible-generalized-least-squares"><span class="toc-section-number">5.2</span> Feasible Generalized Least Squares</a>
<ul>
<li><a href="feasible-generalized-least-squares.html#heteroskedasticity" id="toc-heteroskedasticity"><span class="toc-section-number">5.2.1</span> Heteroskedasticity</a></li>
<li><a href="feasible-generalized-least-squares.html#serial-correlation" id="toc-serial-correlation"><span class="toc-section-number">5.2.2</span> Serial Correlation</a></li>
</ul></li>
<li><a href="weighted-least-squares.html#weighted-least-squares" id="toc-weighted-least-squares"><span class="toc-section-number">5.3</span> Weighted Least Squares</a></li>
<li><a href="generalized-least-squares.html#generalized-least-squares" id="toc-generalized-least-squares"><span class="toc-section-number">5.4</span> Generalized Least Squares</a></li>
<li><a href="feasiable-prais-winsten.html#feasiable-prais-winsten" id="toc-feasiable-prais-winsten"><span class="toc-section-number">5.5</span> Feasiable Prais Winsten</a></li>
<li><a href="feasible-group-level-random-effects.html#feasible-group-level-random-effects" id="toc-feasible-group-level-random-effects"><span class="toc-section-number">5.6</span> Feasible group level Random Effects</a></li>
<li><a href="ridge-regression.html#ridge-regression" id="toc-ridge-regression"><span class="toc-section-number">5.7</span> Ridge Regression</a></li>
<li><a href="principal-component-regression.html#principal-component-regression" id="toc-principal-component-regression"><span class="toc-section-number">5.8</span> Principal Component Regression</a></li>
<li><a href="robust-regression.html#robust-regression" id="toc-robust-regression"><span class="toc-section-number">5.9</span> Robust Regression</a>
<ul>
<li><a href="robust-regression.html#least-absolute-residuals-lar-regression" id="toc-least-absolute-residuals-lar-regression"><span class="toc-section-number">5.9.1</span> Least Absolute Residuals (LAR) Regression</a></li>
<li><a href="robust-regression.html#least-median-of-squares-lms-regression" id="toc-least-median-of-squares-lms-regression"><span class="toc-section-number">5.9.2</span> Least Median of Squares (LMS) Regression</a></li>
<li><a href="robust-regression.html#iteratively-reweighted-least-squares-irls-robust-regression" id="toc-iteratively-reweighted-least-squares-irls-robust-regression"><span class="toc-section-number">5.9.3</span> Iteratively Reweighted Least Squares (IRLS) Robust Regression</a></li>
</ul></li>
<li><a href="maximum-likelihood-regression.html#maximum-likelihood-regression" id="toc-maximum-likelihood-regression"><span class="toc-section-number">5.10</span> Maximum Likelihood</a>
<ul>
<li><a href="maximum-likelihood-regression.html#motivation-for-mle" id="toc-motivation-for-mle"><span class="toc-section-number">5.10.1</span> Motivation for MLE</a></li>
<li><a href="maximum-likelihood-regression.html#assumption" id="toc-assumption"><span class="toc-section-number">5.10.2</span> Assumption</a></li>
<li><a href="maximum-likelihood-regression.html#properties" id="toc-properties"><span class="toc-section-number">5.10.3</span> Properties</a></li>
<li><a href="maximum-likelihood-regression.html#compare-to-ols" id="toc-compare-to-ols"><span class="toc-section-number">5.10.4</span> Compare to OLS</a></li>
<li><a href="maximum-likelihood-regression.html#application" id="toc-application"><span class="toc-section-number">5.10.5</span> Application</a></li>
</ul></li>
</ul></li>
<li><a href="non-linear-regression.html#non-linear-regression" id="toc-non-linear-regression"><span class="toc-section-number">6</span> Non-linear Regression</a>
<ul>
<li><a href="inference-1.html#inference-1" id="toc-inference-1"><span class="toc-section-number">6.1</span> Inference</a>
<ul>
<li><a href="inference-1.html#linear-function-of-the-parameters" id="toc-linear-function-of-the-parameters"><span class="toc-section-number">6.1.1</span> Linear Function of the Parameters</a></li>
<li><a href="inference-1.html#nonlinear" id="toc-nonlinear"><span class="toc-section-number">6.1.2</span> Nonlinear</a></li>
</ul></li>
<li><a href="non-linear-least-squares.html#non-linear-least-squares" id="toc-non-linear-least-squares"><span class="toc-section-number">6.2</span> Non-linear Least Squares</a>
<ul>
<li><a href="non-linear-least-squares.html#alternative-of-gauss-newton-algorithm" id="toc-alternative-of-gauss-newton-algorithm"><span class="toc-section-number">6.2.1</span> Alternative of Gauss-Newton Algorithm</a></li>
<li><a href="non-linear-least-squares.html#practical-considerations" id="toc-practical-considerations"><span class="toc-section-number">6.2.2</span> Practical Considerations</a></li>
<li><a href="non-linear-least-squares.html#modelestiamtion-adequcy" id="toc-modelestiamtion-adequcy"><span class="toc-section-number">6.2.3</span> Model/Estiamtion Adequcy</a></li>
<li><a href="non-linear-least-squares.html#application-1" id="toc-application-1"><span class="toc-section-number">6.2.4</span> Application</a></li>
</ul></li>
</ul></li>
<li><a href="generalized-linear-models.html#generalized-linear-models" id="toc-generalized-linear-models"><span class="toc-section-number">7</span> Generalized Linear Models</a>
<ul>
<li><a href="logistic-regression-1.html#logistic-regression-1" id="toc-logistic-regression-1"><span class="toc-section-number">7.1</span> Logistic Regression</a>
<ul>
<li><a href="logistic-regression-1.html#application-2" id="toc-application-2"><span class="toc-section-number">7.1.1</span> Application</a></li>
</ul></li>
<li><a href="probit-regression.html#probit-regression" id="toc-probit-regression"><span class="toc-section-number">7.2</span> Probit Regression</a></li>
<li><a href="binomial-regression.html#binomial-regression" id="toc-binomial-regression"><span class="toc-section-number">7.3</span> Binomial Regression</a></li>
<li><a href="poisson-regression.html#poisson-regression" id="toc-poisson-regression"><span class="toc-section-number">7.4</span> Poisson Regression</a>
<ul>
<li><a href="poisson-regression.html#application-3" id="toc-application-3"><span class="toc-section-number">7.4.1</span> Application</a></li>
</ul></li>
<li><a href="negative-binomial-regression.html#negative-binomial-regression" id="toc-negative-binomial-regression"><span class="toc-section-number">7.5</span> Negative Binomial Regression</a></li>
<li><a href="multinomial.html#multinomial" id="toc-multinomial"><span class="toc-section-number">7.6</span> Multinomial</a></li>
<li><a href="generalization.html#generalization" id="toc-generalization"><span class="toc-section-number">7.7</span> Generalization</a>
<ul>
<li><a href="generalization.html#estimation-1" id="toc-estimation-1"><span class="toc-section-number">7.7.1</span> Estimation</a></li>
<li><a href="generalization.html#inference-2" id="toc-inference-2"><span class="toc-section-number">7.7.2</span> Inference</a></li>
<li><a href="generalization.html#deviance" id="toc-deviance"><span class="toc-section-number">7.7.3</span> Deviance</a></li>
<li><a href="generalization.html#diagnostic-plots" id="toc-diagnostic-plots"><span class="toc-section-number">7.7.4</span> Diagnostic Plots</a></li>
<li><a href="generalization.html#goodness-of-fit" id="toc-goodness-of-fit"><span class="toc-section-number">7.7.5</span> Goodness of Fit</a></li>
<li><a href="generalization.html#over-dispersion" id="toc-over-dispersion"><span class="toc-section-number">7.7.6</span> Over-Dispersion</a></li>
</ul></li>
</ul></li>
<li><a href="linear-mixed-models.html#linear-mixed-models" id="toc-linear-mixed-models"><span class="toc-section-number">8</span> Linear Mixed Models</a>
<ul>
<li><a href="dependent-data.html#dependent-data" id="toc-dependent-data"><span class="toc-section-number">8.1</span> Dependent Data</a>
<ul>
<li><a href="dependent-data.html#random-intercepts-model" id="toc-random-intercepts-model"><span class="toc-section-number">8.1.1</span> Random-Intercepts Model</a></li>
<li><a href="dependent-data.html#covariance-models" id="toc-covariance-models"><span class="toc-section-number">8.1.2</span> Covariance Models</a></li>
</ul></li>
<li><a href="estimation-2.html#estimation-2" id="toc-estimation-2"><span class="toc-section-number">8.2</span> Estimation</a>
<ul>
<li><a href="estimation-2.html#estimating-mathbfv" id="toc-estimating-mathbfv"><span class="toc-section-number">8.2.1</span> Estimating <span class="math inline">\(\mathbf{V}\)</span></a></li>
</ul></li>
<li><a href="inference-3.html#inference-3" id="toc-inference-3"><span class="toc-section-number">8.3</span> Inference</a>
<ul>
<li><a href="inference-3.html#parameters-beta" id="toc-parameters-beta"><span class="toc-section-number">8.3.1</span> Parameters <span class="math inline">\(\beta\)</span></a></li>
<li><a href="inference-3.html#variance-components" id="toc-variance-components"><span class="toc-section-number">8.3.2</span> Variance Components</a></li>
</ul></li>
<li><a href="information-criteria.html#information-criteria" id="toc-information-criteria"><span class="toc-section-number">8.4</span> Information Criteria</a>
<ul>
<li><a href="information-criteria.html#akaikes-information-criteria-aic" id="toc-akaikes-information-criteria-aic"><span class="toc-section-number">8.4.1</span> Akaike’s Information Criteria (AIC)</a></li>
<li><a href="information-criteria.html#corrected-aic-aicc" id="toc-corrected-aic-aicc"><span class="toc-section-number">8.4.2</span> Corrected AIC (AICC)</a></li>
<li><a href="information-criteria.html#bayesian-information-criteria-bic" id="toc-bayesian-information-criteria-bic"><span class="toc-section-number">8.4.3</span> Bayesian Information Criteria (BIC)</a></li>
</ul></li>
<li><a href="split-plot-designs.html#split-plot-designs" id="toc-split-plot-designs"><span class="toc-section-number">8.5</span> Split-Plot Designs</a>
<ul>
<li><a href="split-plot-designs.html#application-4" id="toc-application-4"><span class="toc-section-number">8.5.1</span> Application</a></li>
</ul></li>
<li><a href="repeated-measures-in-mixed-models.html#repeated-measures-in-mixed-models" id="toc-repeated-measures-in-mixed-models"><span class="toc-section-number">8.6</span> Repeated Measures in Mixed Models</a></li>
<li><a href="unbalanced-or-unequally-spaced-data.html#unbalanced-or-unequally-spaced-data" id="toc-unbalanced-or-unequally-spaced-data"><span class="toc-section-number">8.7</span> Unbalanced or Unequally Spaced Data</a></li>
<li><a href="application-5.html#application-5" id="toc-application-5"><span class="toc-section-number">8.8</span> Application</a>
<ul>
<li><a href="application-5.html#example-1-pulps" id="toc-example-1-pulps"><span class="toc-section-number">8.8.1</span> Example 1 (Pulps)</a></li>
<li><a href="application-5.html#example-2-rats" id="toc-example-2-rats"><span class="toc-section-number">8.8.2</span> Example 2 (Rats)</a></li>
<li><a href="application-5.html#example-3-agridat" id="toc-example-3-agridat"><span class="toc-section-number">8.8.3</span> Example 3 (Agridat)</a></li>
</ul></li>
</ul></li>
<li><a href="nonlinear-and-generalized-linear-mixed-models.html#nonlinear-and-generalized-linear-mixed-models" id="toc-nonlinear-and-generalized-linear-mixed-models"><span class="toc-section-number">9</span> Nonlinear and Generalized Linear Mixed Models</a>
<ul>
<li><a href="estimation-3.html#estimation-3" id="toc-estimation-3"><span class="toc-section-number">9.1</span> Estimation</a>
<ul>
<li><a href="estimation-3.html#estimation-by-numerical-integration" id="toc-estimation-by-numerical-integration"><span class="toc-section-number">9.1.1</span> Estimation by Numerical Integration</a></li>
<li><a href="estimation-3.html#estimation-by-linearization" id="toc-estimation-by-linearization"><span class="toc-section-number">9.1.2</span> Estimation by Linearization</a></li>
<li><a href="estimation-3.html#estimation-by-bayesian-hierarchical-models" id="toc-estimation-by-bayesian-hierarchical-models"><span class="toc-section-number">9.1.3</span> Estimation by Bayesian Hierarchical Models</a></li>
</ul></li>
<li><a href="application-6.html#application-6" id="toc-application-6"><span class="toc-section-number">9.2</span> Application</a>
<ul>
<li><a href="application-6.html#binomial-cbpp-data" id="toc-binomial-cbpp-data"><span class="toc-section-number">9.2.1</span> Binomial (CBPP Data)</a></li>
<li><a href="application-6.html#count-owl-data" id="toc-count-owl-data"><span class="toc-section-number">9.2.2</span> Count (Owl Data)</a></li>
<li><a href="application-6.html#binomial-1" id="toc-binomial-1"><span class="toc-section-number">9.2.3</span> Binomial</a></li>
<li><a href="application-6.html#example-from-schabenberger_2001-section-8.4.1" id="toc-example-from-schabenberger_2001-section-8.4.1"><span class="toc-section-number">9.2.4</span> Example from <span class="citation">(<span>Schabenberger and Pierce 2001</span>)</span> section 8.4.1</a></li>
</ul></li>
<li><a href="summary-2.html#summary-2" id="toc-summary-2"><span class="toc-section-number">9.3</span> Summary</a></li>
</ul></li>
<li><a href="#part-iii.-ramifications" id="toc-part-iii.-ramifications">(PART*) III. RAMIFICATIONS</a></li>
<li><a href="model-specification.html#model-specification" id="toc-model-specification"><span class="toc-section-number">10</span> Model Specification</a>
<ul>
<li><a href="nested-model.html#nested-model" id="toc-nested-model"><span class="toc-section-number">10.1</span> Nested Model</a>
<ul>
<li><a href="nested-model.html#chow-test" id="toc-chow-test"><span class="toc-section-number">10.1.1</span> Chow test</a></li>
</ul></li>
<li><a href="non-nested-model.html#non-nested-model" id="toc-non-nested-model"><span class="toc-section-number">10.2</span> Non-Nested Model</a>
<ul>
<li><a href="non-nested-model.html#davidson-mackinnon-test" id="toc-davidson-mackinnon-test"><span class="toc-section-number">10.2.1</span> Davidson-Mackinnon test</a></li>
</ul></li>
<li><a href="heteroskedasticity-1.html#heteroskedasticity-1" id="toc-heteroskedasticity-1"><span class="toc-section-number">10.3</span> Heteroskedasticity</a>
<ul>
<li><a href="heteroskedasticity-1.html#breusch-pagan-test" id="toc-breusch-pagan-test"><span class="toc-section-number">10.3.1</span> Breusch-Pagan test</a></li>
<li><a href="heteroskedasticity-1.html#white-test" id="toc-white-test"><span class="toc-section-number">10.3.2</span> White test</a></li>
</ul></li>
</ul></li>
<li><a href="imputation-missing-data.html#imputation-missing-data" id="toc-imputation-missing-data"><span class="toc-section-number">11</span> Imputation (Missing Data)</a>
<ul>
<li><a href="assumptions-1.html#assumptions-1" id="toc-assumptions-1"><span class="toc-section-number">11.1</span> Assumptions</a>
<ul>
<li><a href="assumptions-1.html#missing-completely-at-random-mcar" id="toc-missing-completely-at-random-mcar"><span class="toc-section-number">11.1.1</span> Missing Completely at Random (MCAR)</a></li>
<li><a href="assumptions-1.html#missing-at-random-mar" id="toc-missing-at-random-mar"><span class="toc-section-number">11.1.2</span> Missing at Random (MAR)</a></li>
<li><a href="assumptions-1.html#ignorable" id="toc-ignorable"><span class="toc-section-number">11.1.3</span> Ignorable</a></li>
<li><a href="assumptions-1.html#nonignorable" id="toc-nonignorable"><span class="toc-section-number">11.1.4</span> Nonignorable</a></li>
</ul></li>
<li><a href="solutions-to-missing-data.html#solutions-to-missing-data" id="toc-solutions-to-missing-data"><span class="toc-section-number">11.2</span> Solutions to Missing data</a>
<ul>
<li><a href="solutions-to-missing-data.html#listwise-deletion" id="toc-listwise-deletion"><span class="toc-section-number">11.2.1</span> Listwise Deletion</a></li>
<li><a href="solutions-to-missing-data.html#pairwise-deletion" id="toc-pairwise-deletion"><span class="toc-section-number">11.2.2</span> Pairwise Deletion</a></li>
<li><a href="solutions-to-missing-data.html#dummy-variable-adjustment" id="toc-dummy-variable-adjustment"><span class="toc-section-number">11.2.3</span> Dummy Variable Adjustment</a></li>
<li><a href="solutions-to-missing-data.html#imputation" id="toc-imputation"><span class="toc-section-number">11.2.4</span> Imputation</a></li>
<li><a href="solutions-to-missing-data.html#other-methods" id="toc-other-methods"><span class="toc-section-number">11.2.5</span> Other methods</a></li>
</ul></li>
<li><a href="criteria-for-choosing-an-effective-approach.html#criteria-for-choosing-an-effective-approach" id="toc-criteria-for-choosing-an-effective-approach"><span class="toc-section-number">11.3</span> Criteria for Choosing an Effective Approach</a></li>
<li><a href="another-perspective.html#another-perspective" id="toc-another-perspective"><span class="toc-section-number">11.4</span> Another Perspective</a></li>
<li><a href="diagnosing-the-mechanism.html#diagnosing-the-mechanism" id="toc-diagnosing-the-mechanism"><span class="toc-section-number">11.5</span> Diagnosing the Mechanism</a>
<ul>
<li><a href="diagnosing-the-mechanism.html#mar-vs.-mnar" id="toc-mar-vs.-mnar"><span class="toc-section-number">11.5.1</span> MAR vs. MNAR</a></li>
<li><a href="diagnosing-the-mechanism.html#mcar-vs.-mar" id="toc-mcar-vs.-mar"><span class="toc-section-number">11.5.2</span> MCAR vs. MAR</a></li>
</ul></li>
<li><a href="application-7.html#application-7" id="toc-application-7"><span class="toc-section-number">11.6</span> Application</a>
<ul>
<li><a href="application-7.html#imputation-with-mean-median-mode" id="toc-imputation-with-mean-median-mode"><span class="toc-section-number">11.6.1</span> Imputation with mean / median / mode</a></li>
<li><a href="application-7.html#knn" id="toc-knn"><span class="toc-section-number">11.6.2</span> KNN</a></li>
<li><a href="application-7.html#rpart" id="toc-rpart"><span class="toc-section-number">11.6.3</span> rpart</a></li>
<li><a href="application-7.html#mice-multivariate-imputation-via-chained-equations" id="toc-mice-multivariate-imputation-via-chained-equations"><span class="toc-section-number">11.6.4</span> MICE (Multivariate Imputation via Chained Equations)</a></li>
<li><a href="application-7.html#amelia" id="toc-amelia"><span class="toc-section-number">11.6.5</span> Amelia</a></li>
<li><a href="application-7.html#missforest" id="toc-missforest"><span class="toc-section-number">11.6.6</span> missForest</a></li>
<li><a href="application-7.html#hmisc" id="toc-hmisc"><span class="toc-section-number">11.6.7</span> Hmisc</a></li>
<li><a href="application-7.html#mi" id="toc-mi"><span class="toc-section-number">11.6.8</span> mi</a></li>
</ul></li>
</ul></li>
<li><a href="data.html#data" id="toc-data"><span class="toc-section-number">12</span> Data</a>
<ul>
<li><a href="cross-sectional.html#cross-sectional" id="toc-cross-sectional"><span class="toc-section-number">12.1</span> Cross-Sectional</a></li>
<li><a href="time-series-1.html#time-series-1" id="toc-time-series-1"><span class="toc-section-number">12.2</span> Time Series</a>
<ul>
<li><a href="time-series-1.html#deterministic-time-trend" id="toc-deterministic-time-trend"><span class="toc-section-number">12.2.1</span> Deterministic Time trend</a></li>
<li><a href="time-series-1.html#feedback-effect" id="toc-feedback-effect"><span class="toc-section-number">12.2.2</span> Feedback Effect</a></li>
<li><a href="time-series-1.html#dynamic-specification" id="toc-dynamic-specification"><span class="toc-section-number">12.2.3</span> Dynamic Specification</a></li>
<li><a href="time-series-1.html#dynamically-complete" id="toc-dynamically-complete"><span class="toc-section-number">12.2.4</span> Dynamically Complete</a></li>
<li><a href="time-series-1.html#highly-persistent-data" id="toc-highly-persistent-data"><span class="toc-section-number">12.2.5</span> Highly Persistent Data</a></li>
</ul></li>
<li><a href="repeated-cross-sections.html#repeated-cross-sections" id="toc-repeated-cross-sections"><span class="toc-section-number">12.3</span> Repeated Cross Sections</a>
<ul>
<li><a href="repeated-cross-sections.html#pooled-cross-section" id="toc-pooled-cross-section"><span class="toc-section-number">12.3.1</span> Pooled Cross Section</a></li>
</ul></li>
<li><a href="panel-data.html#panel-data" id="toc-panel-data"><span class="toc-section-number">12.4</span> Panel Data</a>
<ul>
<li><a href="panel-data.html#pooled-ols-estimator" id="toc-pooled-ols-estimator"><span class="toc-section-number">12.4.1</span> Pooled OLS Estimator</a></li>
<li><a href="panel-data.html#individual-specific-effects-model" id="toc-individual-specific-effects-model"><span class="toc-section-number">12.4.2</span> Individual-specific effects model</a></li>
<li><a href="panel-data.html#tests-for-assumptions" id="toc-tests-for-assumptions"><span class="toc-section-number">12.4.3</span> Tests for Assumptions</a></li>
<li><a href="panel-data.html#model-selection" id="toc-model-selection"><span class="toc-section-number">12.4.4</span> Model Selection</a></li>
<li><a href="panel-data.html#summary-3" id="toc-summary-3"><span class="toc-section-number">12.4.5</span> Summary</a></li>
<li><a href="panel-data.html#application-8" id="toc-application-8"><span class="toc-section-number">12.4.6</span> Application</a></li>
<li><a href="panel-data.html#other-estimators" id="toc-other-estimators"><span class="toc-section-number">12.4.7</span> Other Estimators</a></li>
</ul></li>
</ul></li>
<li><a href="hypothesis-testing.html#hypothesis-testing" id="toc-hypothesis-testing"><span class="toc-section-number">13</span> Hypothesis Testing</a>
<ul>
<li><a href="types-of-hypothesis-testing.html#types-of-hypothesis-testing" id="toc-types-of-hypothesis-testing"><span class="toc-section-number">13.1</span> Types of hypothesis testing</a></li>
<li><a href="wald-test.html#wald-test" id="toc-wald-test"><span class="toc-section-number">13.2</span> Wald test</a>
<ul>
<li><a href="wald-test.html#multiple-hypothesis" id="toc-multiple-hypothesis"><span class="toc-section-number">13.2.1</span> Multiple Hypothesis</a></li>
<li><a href="wald-test.html#linear-combination" id="toc-linear-combination"><span class="toc-section-number">13.2.2</span> Linear Combination</a></li>
<li><a href="wald-test.html#estimate-difference-in-coefficients" id="toc-estimate-difference-in-coefficients"><span class="toc-section-number">13.2.3</span> Estimate Difference in Coefficients</a></li>
<li><a href="wald-test.html#application-9" id="toc-application-9"><span class="toc-section-number">13.2.4</span> Application</a></li>
<li><a href="wald-test.html#nonlinear-1" id="toc-nonlinear-1"><span class="toc-section-number">13.2.5</span> Nonlinear</a></li>
</ul></li>
<li><a href="the-likelihood-ratio-test.html#the-likelihood-ratio-test" id="toc-the-likelihood-ratio-test"><span class="toc-section-number">13.3</span> The likelihood ratio test</a></li>
<li><a href="lagrange-multiplier-score.html#lagrange-multiplier-score" id="toc-lagrange-multiplier-score"><span class="toc-section-number">13.4</span> Lagrange Multiplier (Score)</a></li>
</ul></li>
<li><a href="prediction-and-estimation.html#prediction-and-estimation" id="toc-prediction-and-estimation"><span class="toc-section-number">14</span> Prediction and Estimation</a></li>
<li><a href="moderation.html#moderation" id="toc-moderation"><span class="toc-section-number">15</span> Moderation</a>
<ul>
<li><a href="emmeans-package.html#emmeans-package" id="toc-emmeans-package"><span class="toc-section-number">15.1</span> emmeans package</a>
<ul>
<li><a href="emmeans-package.html#continuous-by-continuous" id="toc-continuous-by-continuous"><span class="toc-section-number">15.1.1</span> Continuous by continuous</a></li>
<li><a href="emmeans-package.html#continuous-by-categorical" id="toc-continuous-by-categorical"><span class="toc-section-number">15.1.2</span> Continuous by categorical</a></li>
<li><a href="emmeans-package.html#categorical-by-categorical" id="toc-categorical-by-categorical"><span class="toc-section-number">15.1.3</span> Categorical by categorical</a></li>
</ul></li>
<li><a href="probmod-package.html#probmod-package" id="toc-probmod-package"><span class="toc-section-number">15.2</span> probmod package</a></li>
<li><a href="interactions-package.html#interactions-package" id="toc-interactions-package"><span class="toc-section-number">15.3</span> interactions package</a>
<ul>
<li><a href="interactions-package.html#continuous-interaction" id="toc-continuous-interaction"><span class="toc-section-number">15.3.1</span> Continuous interaction</a></li>
<li><a href="interactions-package.html#categorical-interaction" id="toc-categorical-interaction"><span class="toc-section-number">15.3.2</span> Categorical interaction</a></li>
</ul></li>
<li><a href="interactionr-package.html#interactionr-package" id="toc-interactionr-package"><span class="toc-section-number">15.4</span> interactionR package</a></li>
<li><a href="sjplot-package.html#sjplot-package" id="toc-sjplot-package"><span class="toc-section-number">15.5</span> sjPlot package</a></li>
</ul></li>
<li><a href="#part-iv.-causal-inference" id="toc-part-iv.-causal-inference">(PART*) IV. CAUSAL INFERENCE</a></li>
<li><a href="causal-inference.html#causal-inference" id="toc-causal-inference"><span class="toc-section-number">16</span> Causal Inference</a>
<ul>
<li><a href="treatment-effect-types.html#treatment-effect-types" id="toc-treatment-effect-types"><span class="toc-section-number">16.1</span> Treatment effect types</a>
<ul>
<li><a href="treatment-effect-types.html#average-treatment-effects" id="toc-average-treatment-effects"><span class="toc-section-number">16.1.1</span> Average Treatment Effects</a></li>
<li><a href="treatment-effect-types.html#conditional-average-treatment-effects" id="toc-conditional-average-treatment-effects"><span class="toc-section-number">16.1.2</span> Conditional Average Treatment Effects</a></li>
<li><a href="treatment-effect-types.html#intent-to-treat-effects" id="toc-intent-to-treat-effects"><span class="toc-section-number">16.1.3</span> Intent-to-treat Effects</a></li>
<li><a href="treatment-effect-types.html#local-average-treatment-effects" id="toc-local-average-treatment-effects"><span class="toc-section-number">16.1.4</span> Local Average Treatment Effects</a></li>
<li><a href="treatment-effect-types.html#population-vs.-sample-average-treatment-effects" id="toc-population-vs.-sample-average-treatment-effects"><span class="toc-section-number">16.1.5</span> Population vs. Sample Average Treatment Effects</a></li>
<li><a href="treatment-effect-types.html#average-treatment-effects-on-the-treated-and-control" id="toc-average-treatment-effects-on-the-treated-and-control"><span class="toc-section-number">16.1.6</span> Average Treatment Effects on the Treated and Control</a></li>
<li><a href="treatment-effect-types.html#quantile-average-treatment-effects" id="toc-quantile-average-treatment-effects"><span class="toc-section-number">16.1.7</span> Quantile Average Treatment Effects</a></li>
<li><a href="treatment-effect-types.html#mediation-effects" id="toc-mediation-effects"><span class="toc-section-number">16.1.8</span> Mediation Effects</a></li>
<li><a href="treatment-effect-types.html#log-odds-treatment-effects" id="toc-log-odds-treatment-effects"><span class="toc-section-number">16.1.9</span> Log-odds Treatment Effects</a></li>
</ul></li>
</ul></li>
<li><a href="#part-a.-experimental-design" id="toc-part-a.-experimental-design">(PART*) A. EXPERIMENTAL DESIGN</a></li>
<li><a href="experimental-design.html#experimental-design" id="toc-experimental-design"><span class="toc-section-number">17</span> Experimental Design</a>
<ul>
<li><a href="semi-random-experiment.html#semi-random-experiment" id="toc-semi-random-experiment"><span class="toc-section-number">17.1</span> Semi-random Experiment</a></li>
<li><a href="rerandomization.html#rerandomization" id="toc-rerandomization"><span class="toc-section-number">17.2</span> Rerandomization</a></li>
</ul></li>
<li><a href="sampling.html#sampling" id="toc-sampling"><span class="toc-section-number">18</span> Sampling</a>
<ul>
<li><a href="simple-sampling.html#simple-sampling" id="toc-simple-sampling"><span class="toc-section-number">18.1</span> Simple Sampling</a></li>
<li><a href="stratified-sampling.html#stratified-sampling" id="toc-stratified-sampling"><span class="toc-section-number">18.2</span> Stratified Sampling</a></li>
<li><a href="unequal-probability-sampling.html#unequal-probability-sampling" id="toc-unequal-probability-sampling"><span class="toc-section-number">18.3</span> Unequal Probability Sampling</a></li>
<li><a href="balanced-sampling.html#balanced-sampling" id="toc-balanced-sampling"><span class="toc-section-number">18.4</span> Balanced Sampling</a>
<ul>
<li><a href="balanced-sampling.html#cube" id="toc-cube"><span class="toc-section-number">18.4.1</span> Cube</a></li>
<li><a href="balanced-sampling.html#stratification" id="toc-stratification"><span class="toc-section-number">18.4.2</span> Stratification</a></li>
<li><a href="balanced-sampling.html#cluster-1" id="toc-cluster-1"><span class="toc-section-number">18.4.3</span> Cluster</a></li>
<li><a href="balanced-sampling.html#two-stage" id="toc-two-stage"><span class="toc-section-number">18.4.4</span> Two-stage</a></li>
</ul></li>
</ul></li>
<li><a href="analysis-of-variance-anova.html#analysis-of-variance-anova" id="toc-analysis-of-variance-anova"><span class="toc-section-number">19</span> Analysis of Variance (ANOVA)</a>
<ul>
<li><a href="completely-randomized-design-crd.html#completely-randomized-design-crd" id="toc-completely-randomized-design-crd"><span class="toc-section-number">19.1</span> Completely Randomized Design (CRD)</a>
<ul>
<li><a href="completely-randomized-design-crd.html#single-factor-fixed-effects-model" id="toc-single-factor-fixed-effects-model"><span class="toc-section-number">19.1.1</span> Single Factor Fixed Effects Model</a></li>
<li><a href="completely-randomized-design-crd.html#single-factor-random-effects-model" id="toc-single-factor-random-effects-model"><span class="toc-section-number">19.1.2</span> Single Factor Random Effects Model</a></li>
<li><a href="completely-randomized-design-crd.html#two-factor-fixed-effect-anova" id="toc-two-factor-fixed-effect-anova"><span class="toc-section-number">19.1.3</span> Two Factor Fixed Effect ANOVA</a></li>
<li><a href="completely-randomized-design-crd.html#two-way-random-effects-anova" id="toc-two-way-random-effects-anova"><span class="toc-section-number">19.1.4</span> Two-Way Random Effects ANOVA</a></li>
<li><a href="completely-randomized-design-crd.html#two-way-mixed-effects-anova" id="toc-two-way-mixed-effects-anova"><span class="toc-section-number">19.1.5</span> Two-Way Mixed Effects ANOVA</a></li>
</ul></li>
<li><a href="nonparametric-anova.html#nonparametric-anova" id="toc-nonparametric-anova"><span class="toc-section-number">19.2</span> Nonparametric ANOVA</a>
<ul>
<li><a href="nonparametric-anova.html#kruskal-wallis" id="toc-kruskal-wallis"><span class="toc-section-number">19.2.1</span> Kruskal-Wallis</a></li>
<li><a href="nonparametric-anova.html#friedman-test" id="toc-friedman-test"><span class="toc-section-number">19.2.2</span> Friedman Test</a></li>
</ul></li>
<li><a href="sample-size-planning-for-anova.html#sample-size-planning-for-anova" id="toc-sample-size-planning-for-anova"><span class="toc-section-number">19.3</span> Sample Size Planning for ANOVA</a>
<ul>
<li><a href="sample-size-planning-for-anova.html#balanced-designs" id="toc-balanced-designs"><span class="toc-section-number">19.3.1</span> Balanced Designs</a></li>
<li><a href="sample-size-planning-for-anova.html#randomized-block-experiments" id="toc-randomized-block-experiments"><span class="toc-section-number">19.3.2</span> Randomized Block Experiments</a></li>
</ul></li>
<li><a href="randomized-block-designs.html#randomized-block-designs" id="toc-randomized-block-designs"><span class="toc-section-number">19.4</span> Randomized Block Designs</a>
<ul>
<li><a href="randomized-block-designs.html#tukey-test-of-additivity" id="toc-tukey-test-of-additivity"><span class="toc-section-number">19.4.1</span> Tukey Test of Additivity</a></li>
</ul></li>
<li><a href="nested-designs.html#nested-designs" id="toc-nested-designs"><span class="toc-section-number">19.5</span> Nested Designs</a>
<ul>
<li><a href="nested-designs.html#two-factor-nested-designs" id="toc-two-factor-nested-designs"><span class="toc-section-number">19.5.1</span> Two-Factor Nested Designs</a></li>
</ul></li>
<li><a href="single-factor-covariance-model.html#single-factor-covariance-model" id="toc-single-factor-covariance-model"><span class="toc-section-number">19.6</span> Single Factor Covariance Model</a></li>
</ul></li>
<li><a href="multivariate-methods.html#multivariate-methods" id="toc-multivariate-methods"><span class="toc-section-number">20</span> Multivariate Methods</a>
<ul>
<li><a href="multivariate-methods.html#properties-of-mvn" id="toc-properties-of-mvn"><span class="toc-section-number">20.0.1</span> Properties of MVN</a></li>
<li><a href="multivariate-methods.html#mean-vector-inference" id="toc-mean-vector-inference"><span class="toc-section-number">20.0.2</span> Mean Vector Inference</a></li>
<li><a href="multivariate-methods.html#general-hypothesis-testing" id="toc-general-hypothesis-testing"><span class="toc-section-number">20.0.3</span> General Hypothesis Testing</a></li>
<li><a href="manova.html#manova" id="toc-manova"><span class="toc-section-number">20.1</span> MANOVA</a>
<ul>
<li><a href="manova.html#testing-general-hypotheses" id="toc-testing-general-hypotheses"><span class="toc-section-number">20.1.1</span> Testing General Hypotheses</a></li>
<li><a href="manova.html#profile-analysis" id="toc-profile-analysis"><span class="toc-section-number">20.1.2</span> Profile Analysis</a></li>
<li><a href="manova.html#summary-5" id="toc-summary-5"><span class="toc-section-number">20.1.3</span> Summary</a></li>
</ul></li>
<li><a href="principal-components.html#principal-components" id="toc-principal-components"><span class="toc-section-number">20.2</span> Principal Components</a>
<ul>
<li><a href="principal-components.html#population-principal-components" id="toc-population-principal-components"><span class="toc-section-number">20.2.1</span> Population Principal Components</a></li>
<li><a href="principal-components.html#sample-principal-components" id="toc-sample-principal-components"><span class="toc-section-number">20.2.2</span> Sample Principal Components</a></li>
<li><a href="principal-components.html#application-10" id="toc-application-10"><span class="toc-section-number">20.2.3</span> Application</a></li>
</ul></li>
<li><a href="factor-analysis.html#factor-analysis" id="toc-factor-analysis"><span class="toc-section-number">20.3</span> Factor Analysis</a>
<ul>
<li><a href="factor-analysis.html#methods-of-estimation" id="toc-methods-of-estimation"><span class="toc-section-number">20.3.1</span> Methods of Estimation</a></li>
<li><a href="factor-analysis.html#factor-rotation" id="toc-factor-rotation"><span class="toc-section-number">20.3.2</span> Factor Rotation</a></li>
<li><a href="factor-analysis.html#estimation-of-factor-scores" id="toc-estimation-of-factor-scores"><span class="toc-section-number">20.3.3</span> Estimation of Factor Scores</a></li>
<li><a href="factor-analysis.html#model-diagnostic" id="toc-model-diagnostic"><span class="toc-section-number">20.3.4</span> Model Diagnostic</a></li>
<li><a href="factor-analysis.html#application-11" id="toc-application-11"><span class="toc-section-number">20.3.5</span> Application</a></li>
</ul></li>
<li><a href="discriminant-analysis.html#discriminant-analysis" id="toc-discriminant-analysis"><span class="toc-section-number">20.4</span> Discriminant Analysis</a>
<ul>
<li><a href="discriminant-analysis.html#known-populations" id="toc-known-populations"><span class="toc-section-number">20.4.1</span> Known Populations</a></li>
<li><a href="discriminant-analysis.html#probabilities-of-misclassification" id="toc-probabilities-of-misclassification"><span class="toc-section-number">20.4.2</span> Probabilities of Misclassification</a></li>
<li><a href="discriminant-analysis.html#unknown-populations-nonparametric-discrimination" id="toc-unknown-populations-nonparametric-discrimination"><span class="toc-section-number">20.4.3</span> Unknown Populations/ Nonparametric Discrimination</a></li>
<li><a href="discriminant-analysis.html#application-12" id="toc-application-12"><span class="toc-section-number">20.4.4</span> Application</a></li>
</ul></li>
</ul></li>
<li><a href="#part-b.-quasi-experimental-design" id="toc-part-b.-quasi-experimental-design">(PART*) B. QUASI-EXPERIMENTAL DESIGN</a></li>
<li><a href="quasi-experimental.html#quasi-experimental" id="toc-quasi-experimental"><span class="toc-section-number">21</span> Quasi-experimental</a></li>
<li><a href="regression-discontinuity.html#regression-discontinuity" id="toc-regression-discontinuity"><span class="toc-section-number">22</span> Regression Discontinuity</a>
<ul>
<li><a href="specification-checks.html#specification-checks" id="toc-specification-checks"><span class="toc-section-number">22.1</span> Specification Checks</a>
<ul>
<li><a href="specification-checks.html#balance-checks" id="toc-balance-checks"><span class="toc-section-number">22.1.1</span> Balance Checks</a></li>
<li><a href="specification-checks.html#sortingbunchingmanipulation" id="toc-sortingbunchingmanipulation"><span class="toc-section-number">22.1.2</span> Sorting/Bunching/Manipulation</a></li>
<li><a href="specification-checks.html#placebo-tests" id="toc-placebo-tests"><span class="toc-section-number">22.1.3</span> Placebo Tests</a></li>
<li><a href="specification-checks.html#sensitivity-to-bandwidth-choice" id="toc-sensitivity-to-bandwidth-choice"><span class="toc-section-number">22.1.4</span> Sensitivity to Bandwidth Choice</a></li>
<li><a href="specification-checks.html#fuzzy-rd-design" id="toc-fuzzy-rd-design"><span class="toc-section-number">22.1.5</span> Fuzzy RD Design</a></li>
<li><a href="specification-checks.html#regression-kink-design" id="toc-regression-kink-design"><span class="toc-section-number">22.1.6</span> Regression Kink Design</a></li>
<li><a href="specification-checks.html#mutli-cutoff-multi-score-geographic-rd" id="toc-mutli-cutoff-multi-score-geographic-rd"><span class="toc-section-number">22.1.7</span> Mutli-cutoff, Multi-score, geographic RD</a></li>
</ul></li>
<li><a href="steps-for-sharp-rd.html#steps-for-sharp-rd" id="toc-steps-for-sharp-rd"><span class="toc-section-number">22.2</span> Steps for Sharp RD</a></li>
<li><a href="steps-for-fuzzy-rd.html#steps-for-fuzzy-rd" id="toc-steps-for-fuzzy-rd"><span class="toc-section-number">22.3</span> Steps for Fuzzy RD</a></li>
<li><a href="steps-for-rdit-regression-discontinuity-in-time.html#steps-for-rdit-regression-discontinuity-in-time" id="toc-steps-for-rdit-regression-discontinuity-in-time"><span class="toc-section-number">22.4</span> Steps for RDiT (Regression Discontinuity in Time)</a></li>
<li><a href="evaluation-of-an-rd.html#evaluation-of-an-rd" id="toc-evaluation-of-an-rd"><span class="toc-section-number">22.5</span> Evaluation of an RD</a></li>
<li><a href="applications.html#applications" id="toc-applications"><span class="toc-section-number">22.6</span> Applications</a>
<ul>
<li><a href="applications.html#example-1-1" id="toc-example-1-1"><span class="toc-section-number">22.6.1</span> Example 1</a></li>
<li><a href="applications.html#example-2" id="toc-example-2"><span class="toc-section-number">22.6.2</span> Example 2</a></li>
<li><a href="applications.html#example-3" id="toc-example-3"><span class="toc-section-number">22.6.3</span> Example 3</a></li>
<li><a href="applications.html#example-4" id="toc-example-4"><span class="toc-section-number">22.6.4</span> Example 4</a></li>
</ul></li>
</ul></li>
<li><a href="difference-in-differences.html#difference-in-differences" id="toc-difference-in-differences"><span class="toc-section-number">23</span> Difference-in-differences</a>
<ul>
<li><a href="simple-dif-n-dif.html#simple-dif-n-dif" id="toc-simple-dif-n-dif"><span class="toc-section-number">23.1</span> Simple Dif-n-dif</a>
<ul>
<li><a href="simple-dif-n-dif.html#assumptions-2" id="toc-assumptions-2"><span class="toc-section-number">23.1.1</span> Assumptions</a></li>
<li><a href="simple-dif-n-dif.html#examples" id="toc-examples"><span class="toc-section-number">23.1.2</span> Examples</a></li>
</ul></li>
<li><a href="multiple-periods-and-variation-in-treatment-timing.html#multiple-periods-and-variation-in-treatment-timing" id="toc-multiple-periods-and-variation-in-treatment-timing"><span class="toc-section-number">23.2</span> Multiple periods and variation in treatment timing</a></li>
<li><a href="staggered-dif-n-dif.html#staggered-dif-n-dif" id="toc-staggered-dif-n-dif"><span class="toc-section-number">23.3</span> Staggered Dif-n-dif</a>
<ul>
<li><a href="staggered-dif-n-dif.html#example-by-doleac2020" id="toc-example-by-doleac2020"><span class="toc-section-number">23.3.1</span> Example by <span class="citation">Doleac and Hansen (<span>2020</span>)</span></a></li>
</ul></li>
<li><a href="two-way-fixed-effects.html#two-way-fixed-effects" id="toc-two-way-fixed-effects"><span class="toc-section-number">23.4</span> Two-way Fixed-effects</a></li>
</ul></li>
<li><a href="synthetic-control.html#synthetic-control" id="toc-synthetic-control"><span class="toc-section-number">24</span> Synthetic Control</a>
<ul>
<li><a href="synthetic-control.html#example-1-2" id="toc-example-1-2"><span class="toc-section-number">24.0.1</span> Example 1</a></li>
<li><a href="synthetic-control.html#example-2-1" id="toc-example-2-1"><span class="toc-section-number">24.0.2</span> Example 2</a></li>
<li><a href="synthetic-control.html#example-3-1" id="toc-example-3-1"><span class="toc-section-number">24.0.3</span> Example 3</a></li>
<li><a href="synthetic-control.html#example-4-1" id="toc-example-4-1"><span class="toc-section-number">24.0.4</span> Example 4</a></li>
<li><a href="synthetic-difference-in-differences.html#synthetic-difference-in-differences" id="toc-synthetic-difference-in-differences"><span class="toc-section-number">24.1</span> Synthetic Difference-in-differences</a></li>
</ul></li>
<li><a href="event-studies.html#event-studies" id="toc-event-studies"><span class="toc-section-number">25</span> Event Studies</a>
<ul>
<li><a href="other-issues.html#other-issues" id="toc-other-issues"><span class="toc-section-number">25.1</span> Other Issues</a>
<ul>
<li><a href="other-issues.html#economic-significance" id="toc-economic-significance"><span class="toc-section-number">25.1.1</span> Economic significance</a></li>
<li><a href="other-issues.html#statistical-power" id="toc-statistical-power"><span class="toc-section-number">25.1.2</span> Statistical Power</a></li>
<li><a href="other-issues.html#testing" id="toc-testing"><span class="toc-section-number">25.1.3</span> Testing</a></li>
<li><a href="other-issues.html#confounders" id="toc-confounders"><span class="toc-section-number">25.1.4</span> Confounders</a></li>
<li><a href="other-issues.html#biases" id="toc-biases"><span class="toc-section-number">25.1.5</span> Biases</a></li>
<li><a href="other-issues.html#long-run-event-studies" id="toc-long-run-event-studies"><span class="toc-section-number">25.1.6</span> Long-run event studies</a></li>
</ul></li>
<li><a href="aggregation.html#aggregation" id="toc-aggregation"><span class="toc-section-number">25.2</span> Aggregation</a>
<ul>
<li><a href="aggregation.html#over-time" id="toc-over-time"><span class="toc-section-number">25.2.1</span> Over Time</a></li>
<li><a href="aggregation.html#across-firms-over-time" id="toc-across-firms-over-time"><span class="toc-section-number">25.2.2</span> Across Firms + Over Time</a></li>
</ul></li>
<li><a href="heterogeneity-in-the-event-effect.html#heterogeneity-in-the-event-effect" id="toc-heterogeneity-in-the-event-effect"><span class="toc-section-number">25.3</span> Heterogeneity in the event effect</a></li>
<li><a href="expected-return-calculation.html#expected-return-calculation" id="toc-expected-return-calculation"><span class="toc-section-number">25.4</span> Expected Return Calculation</a>
<ul>
<li><a href="expected-return-calculation.html#statistical-models" id="toc-statistical-models"><span class="toc-section-number">25.4.1</span> Statistical Models</a></li>
<li><a href="expected-return-calculation.html#economic-model" id="toc-economic-model"><span class="toc-section-number">25.4.2</span> Economic Model</a></li>
</ul></li>
<li><a href="application-13.html#application-13" id="toc-application-13"><span class="toc-section-number">25.5</span> Application</a></li>
</ul></li>
<li><a href="matching-methods.html#matching-methods" id="toc-matching-methods"><span class="toc-section-number">26</span> Matching Methods</a>
<ul>
<li><a href="matchit.html#matchit" id="toc-matchit"><span class="toc-section-number">26.1</span> MatchIt</a></li>
<li><a href="matchingfrontier.html#matchingfrontier" id="toc-matchingfrontier"><span class="toc-section-number">26.2</span> MatchingFrontier</a></li>
<li><a href="propensity-scores.html#propensity-scores" id="toc-propensity-scores"><span class="toc-section-number">26.3</span> Propensity Scores</a></li>
<li><a href="mahalanobis-distance.html#mahalanobis-distance" id="toc-mahalanobis-distance"><span class="toc-section-number">26.4</span> Mahalanobis Distance</a></li>
<li><a href="coarsened-exact-matching.html#coarsened-exact-matching" id="toc-coarsened-exact-matching"><span class="toc-section-number">26.5</span> Coarsened Exact Matching</a></li>
<li><a href="genetic-matching.html#genetic-matching" id="toc-genetic-matching"><span class="toc-section-number">26.6</span> Genetic Matching</a></li>
<li><a href="matching-for-time-series-cross-section-data.html#matching-for-time-series-cross-section-data" id="toc-matching-for-time-series-cross-section-data"><span class="toc-section-number">26.7</span> Matching for time series-cross-section data</a></li>
</ul></li>
<li><a href="interrupted-time-series.html#interrupted-time-series" id="toc-interrupted-time-series"><span class="toc-section-number">27</span> Interrupted Time Series</a></li>
<li><a href="#part-c.-other-concerns" id="toc-part-c.-other-concerns">(PART*) C. OTHER CONCERNS</a></li>
<li><a href="endogeneity.html#endogeneity" id="toc-endogeneity"><span class="toc-section-number">28</span> Endogeneity</a>
<ul>
<li><a href="measurement-error.html#measurement-error" id="toc-measurement-error"><span class="toc-section-number">28.1</span> Measurement Error</a>
<ul>
<li><a href="measurement-error.html#classical-measurement-errors" id="toc-classical-measurement-errors"><span class="toc-section-number">28.1.1</span> Classical Measurement Errors</a></li>
<li><a href="measurement-error.html#non-classical-measurement-errors" id="toc-non-classical-measurement-errors"><span class="toc-section-number">28.1.2</span> Non-classical Measurement Errors</a></li>
<li><a href="measurement-error.html#solution-to-measurement-errors" id="toc-solution-to-measurement-errors"><span class="toc-section-number">28.1.3</span> Solution to Measurement Errors</a></li>
</ul></li>
<li><a href="simultaneity.html#simultaneity" id="toc-simultaneity"><span class="toc-section-number">28.2</span> Simultaneity</a></li>
<li><a href="endogenous-treatment.html#endogenous-treatment" id="toc-endogenous-treatment"><span class="toc-section-number">28.3</span> Endogenous Treatment</a>
<ul>
<li><a href="endogenous-treatment.html#instrumental-variable" id="toc-instrumental-variable"><span class="toc-section-number">28.3.1</span> Instrumental Variable</a></li>
<li><a href="endogenous-treatment.html#internal-instrumental-variable" id="toc-internal-instrumental-variable"><span class="toc-section-number">28.3.2</span> Internal instrumental variable</a></li>
<li><a href="endogenous-treatment.html#proxy-variables" id="toc-proxy-variables"><span class="toc-section-number">28.3.3</span> Proxy Variables</a></li>
</ul></li>
<li><a href="endogenous-sample-selection.html#endogenous-sample-selection" id="toc-endogenous-sample-selection"><span class="toc-section-number">28.4</span> Endogenous Sample Selection</a>
<ul>
<li><a href="endogenous-sample-selection.html#tobit-2" id="toc-tobit-2"><span class="toc-section-number">28.4.1</span> Tobit-2</a></li>
<li><a href="endogenous-sample-selection.html#tobit-5" id="toc-tobit-5"><span class="toc-section-number">28.4.2</span> Tobit-5</a></li>
</ul></li>
</ul></li>
<li><a href="mediation.html#mediation" id="toc-mediation"><span class="toc-section-number">29</span> Mediation</a>
<ul>
<li><a href="traditional.html#traditional" id="toc-traditional"><span class="toc-section-number">29.1</span> Traditional</a>
<ul>
<li><a href="traditional.html#example-1-mediation-traditional" id="toc-example-1-mediation-traditional"><span class="toc-section-number">29.1.1</span> Example 1</a></li>
</ul></li>
<li><a href="model-based-causal-mediation-analysis.html#model-based-causal-mediation-analysis" id="toc-model-based-causal-mediation-analysis"><span class="toc-section-number">29.2</span> Model-based causal mediation analysis</a></li>
</ul></li>
<li><a href="directed-acyclic-graph.html#directed-acyclic-graph" id="toc-directed-acyclic-graph"><span class="toc-section-number">30</span> Directed Acyclic Graph</a></li>
<li><a href="#part-v.-miscellaneous" id="toc-part-v.-miscellaneous">(PART*) V. MISCELLANEOUS</a></li>
<li><a href="report.html#report" id="toc-report"><span class="toc-section-number">31</span> Report</a>
<ul>
<li><a href="one-summary-table.html#one-summary-table" id="toc-one-summary-table"><span class="toc-section-number">31.1</span> One summary table</a></li>
<li><a href="model-comparison.html#model-comparison" id="toc-model-comparison"><span class="toc-section-number">31.2</span> Model Comparison</a></li>
<li><a href="changes-in-an-estimate.html#changes-in-an-estimate" id="toc-changes-in-an-estimate"><span class="toc-section-number">31.3</span> Changes in an estimate</a></li>
</ul></li>
<li><a href="exploratory-data-analysis.html#exploratory-data-analysis" id="toc-exploratory-data-analysis"><span class="toc-section-number">32</span> Exploratory Data Analysis</a></li>
<li><a href="sensitivity-analysis-robustness-check.html#sensitivity-analysis-robustness-check" id="toc-sensitivity-analysis-robustness-check"><span class="toc-section-number">33</span> Sensitivity Analysis/ Robustness Check</a>
<ul>
<li><a href="specification-curve.html#specification-curve" id="toc-specification-curve"><span class="toc-section-number">33.1</span> Specification curve</a>
<ul>
<li><a href="specification-curve.html#starbility" id="toc-starbility"><span class="toc-section-number">33.1.1</span> starbility</a></li>
<li><a href="specification-curve.html#rdfanalysis" id="toc-rdfanalysis"><span class="toc-section-number">33.1.2</span> rdfanalysis</a></li>
</ul></li>
<li><a href="coefficient-stability.html#coefficient-stability" id="toc-coefficient-stability"><span class="toc-section-number">33.2</span> Coefficient stability</a></li>
</ul></li>
<li><a href="#appendix-appendix" id="toc-appendix-appendix">(APPENDIX) APPENDIX</a></li>
<li><a href="appendix.html#appendix" id="toc-appendix"><span class="toc-section-number">34</span> Appendix</a>
<ul>
<li><a href="git.html#git" id="toc-git"><span class="toc-section-number">34.1</span> Git</a></li>
<li><a href="short-cut.html#short-cut" id="toc-short-cut"><span class="toc-section-number">34.2</span> Short-cut</a></li>
<li><a href="function-short-cut.html#function-short-cut" id="toc-function-short-cut"><span class="toc-section-number">34.3</span> Function short-cut</a></li>
<li><a href="citation.html#citation" id="toc-citation"><span class="toc-section-number">34.4</span> Citation</a></li>
<li><a href="install-all-necessary-packageslibaries-on-your-local-machine.html#install-all-necessary-packageslibaries-on-your-local-machine" id="toc-install-all-necessary-packageslibaries-on-your-local-machine"><span class="toc-section-number">34.5</span> Install all necessary packages/libaries on your local machine</a></li>
</ul></li>
<li><a href="bookdown-cheat-sheet.html#bookdown-cheat-sheet" id="toc-bookdown-cheat-sheet"><span class="toc-section-number">35</span> Bookdown cheat sheet</a>
<ul>
<li><a href="operation.html#operation" id="toc-operation"><span class="toc-section-number">35.1</span> Operation</a></li>
<li><a href="math-expresssion-syntax.html#math-expresssion-syntax" id="toc-math-expresssion-syntax"><span class="toc-section-number">35.2</span> Math Expresssion/ Syntax</a>
<ul>
<li><a href="math-expresssion-syntax.html#statistics-notation" id="toc-statistics-notation"><span class="toc-section-number">35.2.1</span> Statistics Notation</a></li>
</ul></li>
<li><a href="table.html#table" id="toc-table"><span class="toc-section-number">35.3</span> Table</a></li>
</ul></li>
<li><a href="references.html#references" id="toc-references">References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A Guide on Data Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="endogenous-sample-selection" class="section level2" number="28.4">
<h2><span class="header-section-number">28.4</span> Endogenous Sample Selection</h2>
<p>sample selection or self-selection problem</p>
<p>the omitted variable is how people were selected into the sample</p>
<p>Some disciplines consider nonresponse bias and selection bias as sample selection.</p>
<ul>
<li>When unobservable factors that affect who is in the sample are independent of unobservable factors that affect the outcome, the sample selection is not endogenous. Hence, the sample selection is ignorable and estimator that ignores sample selection is still consistent.</li>
<li>when the unobservable factors that affect who is included in the sample are correlated with the unobservable factors that affect the outcome, the sample selection is endogenous and not ignorable, because estimators that ignore endogenous sample selection are not consistent (we don’t know which part of the observable outcome is related to the causal relationship and which part is due to different people were selected for the treatment and control groups).</li>
</ul>
<p>Assumptions: - The unobservables that affect the treatment selection and the outcome are jointly distributed as bivariate normal.</p>
<p>Notes: - If you don’t have strong exclusion restriction, identification is driven by the assumed non linearity in the functional form (through inverse Mills ratio). E.g., the estimate depend on the bivariate normal distribution of the error structure:</p>
<pre><code>+ With strong exclusion restriction for the covariate in the correction equation, the variation in this vairable can help idnetify the control for selection 
+ With weak exclusion restriction, and the coavriate exists in both steps, it&#39;s the assumed error structure that identifies the control for selection. </code></pre>
<p>To combat Sample selection, we can</p>
<ul>
<li>Randomization: participants are randomly selected into treatment and control.</li>
<li>Instruments that determine the treatment status (i.e., treatment vs. control) but not the outcome (Y)</li>
<li>Functional form of the selection and outcome processes: originated from <span class="citation">(<a href="#ref-Heckman_1976" role="doc-biblioref">James J. Heckman 1976</a>)</span>, later on generalize by <span class="citation">(<a href="#ref-Amemiya_1984" role="doc-biblioref">Amemiya 1984</a>)</span></li>
</ul>
<p>We have our main model</p>
<p><span class="math display">\[
\mathbf{y^* = xb + \epsilon}
\]</span></p>
<p>However, the pattern of missingness (i.e., censored) is related to the unobserved (latent) process:</p>
<p><span class="math display">\[
\mathbf{z^* = w \gamma + u}
\]</span></p>
<p>and</p>
<p><span class="math display">\[
z_i =
\begin{cases}
1&amp; \text{if } z_i^*&gt;0 \\
0&amp;\text{if } z_i^*\le0\\
\end{cases}
\]</span></p>
<p>Equivalently, <span class="math inline">\(z_i = 1\)</span> (<span class="math inline">\(y_i\)</span> is observed) when</p>
<p><span class="math display">\[
u_i \ge -w_i \gamma
\]</span></p>
<p>Hence, the probability of observed <span class="math inline">\(y_i\)</span> is</p>
<p><span class="math display">\[
\begin{aligned}
P(u_i \ge -w_i \gamma) &amp;= 1 - \Phi(-w_i \gamma) \\
&amp;= \Phi(w_i \gamma) &amp; \text{symmetry of the standard normal distribution}
\end{aligned}
\]</span></p>
<p>We will <strong>assume</strong></p>
<ul>
<li>the error term of the selection <span class="math inline">\(\mathbf{u \sim N(0,I)}\)</span></li>
<li><span class="math inline">\(Var(u_i) = 1\)</span> for identification purposes</li>
</ul>
<p>Visually, <span class="math inline">\(P(u_i \ge -w_i \gamma)\)</span> is the shaded area.</p>
<div class="sourceCode" id="cb451"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb451-1"><a href="endogenous-sample-selection.html#cb451-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="at">length =</span> <span class="dv">200</span>)</span>
<span id="cb451-2"><a href="endogenous-sample-selection.html#cb451-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">dnorm</span>(x, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb451-3"><a href="endogenous-sample-selection.html#cb451-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,</span>
<span id="cb451-4"><a href="endogenous-sample-selection.html#cb451-4" aria-hidden="true" tabindex="-1"></a>     y,</span>
<span id="cb451-5"><a href="endogenous-sample-selection.html#cb451-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">&quot;l&quot;</span>,</span>
<span id="cb451-6"><a href="endogenous-sample-selection.html#cb451-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="fu">bquote</span>(<span class="st">&quot;Probabibility distribution of&quot;</span> <span class="sc">~</span> u[i]))</span>
<span id="cb451-7"><a href="endogenous-sample-selection.html#cb451-7" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">seq</span>(<span class="fl">0.3</span>, <span class="dv">3</span>, <span class="at">length =</span> <span class="dv">100</span>)</span>
<span id="cb451-8"><a href="endogenous-sample-selection.html#cb451-8" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">dnorm</span>(x, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb451-9"><a href="endogenous-sample-selection.html#cb451-9" aria-hidden="true" tabindex="-1"></a><span class="fu">polygon</span>(<span class="fu">c</span>(<span class="fl">0.3</span>, x, <span class="dv">3</span>), <span class="fu">c</span>(<span class="dv">0</span>, y, <span class="dv">0</span>), <span class="at">col =</span> <span class="st">&quot;gray&quot;</span>)</span>
<span id="cb451-10"><a href="endogenous-sample-selection.html#cb451-10" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">1</span>, <span class="fl">0.1</span>, <span class="fu">bquote</span>(<span class="dv">1</span> <span class="sc">-</span> Phi <span class="sc">~</span> (<span class="sc">-</span>w[i] <span class="sc">~</span> gamma)))</span>
<span id="cb451-11"><a href="endogenous-sample-selection.html#cb451-11" aria-hidden="true" tabindex="-1"></a><span class="fu">arrows</span>(<span class="sc">-</span><span class="fl">0.5</span>, <span class="fl">0.1</span>, <span class="fl">0.3</span>, <span class="dv">0</span>, <span class="at">length =</span> .<span class="dv">15</span>)</span>
<span id="cb451-12"><a href="endogenous-sample-selection.html#cb451-12" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="sc">-</span><span class="fl">0.5</span>, <span class="fl">0.12</span>, <span class="fu">bquote</span>(<span class="sc">-</span>w[i] <span class="sc">~</span> gamma))</span>
<span id="cb451-13"><a href="endogenous-sample-selection.html#cb451-13" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(</span>
<span id="cb451-14"><a href="endogenous-sample-selection.html#cb451-14" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;topright&quot;</span>,</span>
<span id="cb451-15"><a href="endogenous-sample-selection.html#cb451-15" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Gray = Prob of Observed&quot;</span>,</span>
<span id="cb451-16"><a href="endogenous-sample-selection.html#cb451-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">1</span>,</span>
<span id="cb451-17"><a href="endogenous-sample-selection.html#cb451-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">&quot;legend&quot;</span>,</span>
<span id="cb451-18"><a href="endogenous-sample-selection.html#cb451-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">inset =</span> .<span class="dv">02</span></span>
<span id="cb451-19"><a href="endogenous-sample-selection.html#cb451-19" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="29-endogeneity_files/figure-html/unnamed-chunk-12-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Hence in our observed model, we see</p>
<span class="math display">\[\begin{equation}
y_i = x_i\beta + \epsilon_i \text{when $z_i=1$}
\end{equation}\]</span>
<p>and the joint distribution of the selection model (<span class="math inline">\(u_i\)</span>), and the observed equation (<span class="math inline">\(\epsilon_i\)</span>) as</p>
<p><span class="math display">\[
\left[
\begin{array}
{c}
u \\
\epsilon \\
\end{array}
\right]
\sim^{iid}N
\left(
\left[
\begin{array}
{c}
0 \\
0 \\
\end{array}
\right],
\left[
\begin{array}
{cc}
1 &amp; \rho \\
\rho &amp; \sigma^2_{\epsilon} \\
\end{array}
\right]
\right)
\]</span></p>
<p>The relation between the observed and selection models:</p>
<p><span class="math display">\[
\begin{aligned}
E(y_i | y_i \text{ observed}) &amp;= E(y_i| z^*&gt;0) \\
&amp;= E(y_i| -w_i \gamma) \\
&amp;= \mathbf{x}_i \beta + E(\epsilon_i | u_i &gt; -w_i \gamma) \\
&amp;= \mathbf{x}_i \beta + \rho \sigma_\epsilon \frac{\phi(w_i \gamma)}{\Phi(w_i \gamma)}
\end{aligned}
\]</span></p>
<p>where <span class="math inline">\(\frac{\phi(w_i \gamma)}{\Phi(w_i \gamma)}\)</span> is the Inverse Mills Ratio. and <span class="math inline">\(\rho \sigma_\epsilon \frac{\phi(w_i \gamma)}{\Phi(w_i \gamma)} \ge 0\)</span></p>
<p>Great visualization of special cases of correlation patterns amongst data and errors by professor <a href="https://rlhick.people.wm.edu/stories/econ_407_notes_heckman.html">Rob Hick</a></p>
<p>Note:</p>
<p><span class="citation">(<a href="#ref-Bareinboim_2014" role="doc-biblioref">Bareinboim, Tian, and Pearl 2014</a>)</span> is an excellent summary of cases that we can still do causal inference in case of selection bias. I’ll try to summarize their idea here:</p>
<p>Let X be an action, Y be an outcome, and S be a binary indicator of entry into the data pool where (S = 1 = in the sample, S = 0 =out of sample) and Q be the conditional distribution <span class="math inline">\(Q = P(y|x)\)</span>.</p>
<p>Usually we want to understand , but because of S, we only have <span class="math inline">\(P(y, x|S = 1)\)</span>. Hence, we’d like to recover <span class="math inline">\(P(y|x)\)</span> from <span class="math inline">\(P(y, x|S = 1)\)</span></p>
<ul>
<li>If both X and Y affect S, we can’t unbiasedly estimate <span class="math inline">\(P(y|x)\)</span></li>
</ul>
<p>In the case of Omitted variable bias (U) and sample selection bias (S), you have unblocked extraneous “flow” of information between X and Y, which causes spurious correlation for X and Y. Traditionally, we would recover Q by parametric assumption of</p>
<ol style="list-style-type: decimal">
<li>the data generating process (e.g., Heckman 2-step)<br />
</li>
<li>type of data-generating model (e..g, treatment-dependent or outcome-dependent)<br />
</li>
<li>selection’s probability <span class="math inline">\(P(S = 1|P a_s)\)</span> with non-parametrically based causal graphical models, the authors proposed more robust way to model misspecification regardless of the type of data-generating model, and do not require selection’s probability. Hence, you can recover Q</li>
</ol>
<ul>
<li>without external data</li>
<li>with external data<br />
</li>
<li>causal effects with the Selection-backdoor criterion</li>
</ul>
<div id="tobit-2" class="section level3" number="28.4.1">
<h3><span class="header-section-number">28.4.1</span> Tobit-2</h3>
<p>also known as Heckman’s standard sample selection model<br />
Assumption: joint normality of the errors</p>
<p>Data here is taken from <span class="citation">(<a href="#ref-Mroz_1987" role="doc-biblioref">Mroz 1987</a>)</span>’s paper.</p>
<p>We want to estimate the log(wage) for married women, with education, experience, experience squared, and a dummy variable for living in a big city. But we can only observe the wage for women who are working, which means a lot of married women in 1975 who were out of the labor force are unaccounted for. Hence, an OLS estimate of the wage equation would be bias due to sample selection. Since we have data on non-participants (i.e., those who are not working for pay), we can correct for the selection process.</p>
<p>The Tobit-2 estimates are consistent</p>
<div id="example-1-3" class="section level4" number="28.4.1.1">
<h4><span class="header-section-number">28.4.1.1</span> Example 1</h4>
<div class="sourceCode" id="cb452"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb452-1"><a href="endogenous-sample-selection.html#cb452-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sampleSelection)</span>
<span id="cb452-2"><a href="endogenous-sample-selection.html#cb452-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb452-3"><a href="endogenous-sample-selection.html#cb452-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;Mroz87&quot;</span>) <span class="co">#1975 data on married women’s pay and labor-force participation from the Panel Study of Income Dynamics (PSID)</span></span>
<span id="cb452-4"><a href="endogenous-sample-selection.html#cb452-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Mroz87)</span>
<span id="cb452-5"><a href="endogenous-sample-selection.html#cb452-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   lfp hours kids5 kids618 age educ   wage repwage hushrs husage huseduc huswage</span></span>
<span id="cb452-6"><a href="endogenous-sample-selection.html#cb452-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1   1  1610     1       0  32   12 3.3540    2.65   2708     34      12  4.0288</span></span>
<span id="cb452-7"><a href="endogenous-sample-selection.html#cb452-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2   1  1656     0       2  30   12 1.3889    2.65   2310     30       9  8.4416</span></span>
<span id="cb452-8"><a href="endogenous-sample-selection.html#cb452-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3   1  1980     1       3  35   12 4.5455    4.04   3072     40      12  3.5807</span></span>
<span id="cb452-9"><a href="endogenous-sample-selection.html#cb452-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4   1   456     0       3  34   12 1.0965    3.25   1920     53      10  3.5417</span></span>
<span id="cb452-10"><a href="endogenous-sample-selection.html#cb452-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5   1  1568     1       2  31   14 4.5918    3.60   2000     32      12 10.0000</span></span>
<span id="cb452-11"><a href="endogenous-sample-selection.html#cb452-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6   1  2032     0       0  54   12 4.7421    4.70   1040     57      11  6.7106</span></span>
<span id="cb452-12"><a href="endogenous-sample-selection.html#cb452-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   faminc    mtr motheduc fatheduc unem city exper  nwifeinc wifecoll huscoll</span></span>
<span id="cb452-13"><a href="endogenous-sample-selection.html#cb452-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1  16310 0.7215       12        7  5.0    0    14 10.910060    FALSE   FALSE</span></span>
<span id="cb452-14"><a href="endogenous-sample-selection.html#cb452-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2  21800 0.6615        7        7 11.0    1     5 19.499981    FALSE   FALSE</span></span>
<span id="cb452-15"><a href="endogenous-sample-selection.html#cb452-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3  21040 0.6915       12        7  5.0    0    15 12.039910    FALSE   FALSE</span></span>
<span id="cb452-16"><a href="endogenous-sample-selection.html#cb452-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4   7300 0.7815        7        7  5.0    0     6  6.799996    FALSE   FALSE</span></span>
<span id="cb452-17"><a href="endogenous-sample-selection.html#cb452-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5  27300 0.6215       12       14  9.5    1     7 20.100058     TRUE   FALSE</span></span>
<span id="cb452-18"><a href="endogenous-sample-selection.html#cb452-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6  19495 0.6915       14        7  7.5    1    33  9.859054    FALSE   FALSE</span></span>
<span id="cb452-19"><a href="endogenous-sample-selection.html#cb452-19" aria-hidden="true" tabindex="-1"></a>Mroz87 <span class="ot">=</span> Mroz87 <span class="sc">%&gt;%</span></span>
<span id="cb452-20"><a href="endogenous-sample-selection.html#cb452-20" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">kids =</span> kids5<span class="sc">+</span>kids618)</span>
<span id="cb452-21"><a href="endogenous-sample-selection.html#cb452-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb452-22"><a href="endogenous-sample-selection.html#cb452-22" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nnet)</span>
<span id="cb452-23"><a href="endogenous-sample-selection.html#cb452-23" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb452-24"><a href="endogenous-sample-selection.html#cb452-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span></code></pre></div>
<p>2-stage Heckman’s model:</p>
<ol style="list-style-type: decimal">
<li>probit equation estimates the selection process (who is in the labor force?)</li>
<li>the results from 1st stage are used to construct a variable that captures the selection effect in the wage equation. This correction variable is called the <strong>inverse Mills ratio</strong>.</li>
</ol>
<div class="sourceCode" id="cb453"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb453-1"><a href="endogenous-sample-selection.html#cb453-1" aria-hidden="true" tabindex="-1"></a><span class="co"># OLS: log wage regression on LF participants only</span></span>
<span id="cb453-2"><a href="endogenous-sample-selection.html#cb453-2" aria-hidden="true" tabindex="-1"></a>ols1 <span class="ot">=</span> <span class="fu">lm</span>(<span class="fu">log</span>(wage) <span class="sc">~</span> educ <span class="sc">+</span> exper <span class="sc">+</span> <span class="fu">I</span>( exper<span class="sc">^</span><span class="dv">2</span> ) <span class="sc">+</span> city, <span class="at">data=</span><span class="fu">subset</span>(Mroz87, lfp<span class="sc">==</span><span class="dv">1</span>))</span>
<span id="cb453-3"><a href="endogenous-sample-selection.html#cb453-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Heckman&#39;s Two-step estimation with LFP selection equation</span></span>
<span id="cb453-4"><a href="endogenous-sample-selection.html#cb453-4" aria-hidden="true" tabindex="-1"></a>heck1 <span class="ot">=</span> <span class="fu">heckit</span>( lfp <span class="sc">~</span> age <span class="sc">+</span> <span class="fu">I</span>( age<span class="sc">^</span><span class="dv">2</span> ) <span class="sc">+</span> kids <span class="sc">+</span> huswage <span class="sc">+</span> educ, <span class="co"># the selection process, lfp = 1 if the woman is participating in the labor force </span></span>
<span id="cb453-5"><a href="endogenous-sample-selection.html#cb453-5" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">log</span>(wage) <span class="sc">~</span> educ <span class="sc">+</span> exper <span class="sc">+</span> <span class="fu">I</span>( exper<span class="sc">^</span><span class="dv">2</span> ) <span class="sc">+</span> city, <span class="at">data=</span>Mroz87 )</span></code></pre></div>
<p>Use only variables that affect the selection process in the selection equation. Technically, the selection equation and the equation of interest could have the same set of regressors. But it is not recommended because we should only use variables (or at least one) in the selection equation that affect the selection process, but not the wage process (i.e., instruments). Here, variable <code>kids</code> fulfill that role: women with kids may be more likely to stay home, but working moms with kids would not have their wages change.</p>
<p>Alternatively,</p>
<div class="sourceCode" id="cb454"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb454-1"><a href="endogenous-sample-selection.html#cb454-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ML estimation of selection model</span></span>
<span id="cb454-2"><a href="endogenous-sample-selection.html#cb454-2" aria-hidden="true" tabindex="-1"></a>ml1 <span class="ot">=</span> <span class="fu">selection</span>( lfp <span class="sc">~</span> age <span class="sc">+</span> <span class="fu">I</span>( age<span class="sc">^</span><span class="dv">2</span> ) <span class="sc">+</span> kids <span class="sc">+</span> huswage <span class="sc">+</span> educ,</span>
<span id="cb454-3"><a href="endogenous-sample-selection.html#cb454-3" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">log</span>(wage) <span class="sc">~</span> educ <span class="sc">+</span> exper <span class="sc">+</span> <span class="fu">I</span>( exper<span class="sc">^</span><span class="dv">2</span> ) <span class="sc">+</span> city, <span class="at">data=</span>Mroz87 ) </span></code></pre></div>
<div class="sourceCode" id="cb455"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb455-1"><a href="endogenous-sample-selection.html#cb455-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;stargazer&quot;</span>)</span>
<span id="cb455-2"><a href="endogenous-sample-selection.html#cb455-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;Mediana&quot;</span>)</span>
<span id="cb455-3"><a href="endogenous-sample-selection.html#cb455-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;plm&quot;</span>)</span>
<span id="cb455-4"><a href="endogenous-sample-selection.html#cb455-4" aria-hidden="true" tabindex="-1"></a><span class="co"># function to calculate corrected SEs for regression </span></span>
<span id="cb455-5"><a href="endogenous-sample-selection.html#cb455-5" aria-hidden="true" tabindex="-1"></a>cse <span class="ot">=</span> <span class="cf">function</span>(reg) {</span>
<span id="cb455-6"><a href="endogenous-sample-selection.html#cb455-6" aria-hidden="true" tabindex="-1"></a>  rob <span class="ot">=</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(reg, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>)))</span>
<span id="cb455-7"><a href="endogenous-sample-selection.html#cb455-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(rob)</span>
<span id="cb455-8"><a href="endogenous-sample-selection.html#cb455-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb455-9"><a href="endogenous-sample-selection.html#cb455-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb455-10"><a href="endogenous-sample-selection.html#cb455-10" aria-hidden="true" tabindex="-1"></a><span class="co"># stargazer table</span></span>
<span id="cb455-11"><a href="endogenous-sample-selection.html#cb455-11" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>(ols1, heck1, ml1,    </span>
<span id="cb455-12"><a href="endogenous-sample-selection.html#cb455-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">se=</span><span class="fu">list</span>(<span class="fu">cse</span>(ols1),<span class="cn">NULL</span>,<span class="cn">NULL</span>), </span>
<span id="cb455-13"><a href="endogenous-sample-selection.html#cb455-13" aria-hidden="true" tabindex="-1"></a>          <span class="at">title=</span><span class="st">&quot;Married women&#39;s wage regressions&quot;</span>, <span class="at">type=</span><span class="st">&quot;text&quot;</span>, </span>
<span id="cb455-14"><a href="endogenous-sample-selection.html#cb455-14" aria-hidden="true" tabindex="-1"></a>          <span class="at">df=</span><span class="cn">FALSE</span>, <span class="at">digits=</span><span class="dv">4</span>, <span class="at">selection.equation =</span> T)</span>
<span id="cb455-15"><a href="endogenous-sample-selection.html#cb455-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb455-16"><a href="endogenous-sample-selection.html#cb455-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Married women&#39;s wage regressions</span></span>
<span id="cb455-17"><a href="endogenous-sample-selection.html#cb455-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ==============================================================</span></span>
<span id="cb455-18"><a href="endogenous-sample-selection.html#cb455-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                Dependent variable:            </span></span>
<span id="cb455-19"><a href="endogenous-sample-selection.html#cb455-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                     ------------------------------------------</span></span>
<span id="cb455-20"><a href="endogenous-sample-selection.html#cb455-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                     log(wage)                lfp              </span></span>
<span id="cb455-21"><a href="endogenous-sample-selection.html#cb455-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                        OLS         Heckman        selection   </span></span>
<span id="cb455-22"><a href="endogenous-sample-selection.html#cb455-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                   selection                   </span></span>
<span id="cb455-23"><a href="endogenous-sample-selection.html#cb455-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                        (1)           (2)             (3)      </span></span>
<span id="cb455-24"><a href="endogenous-sample-selection.html#cb455-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------------------------</span></span>
<span id="cb455-25"><a href="endogenous-sample-selection.html#cb455-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; age                               0.1861***       0.1842***   </span></span>
<span id="cb455-26"><a href="endogenous-sample-selection.html#cb455-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                   (0.0652)        (0.0658)    </span></span>
<span id="cb455-27"><a href="endogenous-sample-selection.html#cb455-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                                               </span></span>
<span id="cb455-28"><a href="endogenous-sample-selection.html#cb455-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; I(age2)                          -0.0024***      -0.0024***   </span></span>
<span id="cb455-29"><a href="endogenous-sample-selection.html#cb455-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                   (0.0008)        (0.0008)    </span></span>
<span id="cb455-30"><a href="endogenous-sample-selection.html#cb455-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                                               </span></span>
<span id="cb455-31"><a href="endogenous-sample-selection.html#cb455-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; kids                             -0.1496***      -0.1488***   </span></span>
<span id="cb455-32"><a href="endogenous-sample-selection.html#cb455-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                   (0.0383)        (0.0385)    </span></span>
<span id="cb455-33"><a href="endogenous-sample-selection.html#cb455-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                                               </span></span>
<span id="cb455-34"><a href="endogenous-sample-selection.html#cb455-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; huswage                          -0.0430***      -0.0434***   </span></span>
<span id="cb455-35"><a href="endogenous-sample-selection.html#cb455-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                   (0.0122)        (0.0123)    </span></span>
<span id="cb455-36"><a href="endogenous-sample-selection.html#cb455-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                                               </span></span>
<span id="cb455-37"><a href="endogenous-sample-selection.html#cb455-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; educ                0.1057***     0.1250***       0.1256***   </span></span>
<span id="cb455-38"><a href="endogenous-sample-selection.html#cb455-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                      (0.0130)     (0.0228)        (0.0229)    </span></span>
<span id="cb455-39"><a href="endogenous-sample-selection.html#cb455-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                                               </span></span>
<span id="cb455-40"><a href="endogenous-sample-selection.html#cb455-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; exper               0.0411***                                 </span></span>
<span id="cb455-41"><a href="endogenous-sample-selection.html#cb455-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                      (0.0154)                                 </span></span>
<span id="cb455-42"><a href="endogenous-sample-selection.html#cb455-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                                               </span></span>
<span id="cb455-43"><a href="endogenous-sample-selection.html#cb455-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; I(exper2)            -0.0008*                                 </span></span>
<span id="cb455-44"><a href="endogenous-sample-selection.html#cb455-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                      (0.0004)                                 </span></span>
<span id="cb455-45"><a href="endogenous-sample-selection.html#cb455-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                                               </span></span>
<span id="cb455-46"><a href="endogenous-sample-selection.html#cb455-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; city                  0.0542                                  </span></span>
<span id="cb455-47"><a href="endogenous-sample-selection.html#cb455-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                      (0.0653)                                 </span></span>
<span id="cb455-48"><a href="endogenous-sample-selection.html#cb455-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                                               </span></span>
<span id="cb455-49"><a href="endogenous-sample-selection.html#cb455-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Constant            -0.5308***   -4.1815***      -4.1484***   </span></span>
<span id="cb455-50"><a href="endogenous-sample-selection.html#cb455-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                      (0.2032)     (1.4024)        (1.4109)    </span></span>
<span id="cb455-51"><a href="endogenous-sample-selection.html#cb455-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                                               </span></span>
<span id="cb455-52"><a href="endogenous-sample-selection.html#cb455-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------------------------</span></span>
<span id="cb455-53"><a href="endogenous-sample-selection.html#cb455-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Observations           428           753             753      </span></span>
<span id="cb455-54"><a href="endogenous-sample-selection.html#cb455-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; R2                    0.1581       0.1582                     </span></span>
<span id="cb455-55"><a href="endogenous-sample-selection.html#cb455-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Adjusted R2           0.1501       0.1482                     </span></span>
<span id="cb455-56"><a href="endogenous-sample-selection.html#cb455-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Log Likelihood                                    -914.0777   </span></span>
<span id="cb455-57"><a href="endogenous-sample-selection.html#cb455-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; rho                                0.0830      0.0505 (0.2317)</span></span>
<span id="cb455-58"><a href="endogenous-sample-selection.html#cb455-58" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Inverse Mills Ratio            0.0551 (0.2099)                </span></span>
<span id="cb455-59"><a href="endogenous-sample-selection.html#cb455-59" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual Std. Error   0.6667                                  </span></span>
<span id="cb455-60"><a href="endogenous-sample-selection.html#cb455-60" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; F Statistic         19.8561***                                </span></span>
<span id="cb455-61"><a href="endogenous-sample-selection.html#cb455-61" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ==============================================================</span></span>
<span id="cb455-62"><a href="endogenous-sample-selection.html#cb455-62" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Note:                              *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01</span></span></code></pre></div>
<p>Rho is an estimate of the correlation of the errors between the selection and wage equations. In the lower panel, the estimated coefficient on the inverse Mills ratio is given for the Heckman model. The fact that it is not statistically different from zero is consistent with the idea that selection bias was not a serious problem in this case.</p>
<p>If the estimated coefficient of the inverse Mills ratio in the Heckman model is not statistically different from zero, then selection bias was not a serious problem.</p>
</div>
<div id="example-2-2" class="section level4" number="28.4.1.2">
<h4><span class="header-section-number">28.4.1.2</span> Example 2</h4>
<p>This code is from <a href="https://cran.r-project.org/web/packages/sampleSelection/vignettes/selection.pdf">R package sampleSelection</a></p>
<div class="sourceCode" id="cb456"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb456-1"><a href="endogenous-sample-selection.html#cb456-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb456-2"><a href="endogenous-sample-selection.html#cb456-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;sampleSelection&quot;</span>)</span>
<span id="cb456-3"><a href="endogenous-sample-selection.html#cb456-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;mvtnorm&quot;</span>)</span>
<span id="cb456-4"><a href="endogenous-sample-selection.html#cb456-4" aria-hidden="true" tabindex="-1"></a>eps <span class="ot">&lt;-</span> <span class="fu">rmvnorm</span>(<span class="dv">500</span>, <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="fl">0.7</span>,<span class="sc">-</span><span class="fl">0.7</span>,<span class="dv">1</span>), <span class="dv">2</span>, <span class="dv">2</span>)) <span class="co"># bivariate normal disturbances</span></span>
<span id="cb456-5"><a href="endogenous-sample-selection.html#cb456-5" aria-hidden="true" tabindex="-1"></a>xs <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">500</span>)<span class="co"># uniformly distributed explanatory variable (vectors of explanatory variables for the selection )</span></span>
<span id="cb456-6"><a href="endogenous-sample-selection.html#cb456-6" aria-hidden="true" tabindex="-1"></a>ys <span class="ot">&lt;-</span> xs <span class="sc">+</span> eps[,<span class="dv">1</span>] <span class="sc">&gt;</span> <span class="dv">0</span> <span class="co"># probit data generating process</span></span>
<span id="cb456-7"><a href="endogenous-sample-selection.html#cb456-7" aria-hidden="true" tabindex="-1"></a>xo <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">500</span>) <span class="co"># vectors of explanatory variables for outcome equation </span></span>
<span id="cb456-8"><a href="endogenous-sample-selection.html#cb456-8" aria-hidden="true" tabindex="-1"></a>yoX <span class="ot">&lt;-</span> xo <span class="sc">+</span> eps[,<span class="dv">2</span>] <span class="co"># latent outcome</span></span>
<span id="cb456-9"><a href="endogenous-sample-selection.html#cb456-9" aria-hidden="true" tabindex="-1"></a>yo <span class="ot">&lt;-</span> yoX<span class="sc">*</span>(ys <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="co"># observable outcome</span></span>
<span id="cb456-10"><a href="endogenous-sample-selection.html#cb456-10" aria-hidden="true" tabindex="-1"></a><span class="co"># true intercepts = 0 and our true slopes = 1</span></span>
<span id="cb456-11"><a href="endogenous-sample-selection.html#cb456-11" aria-hidden="true" tabindex="-1"></a><span class="co"># xs and xo are independent. Hence, exclusion restriction is fulfilled</span></span>
<span id="cb456-12"><a href="endogenous-sample-selection.html#cb456-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>( <span class="fu">selection</span>(ys<span class="sc">~</span>xs, yo <span class="sc">~</span>xo))</span>
<span id="cb456-13"><a href="endogenous-sample-selection.html#cb456-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------</span></span>
<span id="cb456-14"><a href="endogenous-sample-selection.html#cb456-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Tobit 2 model (sample selection model)</span></span>
<span id="cb456-15"><a href="endogenous-sample-selection.html#cb456-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Maximum Likelihood estimation</span></span>
<span id="cb456-16"><a href="endogenous-sample-selection.html#cb456-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Newton-Raphson maximisation, 5 iterations</span></span>
<span id="cb456-17"><a href="endogenous-sample-selection.html#cb456-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Return code 1: gradient close to zero (gradtol)</span></span>
<span id="cb456-18"><a href="endogenous-sample-selection.html#cb456-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Log-Likelihood: -712.3163 </span></span>
<span id="cb456-19"><a href="endogenous-sample-selection.html#cb456-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 500 observations (172 censored and 328 observed)</span></span>
<span id="cb456-20"><a href="endogenous-sample-selection.html#cb456-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 free parameters (df = 494)</span></span>
<span id="cb456-21"><a href="endogenous-sample-selection.html#cb456-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Probit selection equation:</span></span>
<span id="cb456-22"><a href="endogenous-sample-selection.html#cb456-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb456-23"><a href="endogenous-sample-selection.html#cb456-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)  -0.2228     0.1081  -2.061   0.0399 *  </span></span>
<span id="cb456-24"><a href="endogenous-sample-selection.html#cb456-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; xs            1.3377     0.2014   6.642 8.18e-11 ***</span></span>
<span id="cb456-25"><a href="endogenous-sample-selection.html#cb456-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Outcome equation:</span></span>
<span id="cb456-26"><a href="endogenous-sample-selection.html#cb456-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;               Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb456-27"><a href="endogenous-sample-selection.html#cb456-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept) -0.0002265  0.1294178  -0.002    0.999    </span></span>
<span id="cb456-28"><a href="endogenous-sample-selection.html#cb456-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; xo           0.7299070  0.1635925   4.462 1.01e-05 ***</span></span>
<span id="cb456-29"><a href="endogenous-sample-selection.html#cb456-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Error terms:</span></span>
<span id="cb456-30"><a href="endogenous-sample-selection.html#cb456-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb456-31"><a href="endogenous-sample-selection.html#cb456-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sigma   0.9190     0.0574  16.009  &lt; 2e-16 ***</span></span>
<span id="cb456-32"><a href="endogenous-sample-selection.html#cb456-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; rho    -0.5392     0.1521  -3.544 0.000431 ***</span></span>
<span id="cb456-33"><a href="endogenous-sample-selection.html#cb456-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb456-34"><a href="endogenous-sample-selection.html#cb456-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb456-35"><a href="endogenous-sample-selection.html#cb456-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------</span></span></code></pre></div>
<p>without the exclusion restriction, we generate yo using xs instead of xo.</p>
<div class="sourceCode" id="cb457"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb457-1"><a href="endogenous-sample-selection.html#cb457-1" aria-hidden="true" tabindex="-1"></a>yoX <span class="ot">&lt;-</span> xs <span class="sc">+</span> eps[,<span class="dv">2</span>]</span>
<span id="cb457-2"><a href="endogenous-sample-selection.html#cb457-2" aria-hidden="true" tabindex="-1"></a>yo <span class="ot">&lt;-</span> yoX<span class="sc">*</span>(ys <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb457-3"><a href="endogenous-sample-selection.html#cb457-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">selection</span>(ys <span class="sc">~</span> xs, yo <span class="sc">~</span> xs))</span>
<span id="cb457-4"><a href="endogenous-sample-selection.html#cb457-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------</span></span>
<span id="cb457-5"><a href="endogenous-sample-selection.html#cb457-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Tobit 2 model (sample selection model)</span></span>
<span id="cb457-6"><a href="endogenous-sample-selection.html#cb457-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Maximum Likelihood estimation</span></span>
<span id="cb457-7"><a href="endogenous-sample-selection.html#cb457-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Newton-Raphson maximisation, 14 iterations</span></span>
<span id="cb457-8"><a href="endogenous-sample-selection.html#cb457-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Return code 8: successive function values within relative tolerance limit (reltol)</span></span>
<span id="cb457-9"><a href="endogenous-sample-selection.html#cb457-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Log-Likelihood: -712.8298 </span></span>
<span id="cb457-10"><a href="endogenous-sample-selection.html#cb457-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 500 observations (172 censored and 328 observed)</span></span>
<span id="cb457-11"><a href="endogenous-sample-selection.html#cb457-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 free parameters (df = 494)</span></span>
<span id="cb457-12"><a href="endogenous-sample-selection.html#cb457-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Probit selection equation:</span></span>
<span id="cb457-13"><a href="endogenous-sample-selection.html#cb457-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb457-14"><a href="endogenous-sample-selection.html#cb457-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)  -0.1984     0.1114  -1.781   0.0756 .  </span></span>
<span id="cb457-15"><a href="endogenous-sample-selection.html#cb457-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; xs            1.2907     0.2085   6.191 1.25e-09 ***</span></span>
<span id="cb457-16"><a href="endogenous-sample-selection.html#cb457-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Outcome equation:</span></span>
<span id="cb457-17"><a href="endogenous-sample-selection.html#cb457-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)   </span></span>
<span id="cb457-18"><a href="endogenous-sample-selection.html#cb457-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)  -0.5499     0.5644  -0.974  0.33038   </span></span>
<span id="cb457-19"><a href="endogenous-sample-selection.html#cb457-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; xs            1.3987     0.4482   3.120  0.00191 **</span></span>
<span id="cb457-20"><a href="endogenous-sample-selection.html#cb457-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Error terms:</span></span>
<span id="cb457-21"><a href="endogenous-sample-selection.html#cb457-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb457-22"><a href="endogenous-sample-selection.html#cb457-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sigma  0.85091    0.05352  15.899   &lt;2e-16 ***</span></span>
<span id="cb457-23"><a href="endogenous-sample-selection.html#cb457-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; rho   -0.13226    0.72684  -0.182    0.856    </span></span>
<span id="cb457-24"><a href="endogenous-sample-selection.html#cb457-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb457-25"><a href="endogenous-sample-selection.html#cb457-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb457-26"><a href="endogenous-sample-selection.html#cb457-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------</span></span></code></pre></div>
<p>We can see that our estimates are still unbiased but standard errors are substantially larger. The exclusion restriction (i.e., independent information about the selection process) has a certain identifying power that we desire. Hence, it’s better to have different set of variable for the selection process from the interested equation. Without the exclusion restriction, we solely rely on the functional form identification.</p>
</div>
</div>
<div id="tobit-5" class="section level3" number="28.4.2">
<h3><span class="header-section-number">28.4.2</span> Tobit-5</h3>
<p>Also known as the switching regression model<br />
Condition: There is at least one variable in X in the selection process not included in the observed process. Used when there are separate models for participants, and non-participants.</p>
<div class="sourceCode" id="cb458"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb458-1"><a href="endogenous-sample-selection.html#cb458-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb458-2"><a href="endogenous-sample-selection.html#cb458-2" aria-hidden="true" tabindex="-1"></a>vc <span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="dv">3</span>)</span>
<span id="cb458-3"><a href="endogenous-sample-selection.html#cb458-3" aria-hidden="true" tabindex="-1"></a>vc[<span class="fu">lower.tri</span>(vc)] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.9</span>, <span class="fl">0.5</span>, <span class="fl">0.1</span>)</span>
<span id="cb458-4"><a href="endogenous-sample-selection.html#cb458-4" aria-hidden="true" tabindex="-1"></a>vc[<span class="fu">upper.tri</span>(vc)] <span class="ot">&lt;-</span> vc[<span class="fu">lower.tri</span>(vc)]</span>
<span id="cb458-5"><a href="endogenous-sample-selection.html#cb458-5" aria-hidden="true" tabindex="-1"></a>eps <span class="ot">&lt;-</span> <span class="fu">rmvnorm</span>(<span class="dv">500</span>, <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>), vc) <span class="co"># 3 disturbance vectors by a 3-dimensional normal distribution</span></span>
<span id="cb458-6"><a href="endogenous-sample-selection.html#cb458-6" aria-hidden="true" tabindex="-1"></a>xs <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">500</span>) <span class="co"># uniformly distributed on [0, 1]</span></span>
<span id="cb458-7"><a href="endogenous-sample-selection.html#cb458-7" aria-hidden="true" tabindex="-1"></a>ys <span class="ot">&lt;-</span> xs <span class="sc">+</span> eps[,<span class="dv">1</span>] <span class="sc">&gt;</span> <span class="dv">0</span></span>
<span id="cb458-8"><a href="endogenous-sample-selection.html#cb458-8" aria-hidden="true" tabindex="-1"></a>xo1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">500</span>) <span class="co"># uniformly distributed on [0, 1]</span></span>
<span id="cb458-9"><a href="endogenous-sample-selection.html#cb458-9" aria-hidden="true" tabindex="-1"></a>yo1 <span class="ot">&lt;-</span> xo1 <span class="sc">+</span> eps[,<span class="dv">2</span>]</span>
<span id="cb458-10"><a href="endogenous-sample-selection.html#cb458-10" aria-hidden="true" tabindex="-1"></a>xo2 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">500</span>) <span class="co"># uniformly distributed on [0, 1]</span></span>
<span id="cb458-11"><a href="endogenous-sample-selection.html#cb458-11" aria-hidden="true" tabindex="-1"></a>yo2 <span class="ot">&lt;-</span> xo2 <span class="sc">+</span> eps[,<span class="dv">3</span>]</span></code></pre></div>
<p>exclusion restriction is fulfilled when x’s are independent.</p>
<div class="sourceCode" id="cb459"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb459-1"><a href="endogenous-sample-selection.html#cb459-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">selection</span>(ys<span class="sc">~</span>xs, <span class="fu">list</span>(yo1 <span class="sc">~</span> xo1, yo2 <span class="sc">~</span> xo2))) <span class="co"># one selection equation and a list of two outcome equations</span></span>
<span id="cb459-2"><a href="endogenous-sample-selection.html#cb459-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------</span></span>
<span id="cb459-3"><a href="endogenous-sample-selection.html#cb459-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Tobit 5 model (switching regression model)</span></span>
<span id="cb459-4"><a href="endogenous-sample-selection.html#cb459-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Maximum Likelihood estimation</span></span>
<span id="cb459-5"><a href="endogenous-sample-selection.html#cb459-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Newton-Raphson maximisation, 11 iterations</span></span>
<span id="cb459-6"><a href="endogenous-sample-selection.html#cb459-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Return code 1: gradient close to zero (gradtol)</span></span>
<span id="cb459-7"><a href="endogenous-sample-selection.html#cb459-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Log-Likelihood: -895.8201 </span></span>
<span id="cb459-8"><a href="endogenous-sample-selection.html#cb459-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 500 observations: 172 selection 1 (FALSE) and 328 selection 2 (TRUE)</span></span>
<span id="cb459-9"><a href="endogenous-sample-selection.html#cb459-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10 free parameters (df = 490)</span></span>
<span id="cb459-10"><a href="endogenous-sample-selection.html#cb459-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Probit selection equation:</span></span>
<span id="cb459-11"><a href="endogenous-sample-selection.html#cb459-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb459-12"><a href="endogenous-sample-selection.html#cb459-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)  -0.1550     0.1051  -1.474    0.141    </span></span>
<span id="cb459-13"><a href="endogenous-sample-selection.html#cb459-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; xs            1.1408     0.1785   6.390 3.86e-10 ***</span></span>
<span id="cb459-14"><a href="endogenous-sample-selection.html#cb459-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Outcome equation 1:</span></span>
<span id="cb459-15"><a href="endogenous-sample-selection.html#cb459-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb459-16"><a href="endogenous-sample-selection.html#cb459-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)  0.02708    0.16395   0.165    0.869    </span></span>
<span id="cb459-17"><a href="endogenous-sample-selection.html#cb459-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; xo1          0.83959    0.14968   5.609  3.4e-08 ***</span></span>
<span id="cb459-18"><a href="endogenous-sample-selection.html#cb459-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Outcome equation 2:</span></span>
<span id="cb459-19"><a href="endogenous-sample-selection.html#cb459-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb459-20"><a href="endogenous-sample-selection.html#cb459-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)   0.1583     0.1885   0.840    0.401    </span></span>
<span id="cb459-21"><a href="endogenous-sample-selection.html#cb459-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; xo2           0.8375     0.1707   4.908 1.26e-06 ***</span></span>
<span id="cb459-22"><a href="endogenous-sample-selection.html#cb459-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Error terms:</span></span>
<span id="cb459-23"><a href="endogenous-sample-selection.html#cb459-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb459-24"><a href="endogenous-sample-selection.html#cb459-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sigma1  0.93191    0.09211  10.118   &lt;2e-16 ***</span></span>
<span id="cb459-25"><a href="endogenous-sample-selection.html#cb459-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sigma2  0.90697    0.04434  20.455   &lt;2e-16 ***</span></span>
<span id="cb459-26"><a href="endogenous-sample-selection.html#cb459-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; rho1    0.88988    0.05353  16.623   &lt;2e-16 ***</span></span>
<span id="cb459-27"><a href="endogenous-sample-selection.html#cb459-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; rho2    0.17695    0.33139   0.534    0.594    </span></span>
<span id="cb459-28"><a href="endogenous-sample-selection.html#cb459-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb459-29"><a href="endogenous-sample-selection.html#cb459-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb459-30"><a href="endogenous-sample-selection.html#cb459-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------</span></span></code></pre></div>
<p>All the estimates are close to the true values.</p>
<p>Example of functional form misspecification</p>
<div class="sourceCode" id="cb460"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb460-1"><a href="endogenous-sample-selection.html#cb460-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">5</span>)</span>
<span id="cb460-2"><a href="endogenous-sample-selection.html#cb460-2" aria-hidden="true" tabindex="-1"></a>eps <span class="ot">&lt;-</span> <span class="fu">rmvnorm</span>(<span class="dv">1000</span>, <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">3</span>), vc)</span>
<span id="cb460-3"><a href="endogenous-sample-selection.html#cb460-3" aria-hidden="true" tabindex="-1"></a>eps <span class="ot">&lt;-</span> eps<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> <span class="dv">1</span> <span class="co"># subtract 1 in order to get the mean zero disturbances</span></span>
<span id="cb460-4"><a href="endogenous-sample-selection.html#cb460-4" aria-hidden="true" tabindex="-1"></a>xs <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1000</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>) <span class="co"># interval [−1, 0] to get an asymmetric distribution over observed choices</span></span>
<span id="cb460-5"><a href="endogenous-sample-selection.html#cb460-5" aria-hidden="true" tabindex="-1"></a>ys <span class="ot">&lt;-</span> xs <span class="sc">+</span> eps[,<span class="dv">1</span>] <span class="sc">&gt;</span> <span class="dv">0</span></span>
<span id="cb460-6"><a href="endogenous-sample-selection.html#cb460-6" aria-hidden="true" tabindex="-1"></a>xo1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1000</span>)</span>
<span id="cb460-7"><a href="endogenous-sample-selection.html#cb460-7" aria-hidden="true" tabindex="-1"></a>yo1 <span class="ot">&lt;-</span> xo1 <span class="sc">+</span> eps[,<span class="dv">2</span>]</span>
<span id="cb460-8"><a href="endogenous-sample-selection.html#cb460-8" aria-hidden="true" tabindex="-1"></a>xo2 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1000</span>)</span>
<span id="cb460-9"><a href="endogenous-sample-selection.html#cb460-9" aria-hidden="true" tabindex="-1"></a>yo2 <span class="ot">&lt;-</span> xo2 <span class="sc">+</span> eps[,<span class="dv">3</span>]</span>
<span id="cb460-10"><a href="endogenous-sample-selection.html#cb460-10" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">selection</span>(ys<span class="sc">~</span>xs, <span class="fu">list</span>(yo1 <span class="sc">~</span> xo1, yo2 <span class="sc">~</span> xo2), <span class="at">iterlim=</span><span class="dv">20</span>))</span>
<span id="cb460-11"><a href="endogenous-sample-selection.html#cb460-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------</span></span>
<span id="cb460-12"><a href="endogenous-sample-selection.html#cb460-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Tobit 5 model (switching regression model)</span></span>
<span id="cb460-13"><a href="endogenous-sample-selection.html#cb460-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Maximum Likelihood estimation</span></span>
<span id="cb460-14"><a href="endogenous-sample-selection.html#cb460-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Newton-Raphson maximisation, 4 iterations</span></span>
<span id="cb460-15"><a href="endogenous-sample-selection.html#cb460-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Return code 3: Last step could not find a value above the current.</span></span>
<span id="cb460-16"><a href="endogenous-sample-selection.html#cb460-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Boundary of parameter space?  </span></span>
<span id="cb460-17"><a href="endogenous-sample-selection.html#cb460-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Consider switching to a more robust optimisation method temporarily.</span></span>
<span id="cb460-18"><a href="endogenous-sample-selection.html#cb460-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Log-Likelihood: -1665.936 </span></span>
<span id="cb460-19"><a href="endogenous-sample-selection.html#cb460-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1000 observations: 760 selection 1 (FALSE) and 240 selection 2 (TRUE)</span></span>
<span id="cb460-20"><a href="endogenous-sample-selection.html#cb460-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10 free parameters (df = 990)</span></span>
<span id="cb460-21"><a href="endogenous-sample-selection.html#cb460-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Probit selection equation:</span></span>
<span id="cb460-22"><a href="endogenous-sample-selection.html#cb460-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb460-23"><a href="endogenous-sample-selection.html#cb460-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept) -0.53698    0.05808  -9.245  &lt; 2e-16 ***</span></span>
<span id="cb460-24"><a href="endogenous-sample-selection.html#cb460-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; xs           0.31268    0.09395   3.328 0.000906 ***</span></span>
<span id="cb460-25"><a href="endogenous-sample-selection.html#cb460-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Outcome equation 1:</span></span>
<span id="cb460-26"><a href="endogenous-sample-selection.html#cb460-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb460-27"><a href="endogenous-sample-selection.html#cb460-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept) -0.70679    0.03573  -19.78   &lt;2e-16 ***</span></span>
<span id="cb460-28"><a href="endogenous-sample-selection.html#cb460-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; xo1          0.91603    0.05626   16.28   &lt;2e-16 ***</span></span>
<span id="cb460-29"><a href="endogenous-sample-selection.html#cb460-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Outcome equation 2:</span></span>
<span id="cb460-30"><a href="endogenous-sample-selection.html#cb460-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)  </span></span>
<span id="cb460-31"><a href="endogenous-sample-selection.html#cb460-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)   0.1446         NA      NA       NA  </span></span>
<span id="cb460-32"><a href="endogenous-sample-selection.html#cb460-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; xo2           1.1196     0.5014   2.233   0.0258 *</span></span>
<span id="cb460-33"><a href="endogenous-sample-selection.html#cb460-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Error terms:</span></span>
<span id="cb460-34"><a href="endogenous-sample-selection.html#cb460-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb460-35"><a href="endogenous-sample-selection.html#cb460-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sigma1  0.67770    0.01760   38.50   &lt;2e-16 ***</span></span>
<span id="cb460-36"><a href="endogenous-sample-selection.html#cb460-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sigma2  2.31432    0.07615   30.39   &lt;2e-16 ***</span></span>
<span id="cb460-37"><a href="endogenous-sample-selection.html#cb460-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; rho1   -0.97137         NA      NA       NA    </span></span>
<span id="cb460-38"><a href="endogenous-sample-selection.html#cb460-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; rho2    0.17039         NA      NA       NA    </span></span>
<span id="cb460-39"><a href="endogenous-sample-selection.html#cb460-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb460-40"><a href="endogenous-sample-selection.html#cb460-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb460-41"><a href="endogenous-sample-selection.html#cb460-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------</span></span></code></pre></div>
<p>Although we still have an exclusion restriction (xo1 and xo2 are independent), we now have problems with the intercepts (i.e., they are statistically significantly different from the true values zero), and convergence problems.</p>
<p>If we don’t have the exclusion restriction, we will have a larger variance of xs</p>
<div class="sourceCode" id="cb461"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb461-1"><a href="endogenous-sample-selection.html#cb461-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">6</span>)</span>
<span id="cb461-2"><a href="endogenous-sample-selection.html#cb461-2" aria-hidden="true" tabindex="-1"></a>xs <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1000</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb461-3"><a href="endogenous-sample-selection.html#cb461-3" aria-hidden="true" tabindex="-1"></a>ys <span class="ot">&lt;-</span> xs <span class="sc">+</span> eps[,<span class="dv">1</span>] <span class="sc">&gt;</span> <span class="dv">0</span></span>
<span id="cb461-4"><a href="endogenous-sample-selection.html#cb461-4" aria-hidden="true" tabindex="-1"></a>yo1 <span class="ot">&lt;-</span> xs <span class="sc">+</span> eps[,<span class="dv">2</span>]</span>
<span id="cb461-5"><a href="endogenous-sample-selection.html#cb461-5" aria-hidden="true" tabindex="-1"></a>yo2 <span class="ot">&lt;-</span> xs <span class="sc">+</span> eps[,<span class="dv">3</span>]</span>
<span id="cb461-6"><a href="endogenous-sample-selection.html#cb461-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(tmp <span class="ot">&lt;-</span> <span class="fu">selection</span>(ys<span class="sc">~</span>xs, <span class="fu">list</span>(yo1 <span class="sc">~</span> xs, yo2 <span class="sc">~</span> xs), <span class="at">iterlim=</span><span class="dv">20</span>))</span>
<span id="cb461-7"><a href="endogenous-sample-selection.html#cb461-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------</span></span>
<span id="cb461-8"><a href="endogenous-sample-selection.html#cb461-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Tobit 5 model (switching regression model)</span></span>
<span id="cb461-9"><a href="endogenous-sample-selection.html#cb461-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Maximum Likelihood estimation</span></span>
<span id="cb461-10"><a href="endogenous-sample-selection.html#cb461-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Newton-Raphson maximisation, 16 iterations</span></span>
<span id="cb461-11"><a href="endogenous-sample-selection.html#cb461-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Return code 8: successive function values within relative tolerance limit (reltol)</span></span>
<span id="cb461-12"><a href="endogenous-sample-selection.html#cb461-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Log-Likelihood: -1936.431 </span></span>
<span id="cb461-13"><a href="endogenous-sample-selection.html#cb461-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1000 observations: 626 selection 1 (FALSE) and 374 selection 2 (TRUE)</span></span>
<span id="cb461-14"><a href="endogenous-sample-selection.html#cb461-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10 free parameters (df = 990)</span></span>
<span id="cb461-15"><a href="endogenous-sample-selection.html#cb461-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Probit selection equation:</span></span>
<span id="cb461-16"><a href="endogenous-sample-selection.html#cb461-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb461-17"><a href="endogenous-sample-selection.html#cb461-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)  -0.3528     0.0424  -8.321 2.86e-16 ***</span></span>
<span id="cb461-18"><a href="endogenous-sample-selection.html#cb461-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; xs            0.8354     0.0756  11.050  &lt; 2e-16 ***</span></span>
<span id="cb461-19"><a href="endogenous-sample-selection.html#cb461-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Outcome equation 1:</span></span>
<span id="cb461-20"><a href="endogenous-sample-selection.html#cb461-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb461-21"><a href="endogenous-sample-selection.html#cb461-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept) -0.55448    0.06339  -8.748   &lt;2e-16 ***</span></span>
<span id="cb461-22"><a href="endogenous-sample-selection.html#cb461-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; xs           0.81764    0.06048  13.519   &lt;2e-16 ***</span></span>
<span id="cb461-23"><a href="endogenous-sample-selection.html#cb461-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Outcome equation 2:</span></span>
<span id="cb461-24"><a href="endogenous-sample-selection.html#cb461-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)</span></span>
<span id="cb461-25"><a href="endogenous-sample-selection.html#cb461-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)   0.6457     0.4994   1.293    0.196</span></span>
<span id="cb461-26"><a href="endogenous-sample-selection.html#cb461-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; xs            0.3520     0.3197   1.101    0.271</span></span>
<span id="cb461-27"><a href="endogenous-sample-selection.html#cb461-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Error terms:</span></span>
<span id="cb461-28"><a href="endogenous-sample-selection.html#cb461-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb461-29"><a href="endogenous-sample-selection.html#cb461-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sigma1  0.59187    0.01853  31.935   &lt;2e-16 ***</span></span>
<span id="cb461-30"><a href="endogenous-sample-selection.html#cb461-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sigma2  1.97257    0.07228  27.289   &lt;2e-16 ***</span></span>
<span id="cb461-31"><a href="endogenous-sample-selection.html#cb461-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; rho1    0.15568    0.15914   0.978    0.328    </span></span>
<span id="cb461-32"><a href="endogenous-sample-selection.html#cb461-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; rho2   -0.01541    0.23370  -0.066    0.947    </span></span>
<span id="cb461-33"><a href="endogenous-sample-selection.html#cb461-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb461-34"><a href="endogenous-sample-selection.html#cb461-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb461-35"><a href="endogenous-sample-selection.html#cb461-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------</span></span></code></pre></div>
<p>Usually it will not converge. Even if it does, the results may be seriously biased.</p>
<p><strong>Note</strong></p>
<p>The log-likelihood function of the models might not be globally concave. Hence, it might not converge, or converge to a local maximum. To combat this, we can use</p>
<ul>
<li>Different starting value</li>
<li>Different maximization methods.</li>
<li>refer to <a href="non-linear-least-squares.html#non-linear-least-squares">Non-linear Least Squares</a> for suggestions.</li>
</ul>
<div id="pattern-mixture-models" class="section level5" number="28.4.2.0.1">
<h5><span class="header-section-number">28.4.2.0.1</span> Pattern-Mixture Models</h5>
<ul>
<li>compared to the Heckman’s model where it assumes the value of the missing data is predetermined, pattern-mixture models assume missingness affect the distribution of variable of interest (e.g., Y)</li>
<li>To read more, you can check <a href="https://www4.stat.ncsu.edu/~davidian/st790/notes/chap6.pdf">NCSU</a>, <a href="https://stefvanbuuren.name/fimd/sec-nonignorable.html">stefvanbuuren</a>.</li>
</ul>

</div>
</div>
</div>
<!-- </div> -->
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Amemiya_1984" class="csl-entry">
Amemiya, Takeshi. 1984. <span>“Tobit Models: A Survey.”</span> <em>Journal of Econometrics</em> 24 (1-2): 3–61. <a href="https://doi.org/10.1016/0304-4076(84)90074-5">https://doi.org/10.1016/0304-4076(84)90074-5</a>.
</div>
<div id="ref-Bareinboim_2014" class="csl-entry">
Bareinboim, Elias, Jin Tian, and Judea Pearl. 2014. <span>“Proceedings of the Twenty-Eighth AAAI Conference on Artificial Intelligence.”</span>
</div>
<div id="ref-Heckman_1976" class="csl-entry">
Heckman, James J. 1976. <span>“The Common Structure of Statistical Models of Truncation, Sample Selection and Limited Dependent Variables and a Simple Estimator for Such Models.”</span> <em>Annals of Economic and Social Measurement</em> 5 (4): 475–92.
</div>
<div id="ref-Mroz_1987" class="csl-entry">
Mroz, Thomas A. 1987. <span>“The Sensitivity of an Empirical Model of Married Women<span></span>s Hours of Work to Economic and Statistical Assumptions.”</span> <em>Econometrica</em> 55 (4): 765. <a href="https://doi.org/10.2307/1911029">https://doi.org/10.2307/1911029</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="endogenous-treatment.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="mediation.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/mikenguyen13/data_analysis/edit/main/29-endogeneity.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/mikenguyen13/data_analysis/blob/main/29-endogeneity.Rmd",
"text": null
},
"download": ["data_analysis.pdf", "data_analysis.epub", "data_analysis.mobi"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true,
"sharing": {
"facebook": true,
"github": true,
"twitter": true,
"linkedin": true
},
"info": true,
"edit": "https://github.com/mikenguyen13/data_analysis/edit/main/%s"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
