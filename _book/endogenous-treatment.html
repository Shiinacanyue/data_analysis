<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>28.3 Endogenous Treatment | A Guide on Data Analysis</title>
  <meta name="description" content="This is a guide on how to conduct data analysis in the field of data science, statistics, or machine learning." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="28.3 Endogenous Treatment | A Guide on Data Analysis" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://bookdown.org/mike/data_analysis/" />
  <meta property="og:image" content="https://bookdown.org/mike/data_analysis//images/cover.jpg" />
  <meta property="og:description" content="This is a guide on how to conduct data analysis in the field of data science, statistics, or machine learning." />
  <meta name="github-repo" content="mikenguyen13/data_analysis" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="28.3 Endogenous Treatment | A Guide on Data Analysis" />
  
  <meta name="twitter:description" content="This is a guide on how to conduct data analysis in the field of data science, statistics, or machine learning." />
  <meta name="twitter:image" content="https://bookdown.org/mike/data_analysis//images/cover.jpg" />

<meta name="author" content="Mike Nguyen" />


<meta name="date" content="2022-09-24" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  <link rel="apple-touch-icon-precomposed" sizes="120x120" href="logo.png" />
  <link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<link rel="prev" href="simultaneity.html"/>
<link rel="next" href="endogenous-sample-selection.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="libs/proj4js-2.3.15/proj4.js"></script>
<link href="libs/highcharts-9.3.1/css/motion.css" rel="stylesheet" />
<script src="libs/highcharts-9.3.1/highcharts.js"></script>
<script src="libs/highcharts-9.3.1/highcharts-3d.js"></script>
<script src="libs/highcharts-9.3.1/highcharts-more.js"></script>
<script src="libs/highcharts-9.3.1/modules/stock.js"></script>
<script src="libs/highcharts-9.3.1/modules/map.js"></script>
<script src="libs/highcharts-9.3.1/modules/data.js"></script>
<script src="libs/highcharts-9.3.1/modules/exporting.js"></script>
<script src="libs/highcharts-9.3.1/modules/offline-exporting.js"></script>
<script src="libs/highcharts-9.3.1/modules/drilldown.js"></script>
<script src="libs/highcharts-9.3.1/modules/item-series.js"></script>
<script src="libs/highcharts-9.3.1/modules/overlapping-datalabels.js"></script>
<script src="libs/highcharts-9.3.1/modules/annotations.js"></script>
<script src="libs/highcharts-9.3.1/modules/export-data.js"></script>
<script src="libs/highcharts-9.3.1/modules/funnel.js"></script>
<script src="libs/highcharts-9.3.1/modules/heatmap.js"></script>
<script src="libs/highcharts-9.3.1/modules/treemap.js"></script>
<script src="libs/highcharts-9.3.1/modules/sankey.js"></script>
<script src="libs/highcharts-9.3.1/modules/dependency-wheel.js"></script>
<script src="libs/highcharts-9.3.1/modules/organization.js"></script>
<script src="libs/highcharts-9.3.1/modules/solid-gauge.js"></script>
<script src="libs/highcharts-9.3.1/modules/streamgraph.js"></script>
<script src="libs/highcharts-9.3.1/modules/sunburst.js"></script>
<script src="libs/highcharts-9.3.1/modules/vector.js"></script>
<script src="libs/highcharts-9.3.1/modules/wordcloud.js"></script>
<script src="libs/highcharts-9.3.1/modules/xrange.js"></script>
<script src="libs/highcharts-9.3.1/modules/tilemap.js"></script>
<script src="libs/highcharts-9.3.1/modules/venn.js"></script>
<script src="libs/highcharts-9.3.1/modules/gantt.js"></script>
<script src="libs/highcharts-9.3.1/modules/timeline.js"></script>
<script src="libs/highcharts-9.3.1/modules/parallel-coordinates.js"></script>
<script src="libs/highcharts-9.3.1/modules/bullet.js"></script>
<script src="libs/highcharts-9.3.1/modules/coloraxis.js"></script>
<script src="libs/highcharts-9.3.1/modules/dumbbell.js"></script>
<script src="libs/highcharts-9.3.1/modules/lollipop.js"></script>
<script src="libs/highcharts-9.3.1/modules/series-label.js"></script>
<script src="libs/highcharts-9.3.1/plugins/motion.js"></script>
<script src="libs/highcharts-9.3.1/custom/reset.js"></script>
<script src="libs/highcharts-9.3.1/modules/boost.js"></script>
<script src="libs/highchart-binding-0.9.4/highchart.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=GA_MEASUREMENT_ID"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){window.dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-DMNX2X65HQ');
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Guide on Data Analysis</a></li>

<li class="divider"></li>
<li><a href="index.html#preface" id="toc-preface">Preface</a></li>
<li><a href="introduction.html#introduction" id="toc-introduction"><span class="toc-section-number">1</span> Introduction</a></li>
<li><a href="prerequisites.html#prerequisites" id="toc-prerequisites"><span class="toc-section-number">2</span> Prerequisites</a>
<ul>
<li><a href="matrix-theory.html#matrix-theory" id="toc-matrix-theory"><span class="toc-section-number">2.1</span> Matrix Theory</a>
<ul>
<li><a href="matrix-theory.html#rank" id="toc-rank"><span class="toc-section-number">2.1.1</span> Rank</a></li>
<li><a href="matrix-theory.html#inverse" id="toc-inverse"><span class="toc-section-number">2.1.2</span> Inverse</a></li>
<li><a href="matrix-theory.html#definiteness" id="toc-definiteness"><span class="toc-section-number">2.1.3</span> Definiteness</a></li>
<li><a href="matrix-theory.html#matrix-calculus" id="toc-matrix-calculus"><span class="toc-section-number">2.1.4</span> Matrix Calculus</a></li>
<li><a href="matrix-theory.html#optimization" id="toc-optimization"><span class="toc-section-number">2.1.5</span> Optimization</a></li>
</ul></li>
<li><a href="probability-theory.html#probability-theory" id="toc-probability-theory"><span class="toc-section-number">2.2</span> Probability Theory</a>
<ul>
<li><a href="probability-theory.html#axiom-and-theorems-of-probability" id="toc-axiom-and-theorems-of-probability"><span class="toc-section-number">2.2.1</span> Axiom and Theorems of Probability</a></li>
<li><a href="probability-theory.html#central-limit-theorem" id="toc-central-limit-theorem"><span class="toc-section-number">2.2.2</span> Central Limit Theorem</a></li>
<li><a href="probability-theory.html#random-variable" id="toc-random-variable"><span class="toc-section-number">2.2.3</span> Random variable</a></li>
<li><a href="probability-theory.html#moment-generating-function" id="toc-moment-generating-function"><span class="toc-section-number">2.2.4</span> Moment generating function</a></li>
<li><a href="probability-theory.html#moment" id="toc-moment"><span class="toc-section-number">2.2.5</span> Moment</a></li>
<li><a href="probability-theory.html#distributions" id="toc-distributions"><span class="toc-section-number">2.2.6</span> Distributions</a></li>
</ul></li>
<li><a href="general-math.html#general-math" id="toc-general-math"><span class="toc-section-number">2.3</span> General Math</a>
<ul>
<li><a href="general-math.html#number-sets" id="toc-number-sets"><span class="toc-section-number">2.3.1</span> Number Sets</a></li>
<li><a href="general-math.html#summation-notation-and-series" id="toc-summation-notation-and-series"><span class="toc-section-number">2.3.2</span> Summation Notation and Series</a></li>
<li><a href="general-math.html#law-of-large-numbers" id="toc-law-of-large-numbers"><span class="toc-section-number">2.3.3</span> Law of large numbers</a></li>
<li><a href="general-math.html#law-of-iterated-expectation" id="toc-law-of-iterated-expectation"><span class="toc-section-number">2.3.4</span> Law of Iterated Expectation</a></li>
<li><a href="general-math.html#convergence" id="toc-convergence"><span class="toc-section-number">2.3.5</span> Convergence</a></li>
<li><a href="general-math.html#sufficient-statistics" id="toc-sufficient-statistics"><span class="toc-section-number">2.3.6</span> Sufficient Statistics</a></li>
<li><a href="general-math.html#parameter-transformations" id="toc-parameter-transformations"><span class="toc-section-number">2.3.7</span> Parameter transformations</a></li>
</ul></li>
<li><a href="data-importexport.html#data-importexport" id="toc-data-importexport"><span class="toc-section-number">2.4</span> Data Import/Export</a>
<ul>
<li><a href="data-importexport.html#medium-size" id="toc-medium-size"><span class="toc-section-number">2.4.1</span> Medium size</a></li>
<li><a href="data-importexport.html#large-size" id="toc-large-size"><span class="toc-section-number">2.4.2</span> Large size</a></li>
</ul></li>
<li><a href="data-manipulation.html#data-manipulation" id="toc-data-manipulation"><span class="toc-section-number">2.5</span> Data Manipulation</a></li>
</ul></li>
<li><a href="#part-i.-basic" id="toc-part-i.-basic">(PART*) I. BASIC</a></li>
<li><a href="descriptive-stat.html#descriptive-stat" id="toc-descriptive-stat"><span class="toc-section-number">3</span> Descriptive Statistics</a>
<ul>
<li><a href="numerical-measures.html#numerical-measures" id="toc-numerical-measures"><span class="toc-section-number">3.1</span> Numerical Measures</a></li>
<li><a href="graphical-measures.html#graphical-measures" id="toc-graphical-measures"><span class="toc-section-number">3.2</span> Graphical Measures</a>
<ul>
<li><a href="graphical-measures.html#shape" id="toc-shape"><span class="toc-section-number">3.2.1</span> Shape</a></li>
<li><a href="graphical-measures.html#scatterplot" id="toc-scatterplot"><span class="toc-section-number">3.2.2</span> Scatterplot</a></li>
</ul></li>
<li><a href="normality-assessment.html#normality-assessment" id="toc-normality-assessment"><span class="toc-section-number">3.3</span> Normality Assessment</a>
<ul>
<li><a href="normality-assessment.html#graphical-assessment" id="toc-graphical-assessment"><span class="toc-section-number">3.3.1</span> Graphical Assessment</a></li>
<li><a href="normality-assessment.html#summary-statistics" id="toc-summary-statistics"><span class="toc-section-number">3.3.2</span> Summary Statistics</a></li>
</ul></li>
<li><a href="bivariate-statistics.html#bivariate-statistics" id="toc-bivariate-statistics"><span class="toc-section-number">3.4</span> Bivariate Statistics</a></li>
<li><a href="two-continuous.html#two-continuous" id="toc-two-continuous"><span class="toc-section-number">3.5</span> Two Continuous</a>
<ul>
<li><a href="two-continuous.html#pearson-correlation" id="toc-pearson-correlation"><span class="toc-section-number">3.5.1</span> Pearson Correlation</a></li>
<li><a href="two-continuous.html#spearman-correlation" id="toc-spearman-correlation"><span class="toc-section-number">3.5.2</span> Spearman Correlation</a></li>
</ul></li>
<li><a href="categorical-and-continuous.html#categorical-and-continuous" id="toc-categorical-and-continuous"><span class="toc-section-number">3.6</span> Categorical and Continuous</a>
<ul>
<li><a href="categorical-and-continuous.html#point-biserial-correlation" id="toc-point-biserial-correlation"><span class="toc-section-number">3.6.1</span> Point-Biserial Correlation</a></li>
<li><a href="categorical-and-continuous.html#logistic-regression" id="toc-logistic-regression"><span class="toc-section-number">3.6.2</span> Logistic Regression</a></li>
</ul></li>
<li><a href="two-discrete.html#two-discrete" id="toc-two-discrete"><span class="toc-section-number">3.7</span> Two Discrete</a>
<ul>
<li><a href="two-discrete.html#distance-metrics" id="toc-distance-metrics"><span class="toc-section-number">3.7.1</span> Distance Metrics</a></li>
<li><a href="two-discrete.html#statistical-metrics" id="toc-statistical-metrics"><span class="toc-section-number">3.7.2</span> Statistical Metrics</a></li>
<li><a href="two-discrete.html#ordinal-association-rank-correlation" id="toc-ordinal-association-rank-correlation"><span class="toc-section-number">3.7.3</span> Ordinal Association (Rank correlation)</a></li>
<li><a href="two-discrete.html#summary-1" id="toc-summary-1"><span class="toc-section-number">3.7.4</span> Summary</a></li>
<li><a href="two-discrete.html#visualization" id="toc-visualization"><span class="toc-section-number">3.7.5</span> Visualization</a></li>
</ul></li>
</ul></li>
<li><a href="basic-statistical-inference.html#basic-statistical-inference" id="toc-basic-statistical-inference"><span class="toc-section-number">4</span> Basic Statistical Inference</a>
<ul>
<li><a href="one-sample-inference.html#one-sample-inference" id="toc-one-sample-inference"><span class="toc-section-number">4.1</span> One Sample Inference</a>
<ul>
<li><a href="one-sample-inference.html#the-mean" id="toc-the-mean"><span class="toc-section-number">4.1.1</span> The Mean</a></li>
<li><a href="one-sample-inference.html#single-variance" id="toc-single-variance"><span class="toc-section-number">4.1.2</span> Single Variance</a></li>
<li><a href="one-sample-inference.html#single-proportion-p" id="toc-single-proportion-p"><span class="toc-section-number">4.1.3</span> Single Proportion (p)</a></li>
<li><a href="one-sample-inference.html#power" id="toc-power"><span class="toc-section-number">4.1.4</span> Power</a></li>
<li><a href="one-sample-inference.html#sample-size" id="toc-sample-size"><span class="toc-section-number">4.1.5</span> Sample Size</a></li>
<li><a href="one-sample-inference.html#note" id="toc-note"><span class="toc-section-number">4.1.6</span> Note</a></li>
<li><a href="one-sample-inference.html#one-sample-non-parametric-methods" id="toc-one-sample-non-parametric-methods"><span class="toc-section-number">4.1.7</span> One-sample Non-parametric Methods</a></li>
</ul></li>
<li><a href="two-sample-inference.html#two-sample-inference" id="toc-two-sample-inference"><span class="toc-section-number">4.2</span> Two Sample Inference</a>
<ul>
<li><a href="two-sample-inference.html#means" id="toc-means"><span class="toc-section-number">4.2.1</span> Means</a></li>
<li><a href="two-sample-inference.html#variances" id="toc-variances"><span class="toc-section-number">4.2.2</span> Variances</a></li>
<li><a href="two-sample-inference.html#power-1" id="toc-power-1"><span class="toc-section-number">4.2.3</span> Power</a></li>
<li><a href="two-sample-inference.html#sample-size-1" id="toc-sample-size-1"><span class="toc-section-number">4.2.4</span> Sample Size</a></li>
<li><a href="two-sample-inference.html#matched-pair-designs" id="toc-matched-pair-designs"><span class="toc-section-number">4.2.5</span> Matched Pair Designs</a></li>
<li><a href="two-sample-inference.html#nonparametric-tests-for-two-samples" id="toc-nonparametric-tests-for-two-samples"><span class="toc-section-number">4.2.6</span> Nonparametric Tests for Two Samples</a></li>
</ul></li>
<li><a href="categorical-data-analysis.html#categorical-data-analysis" id="toc-categorical-data-analysis"><span class="toc-section-number">4.3</span> Categorical Data Analysis</a>
<ul>
<li><a href="categorical-data-analysis.html#inferences-for-small-samples" id="toc-inferences-for-small-samples"><span class="toc-section-number">4.3.1</span> Inferences for Small Samples</a></li>
<li><a href="categorical-data-analysis.html#test-of-association" id="toc-test-of-association"><span class="toc-section-number">4.3.2</span> Test of Association</a></li>
<li><a href="categorical-data-analysis.html#ordinal-association" id="toc-ordinal-association"><span class="toc-section-number">4.3.3</span> Ordinal Association</a></li>
</ul></li>
<li><a href="divergence-metrics-and-test-for-comparing-distributions.html#divergence-metrics-and-test-for-comparing-distributions" id="toc-divergence-metrics-and-test-for-comparing-distributions"><span class="toc-section-number">4.4</span> Divergence Metrics and Test for Comparing Distributions</a>
<ul>
<li><a href="divergence-metrics-and-test-for-comparing-distributions.html#kullback-leibler-divergence" id="toc-kullback-leibler-divergence"><span class="toc-section-number">4.4.1</span> Kullback-Leibler Divergence</a></li>
<li><a href="divergence-metrics-and-test-for-comparing-distributions.html#jensen-shannon-divergence" id="toc-jensen-shannon-divergence"><span class="toc-section-number">4.4.2</span> Jensen-Shannon Divergence</a></li>
<li><a href="divergence-metrics-and-test-for-comparing-distributions.html#wasserstein-distance" id="toc-wasserstein-distance"><span class="toc-section-number">4.4.3</span> Wasserstein Distance</a></li>
<li><a href="divergence-metrics-and-test-for-comparing-distributions.html#kolmogorov-smirnov-test-1" id="toc-kolmogorov-smirnov-test-1"><span class="toc-section-number">4.4.4</span> Kolmogorov-Smirnov Test</a></li>
</ul></li>
</ul></li>
<li><a href="#part-ii.-regression" id="toc-part-ii.-regression">(PART*) II. REGRESSION</a></li>
<li><a href="linear-regression.html#linear-regression" id="toc-linear-regression"><span class="toc-section-number">5</span> Linear Regression</a>
<ul>
<li><a href="ordinary-least-squares.html#ordinary-least-squares" id="toc-ordinary-least-squares"><span class="toc-section-number">5.1</span> Ordinary Least Squares</a>
<ul>
<li><a href="ordinary-least-squares.html#simple-regression-basic-model" id="toc-simple-regression-basic-model"><span class="toc-section-number">5.1.1</span> Simple Regression (Basic Model)</a></li>
<li><a href="ordinary-least-squares.html#multiple-linear-regression" id="toc-multiple-linear-regression"><span class="toc-section-number">5.1.2</span> Multiple Linear Regression</a></li>
<li><a href="ordinary-least-squares.html#ols-assumptions" id="toc-ols-assumptions"><span class="toc-section-number">5.1.3</span> OLS Assumptions</a></li>
<li><a href="ordinary-least-squares.html#theorems" id="toc-theorems"><span class="toc-section-number">5.1.4</span> Theorems</a></li>
<li><a href="ordinary-least-squares.html#variable-selection" id="toc-variable-selection"><span class="toc-section-number">5.1.5</span> Variable Selection</a></li>
<li><a href="ordinary-least-squares.html#diagnostics-1" id="toc-diagnostics-1"><span class="toc-section-number">5.1.6</span> Diagnostics</a></li>
<li><a href="ordinary-least-squares.html#model-validation" id="toc-model-validation"><span class="toc-section-number">5.1.7</span> Model Validation</a></li>
<li><a href="ordinary-least-squares.html#finite-sample-properties" id="toc-finite-sample-properties"><span class="toc-section-number">5.1.8</span> Finite Sample Properties</a></li>
<li><a href="ordinary-least-squares.html#large-sample-properties" id="toc-large-sample-properties"><span class="toc-section-number">5.1.9</span> Large Sample Properties</a></li>
</ul></li>
<li><a href="feasible-generalized-least-squares.html#feasible-generalized-least-squares" id="toc-feasible-generalized-least-squares"><span class="toc-section-number">5.2</span> Feasible Generalized Least Squares</a>
<ul>
<li><a href="feasible-generalized-least-squares.html#heteroskedasticity" id="toc-heteroskedasticity"><span class="toc-section-number">5.2.1</span> Heteroskedasticity</a></li>
<li><a href="feasible-generalized-least-squares.html#serial-correlation" id="toc-serial-correlation"><span class="toc-section-number">5.2.2</span> Serial Correlation</a></li>
</ul></li>
<li><a href="weighted-least-squares.html#weighted-least-squares" id="toc-weighted-least-squares"><span class="toc-section-number">5.3</span> Weighted Least Squares</a></li>
<li><a href="generalized-least-squares.html#generalized-least-squares" id="toc-generalized-least-squares"><span class="toc-section-number">5.4</span> Generalized Least Squares</a></li>
<li><a href="feasiable-prais-winsten.html#feasiable-prais-winsten" id="toc-feasiable-prais-winsten"><span class="toc-section-number">5.5</span> Feasiable Prais Winsten</a></li>
<li><a href="feasible-group-level-random-effects.html#feasible-group-level-random-effects" id="toc-feasible-group-level-random-effects"><span class="toc-section-number">5.6</span> Feasible group level Random Effects</a></li>
<li><a href="ridge-regression.html#ridge-regression" id="toc-ridge-regression"><span class="toc-section-number">5.7</span> Ridge Regression</a></li>
<li><a href="principal-component-regression.html#principal-component-regression" id="toc-principal-component-regression"><span class="toc-section-number">5.8</span> Principal Component Regression</a></li>
<li><a href="robust-regression.html#robust-regression" id="toc-robust-regression"><span class="toc-section-number">5.9</span> Robust Regression</a>
<ul>
<li><a href="robust-regression.html#least-absolute-residuals-lar-regression" id="toc-least-absolute-residuals-lar-regression"><span class="toc-section-number">5.9.1</span> Least Absolute Residuals (LAR) Regression</a></li>
<li><a href="robust-regression.html#least-median-of-squares-lms-regression" id="toc-least-median-of-squares-lms-regression"><span class="toc-section-number">5.9.2</span> Least Median of Squares (LMS) Regression</a></li>
<li><a href="robust-regression.html#iteratively-reweighted-least-squares-irls-robust-regression" id="toc-iteratively-reweighted-least-squares-irls-robust-regression"><span class="toc-section-number">5.9.3</span> Iteratively Reweighted Least Squares (IRLS) Robust Regression</a></li>
</ul></li>
<li><a href="maximum-likelihood-regression.html#maximum-likelihood-regression" id="toc-maximum-likelihood-regression"><span class="toc-section-number">5.10</span> Maximum Likelihood</a>
<ul>
<li><a href="maximum-likelihood-regression.html#motivation-for-mle" id="toc-motivation-for-mle"><span class="toc-section-number">5.10.1</span> Motivation for MLE</a></li>
<li><a href="maximum-likelihood-regression.html#assumption" id="toc-assumption"><span class="toc-section-number">5.10.2</span> Assumption</a></li>
<li><a href="maximum-likelihood-regression.html#properties" id="toc-properties"><span class="toc-section-number">5.10.3</span> Properties</a></li>
<li><a href="maximum-likelihood-regression.html#compare-to-ols" id="toc-compare-to-ols"><span class="toc-section-number">5.10.4</span> Compare to OLS</a></li>
<li><a href="maximum-likelihood-regression.html#application" id="toc-application"><span class="toc-section-number">5.10.5</span> Application</a></li>
</ul></li>
</ul></li>
<li><a href="non-linear-regression.html#non-linear-regression" id="toc-non-linear-regression"><span class="toc-section-number">6</span> Non-linear Regression</a>
<ul>
<li><a href="inference-1.html#inference-1" id="toc-inference-1"><span class="toc-section-number">6.1</span> Inference</a>
<ul>
<li><a href="inference-1.html#linear-function-of-the-parameters" id="toc-linear-function-of-the-parameters"><span class="toc-section-number">6.1.1</span> Linear Function of the Parameters</a></li>
<li><a href="inference-1.html#nonlinear" id="toc-nonlinear"><span class="toc-section-number">6.1.2</span> Nonlinear</a></li>
</ul></li>
<li><a href="non-linear-least-squares.html#non-linear-least-squares" id="toc-non-linear-least-squares"><span class="toc-section-number">6.2</span> Non-linear Least Squares</a>
<ul>
<li><a href="non-linear-least-squares.html#alternative-of-gauss-newton-algorithm" id="toc-alternative-of-gauss-newton-algorithm"><span class="toc-section-number">6.2.1</span> Alternative of Gauss-Newton Algorithm</a></li>
<li><a href="non-linear-least-squares.html#practical-considerations" id="toc-practical-considerations"><span class="toc-section-number">6.2.2</span> Practical Considerations</a></li>
<li><a href="non-linear-least-squares.html#modelestiamtion-adequcy" id="toc-modelestiamtion-adequcy"><span class="toc-section-number">6.2.3</span> Model/Estiamtion Adequcy</a></li>
<li><a href="non-linear-least-squares.html#application-1" id="toc-application-1"><span class="toc-section-number">6.2.4</span> Application</a></li>
</ul></li>
</ul></li>
<li><a href="generalized-linear-models.html#generalized-linear-models" id="toc-generalized-linear-models"><span class="toc-section-number">7</span> Generalized Linear Models</a>
<ul>
<li><a href="logistic-regression-1.html#logistic-regression-1" id="toc-logistic-regression-1"><span class="toc-section-number">7.1</span> Logistic Regression</a>
<ul>
<li><a href="logistic-regression-1.html#application-2" id="toc-application-2"><span class="toc-section-number">7.1.1</span> Application</a></li>
</ul></li>
<li><a href="probit-regression.html#probit-regression" id="toc-probit-regression"><span class="toc-section-number">7.2</span> Probit Regression</a></li>
<li><a href="binomial-regression.html#binomial-regression" id="toc-binomial-regression"><span class="toc-section-number">7.3</span> Binomial Regression</a></li>
<li><a href="poisson-regression.html#poisson-regression" id="toc-poisson-regression"><span class="toc-section-number">7.4</span> Poisson Regression</a>
<ul>
<li><a href="poisson-regression.html#application-3" id="toc-application-3"><span class="toc-section-number">7.4.1</span> Application</a></li>
</ul></li>
<li><a href="negative-binomial-regression.html#negative-binomial-regression" id="toc-negative-binomial-regression"><span class="toc-section-number">7.5</span> Negative Binomial Regression</a></li>
<li><a href="multinomial.html#multinomial" id="toc-multinomial"><span class="toc-section-number">7.6</span> Multinomial</a></li>
<li><a href="generalization.html#generalization" id="toc-generalization"><span class="toc-section-number">7.7</span> Generalization</a>
<ul>
<li><a href="generalization.html#estimation-1" id="toc-estimation-1"><span class="toc-section-number">7.7.1</span> Estimation</a></li>
<li><a href="generalization.html#inference-2" id="toc-inference-2"><span class="toc-section-number">7.7.2</span> Inference</a></li>
<li><a href="generalization.html#deviance" id="toc-deviance"><span class="toc-section-number">7.7.3</span> Deviance</a></li>
<li><a href="generalization.html#diagnostic-plots" id="toc-diagnostic-plots"><span class="toc-section-number">7.7.4</span> Diagnostic Plots</a></li>
<li><a href="generalization.html#goodness-of-fit" id="toc-goodness-of-fit"><span class="toc-section-number">7.7.5</span> Goodness of Fit</a></li>
<li><a href="generalization.html#over-dispersion" id="toc-over-dispersion"><span class="toc-section-number">7.7.6</span> Over-Dispersion</a></li>
</ul></li>
</ul></li>
<li><a href="linear-mixed-models.html#linear-mixed-models" id="toc-linear-mixed-models"><span class="toc-section-number">8</span> Linear Mixed Models</a>
<ul>
<li><a href="dependent-data.html#dependent-data" id="toc-dependent-data"><span class="toc-section-number">8.1</span> Dependent Data</a>
<ul>
<li><a href="dependent-data.html#random-intercepts-model" id="toc-random-intercepts-model"><span class="toc-section-number">8.1.1</span> Random-Intercepts Model</a></li>
<li><a href="dependent-data.html#covariance-models" id="toc-covariance-models"><span class="toc-section-number">8.1.2</span> Covariance Models</a></li>
</ul></li>
<li><a href="estimation-2.html#estimation-2" id="toc-estimation-2"><span class="toc-section-number">8.2</span> Estimation</a>
<ul>
<li><a href="estimation-2.html#estimating-mathbfv" id="toc-estimating-mathbfv"><span class="toc-section-number">8.2.1</span> Estimating <span class="math inline">\(\mathbf{V}\)</span></a></li>
</ul></li>
<li><a href="inference-3.html#inference-3" id="toc-inference-3"><span class="toc-section-number">8.3</span> Inference</a>
<ul>
<li><a href="inference-3.html#parameters-beta" id="toc-parameters-beta"><span class="toc-section-number">8.3.1</span> Parameters <span class="math inline">\(\beta\)</span></a></li>
<li><a href="inference-3.html#variance-components" id="toc-variance-components"><span class="toc-section-number">8.3.2</span> Variance Components</a></li>
</ul></li>
<li><a href="information-criteria.html#information-criteria" id="toc-information-criteria"><span class="toc-section-number">8.4</span> Information Criteria</a>
<ul>
<li><a href="information-criteria.html#akaikes-information-criteria-aic" id="toc-akaikes-information-criteria-aic"><span class="toc-section-number">8.4.1</span> Akaike’s Information Criteria (AIC)</a></li>
<li><a href="information-criteria.html#corrected-aic-aicc" id="toc-corrected-aic-aicc"><span class="toc-section-number">8.4.2</span> Corrected AIC (AICC)</a></li>
<li><a href="information-criteria.html#bayesian-information-criteria-bic" id="toc-bayesian-information-criteria-bic"><span class="toc-section-number">8.4.3</span> Bayesian Information Criteria (BIC)</a></li>
</ul></li>
<li><a href="split-plot-designs.html#split-plot-designs" id="toc-split-plot-designs"><span class="toc-section-number">8.5</span> Split-Plot Designs</a>
<ul>
<li><a href="split-plot-designs.html#application-4" id="toc-application-4"><span class="toc-section-number">8.5.1</span> Application</a></li>
</ul></li>
<li><a href="repeated-measures-in-mixed-models.html#repeated-measures-in-mixed-models" id="toc-repeated-measures-in-mixed-models"><span class="toc-section-number">8.6</span> Repeated Measures in Mixed Models</a></li>
<li><a href="unbalanced-or-unequally-spaced-data.html#unbalanced-or-unequally-spaced-data" id="toc-unbalanced-or-unequally-spaced-data"><span class="toc-section-number">8.7</span> Unbalanced or Unequally Spaced Data</a></li>
<li><a href="application-5.html#application-5" id="toc-application-5"><span class="toc-section-number">8.8</span> Application</a>
<ul>
<li><a href="application-5.html#example-1-pulps" id="toc-example-1-pulps"><span class="toc-section-number">8.8.1</span> Example 1 (Pulps)</a></li>
<li><a href="application-5.html#example-2-rats" id="toc-example-2-rats"><span class="toc-section-number">8.8.2</span> Example 2 (Rats)</a></li>
<li><a href="application-5.html#example-3-agridat" id="toc-example-3-agridat"><span class="toc-section-number">8.8.3</span> Example 3 (Agridat)</a></li>
</ul></li>
</ul></li>
<li><a href="nonlinear-and-generalized-linear-mixed-models.html#nonlinear-and-generalized-linear-mixed-models" id="toc-nonlinear-and-generalized-linear-mixed-models"><span class="toc-section-number">9</span> Nonlinear and Generalized Linear Mixed Models</a>
<ul>
<li><a href="estimation-3.html#estimation-3" id="toc-estimation-3"><span class="toc-section-number">9.1</span> Estimation</a>
<ul>
<li><a href="estimation-3.html#estimation-by-numerical-integration" id="toc-estimation-by-numerical-integration"><span class="toc-section-number">9.1.1</span> Estimation by Numerical Integration</a></li>
<li><a href="estimation-3.html#estimation-by-linearization" id="toc-estimation-by-linearization"><span class="toc-section-number">9.1.2</span> Estimation by Linearization</a></li>
<li><a href="estimation-3.html#estimation-by-bayesian-hierarchical-models" id="toc-estimation-by-bayesian-hierarchical-models"><span class="toc-section-number">9.1.3</span> Estimation by Bayesian Hierarchical Models</a></li>
</ul></li>
<li><a href="application-6.html#application-6" id="toc-application-6"><span class="toc-section-number">9.2</span> Application</a>
<ul>
<li><a href="application-6.html#binomial-cbpp-data" id="toc-binomial-cbpp-data"><span class="toc-section-number">9.2.1</span> Binomial (CBPP Data)</a></li>
<li><a href="application-6.html#count-owl-data" id="toc-count-owl-data"><span class="toc-section-number">9.2.2</span> Count (Owl Data)</a></li>
<li><a href="application-6.html#binomial-1" id="toc-binomial-1"><span class="toc-section-number">9.2.3</span> Binomial</a></li>
<li><a href="application-6.html#example-from-schabenberger_2001-section-8.4.1" id="toc-example-from-schabenberger_2001-section-8.4.1"><span class="toc-section-number">9.2.4</span> Example from <span class="citation">(<span>Schabenberger and Pierce 2001</span>)</span> section 8.4.1</a></li>
</ul></li>
<li><a href="summary-2.html#summary-2" id="toc-summary-2"><span class="toc-section-number">9.3</span> Summary</a></li>
</ul></li>
<li><a href="#part-iii.-ramifications" id="toc-part-iii.-ramifications">(PART*) III. RAMIFICATIONS</a></li>
<li><a href="model-specification.html#model-specification" id="toc-model-specification"><span class="toc-section-number">10</span> Model Specification</a>
<ul>
<li><a href="nested-model.html#nested-model" id="toc-nested-model"><span class="toc-section-number">10.1</span> Nested Model</a>
<ul>
<li><a href="nested-model.html#chow-test" id="toc-chow-test"><span class="toc-section-number">10.1.1</span> Chow test</a></li>
</ul></li>
<li><a href="non-nested-model.html#non-nested-model" id="toc-non-nested-model"><span class="toc-section-number">10.2</span> Non-Nested Model</a>
<ul>
<li><a href="non-nested-model.html#davidson-mackinnon-test" id="toc-davidson-mackinnon-test"><span class="toc-section-number">10.2.1</span> Davidson-Mackinnon test</a></li>
</ul></li>
<li><a href="heteroskedasticity-1.html#heteroskedasticity-1" id="toc-heteroskedasticity-1"><span class="toc-section-number">10.3</span> Heteroskedasticity</a>
<ul>
<li><a href="heteroskedasticity-1.html#breusch-pagan-test" id="toc-breusch-pagan-test"><span class="toc-section-number">10.3.1</span> Breusch-Pagan test</a></li>
<li><a href="heteroskedasticity-1.html#white-test" id="toc-white-test"><span class="toc-section-number">10.3.2</span> White test</a></li>
</ul></li>
</ul></li>
<li><a href="imputation-missing-data.html#imputation-missing-data" id="toc-imputation-missing-data"><span class="toc-section-number">11</span> Imputation (Missing Data)</a>
<ul>
<li><a href="assumptions-1.html#assumptions-1" id="toc-assumptions-1"><span class="toc-section-number">11.1</span> Assumptions</a>
<ul>
<li><a href="assumptions-1.html#missing-completely-at-random-mcar" id="toc-missing-completely-at-random-mcar"><span class="toc-section-number">11.1.1</span> Missing Completely at Random (MCAR)</a></li>
<li><a href="assumptions-1.html#missing-at-random-mar" id="toc-missing-at-random-mar"><span class="toc-section-number">11.1.2</span> Missing at Random (MAR)</a></li>
<li><a href="assumptions-1.html#ignorable" id="toc-ignorable"><span class="toc-section-number">11.1.3</span> Ignorable</a></li>
<li><a href="assumptions-1.html#nonignorable" id="toc-nonignorable"><span class="toc-section-number">11.1.4</span> Nonignorable</a></li>
</ul></li>
<li><a href="solutions-to-missing-data.html#solutions-to-missing-data" id="toc-solutions-to-missing-data"><span class="toc-section-number">11.2</span> Solutions to Missing data</a>
<ul>
<li><a href="solutions-to-missing-data.html#listwise-deletion" id="toc-listwise-deletion"><span class="toc-section-number">11.2.1</span> Listwise Deletion</a></li>
<li><a href="solutions-to-missing-data.html#pairwise-deletion" id="toc-pairwise-deletion"><span class="toc-section-number">11.2.2</span> Pairwise Deletion</a></li>
<li><a href="solutions-to-missing-data.html#dummy-variable-adjustment" id="toc-dummy-variable-adjustment"><span class="toc-section-number">11.2.3</span> Dummy Variable Adjustment</a></li>
<li><a href="solutions-to-missing-data.html#imputation" id="toc-imputation"><span class="toc-section-number">11.2.4</span> Imputation</a></li>
<li><a href="solutions-to-missing-data.html#other-methods" id="toc-other-methods"><span class="toc-section-number">11.2.5</span> Other methods</a></li>
</ul></li>
<li><a href="criteria-for-choosing-an-effective-approach.html#criteria-for-choosing-an-effective-approach" id="toc-criteria-for-choosing-an-effective-approach"><span class="toc-section-number">11.3</span> Criteria for Choosing an Effective Approach</a></li>
<li><a href="another-perspective.html#another-perspective" id="toc-another-perspective"><span class="toc-section-number">11.4</span> Another Perspective</a></li>
<li><a href="diagnosing-the-mechanism.html#diagnosing-the-mechanism" id="toc-diagnosing-the-mechanism"><span class="toc-section-number">11.5</span> Diagnosing the Mechanism</a>
<ul>
<li><a href="diagnosing-the-mechanism.html#mar-vs.-mnar" id="toc-mar-vs.-mnar"><span class="toc-section-number">11.5.1</span> MAR vs. MNAR</a></li>
<li><a href="diagnosing-the-mechanism.html#mcar-vs.-mar" id="toc-mcar-vs.-mar"><span class="toc-section-number">11.5.2</span> MCAR vs. MAR</a></li>
</ul></li>
<li><a href="application-7.html#application-7" id="toc-application-7"><span class="toc-section-number">11.6</span> Application</a>
<ul>
<li><a href="application-7.html#imputation-with-mean-median-mode" id="toc-imputation-with-mean-median-mode"><span class="toc-section-number">11.6.1</span> Imputation with mean / median / mode</a></li>
<li><a href="application-7.html#knn" id="toc-knn"><span class="toc-section-number">11.6.2</span> KNN</a></li>
<li><a href="application-7.html#rpart" id="toc-rpart"><span class="toc-section-number">11.6.3</span> rpart</a></li>
<li><a href="application-7.html#mice-multivariate-imputation-via-chained-equations" id="toc-mice-multivariate-imputation-via-chained-equations"><span class="toc-section-number">11.6.4</span> MICE (Multivariate Imputation via Chained Equations)</a></li>
<li><a href="application-7.html#amelia" id="toc-amelia"><span class="toc-section-number">11.6.5</span> Amelia</a></li>
<li><a href="application-7.html#missforest" id="toc-missforest"><span class="toc-section-number">11.6.6</span> missForest</a></li>
<li><a href="application-7.html#hmisc" id="toc-hmisc"><span class="toc-section-number">11.6.7</span> Hmisc</a></li>
<li><a href="application-7.html#mi" id="toc-mi"><span class="toc-section-number">11.6.8</span> mi</a></li>
</ul></li>
</ul></li>
<li><a href="data.html#data" id="toc-data"><span class="toc-section-number">12</span> Data</a>
<ul>
<li><a href="cross-sectional.html#cross-sectional" id="toc-cross-sectional"><span class="toc-section-number">12.1</span> Cross-Sectional</a></li>
<li><a href="time-series-1.html#time-series-1" id="toc-time-series-1"><span class="toc-section-number">12.2</span> Time Series</a>
<ul>
<li><a href="time-series-1.html#deterministic-time-trend" id="toc-deterministic-time-trend"><span class="toc-section-number">12.2.1</span> Deterministic Time trend</a></li>
<li><a href="time-series-1.html#feedback-effect" id="toc-feedback-effect"><span class="toc-section-number">12.2.2</span> Feedback Effect</a></li>
<li><a href="time-series-1.html#dynamic-specification" id="toc-dynamic-specification"><span class="toc-section-number">12.2.3</span> Dynamic Specification</a></li>
<li><a href="time-series-1.html#dynamically-complete" id="toc-dynamically-complete"><span class="toc-section-number">12.2.4</span> Dynamically Complete</a></li>
<li><a href="time-series-1.html#highly-persistent-data" id="toc-highly-persistent-data"><span class="toc-section-number">12.2.5</span> Highly Persistent Data</a></li>
</ul></li>
<li><a href="repeated-cross-sections.html#repeated-cross-sections" id="toc-repeated-cross-sections"><span class="toc-section-number">12.3</span> Repeated Cross Sections</a>
<ul>
<li><a href="repeated-cross-sections.html#pooled-cross-section" id="toc-pooled-cross-section"><span class="toc-section-number">12.3.1</span> Pooled Cross Section</a></li>
</ul></li>
<li><a href="panel-data.html#panel-data" id="toc-panel-data"><span class="toc-section-number">12.4</span> Panel Data</a>
<ul>
<li><a href="panel-data.html#pooled-ols-estimator" id="toc-pooled-ols-estimator"><span class="toc-section-number">12.4.1</span> Pooled OLS Estimator</a></li>
<li><a href="panel-data.html#individual-specific-effects-model" id="toc-individual-specific-effects-model"><span class="toc-section-number">12.4.2</span> Individual-specific effects model</a></li>
<li><a href="panel-data.html#tests-for-assumptions" id="toc-tests-for-assumptions"><span class="toc-section-number">12.4.3</span> Tests for Assumptions</a></li>
<li><a href="panel-data.html#model-selection" id="toc-model-selection"><span class="toc-section-number">12.4.4</span> Model Selection</a></li>
<li><a href="panel-data.html#summary-3" id="toc-summary-3"><span class="toc-section-number">12.4.5</span> Summary</a></li>
<li><a href="panel-data.html#application-8" id="toc-application-8"><span class="toc-section-number">12.4.6</span> Application</a></li>
<li><a href="panel-data.html#other-estimators" id="toc-other-estimators"><span class="toc-section-number">12.4.7</span> Other Estimators</a></li>
</ul></li>
</ul></li>
<li><a href="hypothesis-testing.html#hypothesis-testing" id="toc-hypothesis-testing"><span class="toc-section-number">13</span> Hypothesis Testing</a>
<ul>
<li><a href="types-of-hypothesis-testing.html#types-of-hypothesis-testing" id="toc-types-of-hypothesis-testing"><span class="toc-section-number">13.1</span> Types of hypothesis testing</a></li>
<li><a href="wald-test.html#wald-test" id="toc-wald-test"><span class="toc-section-number">13.2</span> Wald test</a>
<ul>
<li><a href="wald-test.html#multiple-hypothesis" id="toc-multiple-hypothesis"><span class="toc-section-number">13.2.1</span> Multiple Hypothesis</a></li>
<li><a href="wald-test.html#linear-combination" id="toc-linear-combination"><span class="toc-section-number">13.2.2</span> Linear Combination</a></li>
<li><a href="wald-test.html#estimate-difference-in-coefficients" id="toc-estimate-difference-in-coefficients"><span class="toc-section-number">13.2.3</span> Estimate Difference in Coefficients</a></li>
<li><a href="wald-test.html#application-9" id="toc-application-9"><span class="toc-section-number">13.2.4</span> Application</a></li>
<li><a href="wald-test.html#nonlinear-1" id="toc-nonlinear-1"><span class="toc-section-number">13.2.5</span> Nonlinear</a></li>
</ul></li>
<li><a href="the-likelihood-ratio-test.html#the-likelihood-ratio-test" id="toc-the-likelihood-ratio-test"><span class="toc-section-number">13.3</span> The likelihood ratio test</a></li>
<li><a href="lagrange-multiplier-score.html#lagrange-multiplier-score" id="toc-lagrange-multiplier-score"><span class="toc-section-number">13.4</span> Lagrange Multiplier (Score)</a></li>
</ul></li>
<li><a href="prediction-and-estimation.html#prediction-and-estimation" id="toc-prediction-and-estimation"><span class="toc-section-number">14</span> Prediction and Estimation</a></li>
<li><a href="moderation.html#moderation" id="toc-moderation"><span class="toc-section-number">15</span> Moderation</a>
<ul>
<li><a href="emmeans-package.html#emmeans-package" id="toc-emmeans-package"><span class="toc-section-number">15.1</span> emmeans package</a>
<ul>
<li><a href="emmeans-package.html#continuous-by-continuous" id="toc-continuous-by-continuous"><span class="toc-section-number">15.1.1</span> Continuous by continuous</a></li>
<li><a href="emmeans-package.html#continuous-by-categorical" id="toc-continuous-by-categorical"><span class="toc-section-number">15.1.2</span> Continuous by categorical</a></li>
<li><a href="emmeans-package.html#categorical-by-categorical" id="toc-categorical-by-categorical"><span class="toc-section-number">15.1.3</span> Categorical by categorical</a></li>
</ul></li>
<li><a href="probmod-package.html#probmod-package" id="toc-probmod-package"><span class="toc-section-number">15.2</span> probmod package</a></li>
<li><a href="interactions-package.html#interactions-package" id="toc-interactions-package"><span class="toc-section-number">15.3</span> interactions package</a>
<ul>
<li><a href="interactions-package.html#continuous-interaction" id="toc-continuous-interaction"><span class="toc-section-number">15.3.1</span> Continuous interaction</a></li>
<li><a href="interactions-package.html#categorical-interaction" id="toc-categorical-interaction"><span class="toc-section-number">15.3.2</span> Categorical interaction</a></li>
</ul></li>
<li><a href="interactionr-package.html#interactionr-package" id="toc-interactionr-package"><span class="toc-section-number">15.4</span> interactionR package</a></li>
<li><a href="sjplot-package.html#sjplot-package" id="toc-sjplot-package"><span class="toc-section-number">15.5</span> sjPlot package</a></li>
</ul></li>
<li><a href="#part-iv.-causal-inference" id="toc-part-iv.-causal-inference">(PART*) IV. CAUSAL INFERENCE</a></li>
<li><a href="causal-inference.html#causal-inference" id="toc-causal-inference"><span class="toc-section-number">16</span> Causal Inference</a>
<ul>
<li><a href="treatment-effect-types.html#treatment-effect-types" id="toc-treatment-effect-types"><span class="toc-section-number">16.1</span> Treatment effect types</a>
<ul>
<li><a href="treatment-effect-types.html#average-treatment-effects" id="toc-average-treatment-effects"><span class="toc-section-number">16.1.1</span> Average Treatment Effects</a></li>
<li><a href="treatment-effect-types.html#conditional-average-treatment-effects" id="toc-conditional-average-treatment-effects"><span class="toc-section-number">16.1.2</span> Conditional Average Treatment Effects</a></li>
<li><a href="treatment-effect-types.html#intent-to-treat-effects" id="toc-intent-to-treat-effects"><span class="toc-section-number">16.1.3</span> Intent-to-treat Effects</a></li>
<li><a href="treatment-effect-types.html#local-average-treatment-effects" id="toc-local-average-treatment-effects"><span class="toc-section-number">16.1.4</span> Local Average Treatment Effects</a></li>
<li><a href="treatment-effect-types.html#population-vs.-sample-average-treatment-effects" id="toc-population-vs.-sample-average-treatment-effects"><span class="toc-section-number">16.1.5</span> Population vs. Sample Average Treatment Effects</a></li>
<li><a href="treatment-effect-types.html#average-treatment-effects-on-the-treated-and-control" id="toc-average-treatment-effects-on-the-treated-and-control"><span class="toc-section-number">16.1.6</span> Average Treatment Effects on the Treated and Control</a></li>
<li><a href="treatment-effect-types.html#quantile-average-treatment-effects" id="toc-quantile-average-treatment-effects"><span class="toc-section-number">16.1.7</span> Quantile Average Treatment Effects</a></li>
<li><a href="treatment-effect-types.html#mediation-effects" id="toc-mediation-effects"><span class="toc-section-number">16.1.8</span> Mediation Effects</a></li>
<li><a href="treatment-effect-types.html#log-odds-treatment-effects" id="toc-log-odds-treatment-effects"><span class="toc-section-number">16.1.9</span> Log-odds Treatment Effects</a></li>
</ul></li>
</ul></li>
<li><a href="#part-a.-experimental-design" id="toc-part-a.-experimental-design">(PART*) A. EXPERIMENTAL DESIGN</a></li>
<li><a href="experimental-design.html#experimental-design" id="toc-experimental-design"><span class="toc-section-number">17</span> Experimental Design</a>
<ul>
<li><a href="semi-random-experiment.html#semi-random-experiment" id="toc-semi-random-experiment"><span class="toc-section-number">17.1</span> Semi-random Experiment</a></li>
<li><a href="rerandomization.html#rerandomization" id="toc-rerandomization"><span class="toc-section-number">17.2</span> Rerandomization</a></li>
</ul></li>
<li><a href="sampling.html#sampling" id="toc-sampling"><span class="toc-section-number">18</span> Sampling</a>
<ul>
<li><a href="simple-sampling.html#simple-sampling" id="toc-simple-sampling"><span class="toc-section-number">18.1</span> Simple Sampling</a></li>
<li><a href="stratified-sampling.html#stratified-sampling" id="toc-stratified-sampling"><span class="toc-section-number">18.2</span> Stratified Sampling</a></li>
<li><a href="unequal-probability-sampling.html#unequal-probability-sampling" id="toc-unequal-probability-sampling"><span class="toc-section-number">18.3</span> Unequal Probability Sampling</a></li>
<li><a href="balanced-sampling.html#balanced-sampling" id="toc-balanced-sampling"><span class="toc-section-number">18.4</span> Balanced Sampling</a>
<ul>
<li><a href="balanced-sampling.html#cube" id="toc-cube"><span class="toc-section-number">18.4.1</span> Cube</a></li>
<li><a href="balanced-sampling.html#stratification" id="toc-stratification"><span class="toc-section-number">18.4.2</span> Stratification</a></li>
<li><a href="balanced-sampling.html#cluster-1" id="toc-cluster-1"><span class="toc-section-number">18.4.3</span> Cluster</a></li>
<li><a href="balanced-sampling.html#two-stage" id="toc-two-stage"><span class="toc-section-number">18.4.4</span> Two-stage</a></li>
</ul></li>
</ul></li>
<li><a href="analysis-of-variance-anova.html#analysis-of-variance-anova" id="toc-analysis-of-variance-anova"><span class="toc-section-number">19</span> Analysis of Variance (ANOVA)</a>
<ul>
<li><a href="completely-randomized-design-crd.html#completely-randomized-design-crd" id="toc-completely-randomized-design-crd"><span class="toc-section-number">19.1</span> Completely Randomized Design (CRD)</a>
<ul>
<li><a href="completely-randomized-design-crd.html#single-factor-fixed-effects-model" id="toc-single-factor-fixed-effects-model"><span class="toc-section-number">19.1.1</span> Single Factor Fixed Effects Model</a></li>
<li><a href="completely-randomized-design-crd.html#single-factor-random-effects-model" id="toc-single-factor-random-effects-model"><span class="toc-section-number">19.1.2</span> Single Factor Random Effects Model</a></li>
<li><a href="completely-randomized-design-crd.html#two-factor-fixed-effect-anova" id="toc-two-factor-fixed-effect-anova"><span class="toc-section-number">19.1.3</span> Two Factor Fixed Effect ANOVA</a></li>
<li><a href="completely-randomized-design-crd.html#two-way-random-effects-anova" id="toc-two-way-random-effects-anova"><span class="toc-section-number">19.1.4</span> Two-Way Random Effects ANOVA</a></li>
<li><a href="completely-randomized-design-crd.html#two-way-mixed-effects-anova" id="toc-two-way-mixed-effects-anova"><span class="toc-section-number">19.1.5</span> Two-Way Mixed Effects ANOVA</a></li>
</ul></li>
<li><a href="nonparametric-anova.html#nonparametric-anova" id="toc-nonparametric-anova"><span class="toc-section-number">19.2</span> Nonparametric ANOVA</a>
<ul>
<li><a href="nonparametric-anova.html#kruskal-wallis" id="toc-kruskal-wallis"><span class="toc-section-number">19.2.1</span> Kruskal-Wallis</a></li>
<li><a href="nonparametric-anova.html#friedman-test" id="toc-friedman-test"><span class="toc-section-number">19.2.2</span> Friedman Test</a></li>
</ul></li>
<li><a href="sample-size-planning-for-anova.html#sample-size-planning-for-anova" id="toc-sample-size-planning-for-anova"><span class="toc-section-number">19.3</span> Sample Size Planning for ANOVA</a>
<ul>
<li><a href="sample-size-planning-for-anova.html#balanced-designs" id="toc-balanced-designs"><span class="toc-section-number">19.3.1</span> Balanced Designs</a></li>
<li><a href="sample-size-planning-for-anova.html#randomized-block-experiments" id="toc-randomized-block-experiments"><span class="toc-section-number">19.3.2</span> Randomized Block Experiments</a></li>
</ul></li>
<li><a href="randomized-block-designs.html#randomized-block-designs" id="toc-randomized-block-designs"><span class="toc-section-number">19.4</span> Randomized Block Designs</a>
<ul>
<li><a href="randomized-block-designs.html#tukey-test-of-additivity" id="toc-tukey-test-of-additivity"><span class="toc-section-number">19.4.1</span> Tukey Test of Additivity</a></li>
</ul></li>
<li><a href="nested-designs.html#nested-designs" id="toc-nested-designs"><span class="toc-section-number">19.5</span> Nested Designs</a>
<ul>
<li><a href="nested-designs.html#two-factor-nested-designs" id="toc-two-factor-nested-designs"><span class="toc-section-number">19.5.1</span> Two-Factor Nested Designs</a></li>
</ul></li>
<li><a href="single-factor-covariance-model.html#single-factor-covariance-model" id="toc-single-factor-covariance-model"><span class="toc-section-number">19.6</span> Single Factor Covariance Model</a></li>
</ul></li>
<li><a href="multivariate-methods.html#multivariate-methods" id="toc-multivariate-methods"><span class="toc-section-number">20</span> Multivariate Methods</a>
<ul>
<li><a href="multivariate-methods.html#properties-of-mvn" id="toc-properties-of-mvn"><span class="toc-section-number">20.0.1</span> Properties of MVN</a></li>
<li><a href="multivariate-methods.html#mean-vector-inference" id="toc-mean-vector-inference"><span class="toc-section-number">20.0.2</span> Mean Vector Inference</a></li>
<li><a href="multivariate-methods.html#general-hypothesis-testing" id="toc-general-hypothesis-testing"><span class="toc-section-number">20.0.3</span> General Hypothesis Testing</a></li>
<li><a href="manova.html#manova" id="toc-manova"><span class="toc-section-number">20.1</span> MANOVA</a>
<ul>
<li><a href="manova.html#testing-general-hypotheses" id="toc-testing-general-hypotheses"><span class="toc-section-number">20.1.1</span> Testing General Hypotheses</a></li>
<li><a href="manova.html#profile-analysis" id="toc-profile-analysis"><span class="toc-section-number">20.1.2</span> Profile Analysis</a></li>
<li><a href="manova.html#summary-5" id="toc-summary-5"><span class="toc-section-number">20.1.3</span> Summary</a></li>
</ul></li>
<li><a href="principal-components.html#principal-components" id="toc-principal-components"><span class="toc-section-number">20.2</span> Principal Components</a>
<ul>
<li><a href="principal-components.html#population-principal-components" id="toc-population-principal-components"><span class="toc-section-number">20.2.1</span> Population Principal Components</a></li>
<li><a href="principal-components.html#sample-principal-components" id="toc-sample-principal-components"><span class="toc-section-number">20.2.2</span> Sample Principal Components</a></li>
<li><a href="principal-components.html#application-10" id="toc-application-10"><span class="toc-section-number">20.2.3</span> Application</a></li>
</ul></li>
<li><a href="factor-analysis.html#factor-analysis" id="toc-factor-analysis"><span class="toc-section-number">20.3</span> Factor Analysis</a>
<ul>
<li><a href="factor-analysis.html#methods-of-estimation" id="toc-methods-of-estimation"><span class="toc-section-number">20.3.1</span> Methods of Estimation</a></li>
<li><a href="factor-analysis.html#factor-rotation" id="toc-factor-rotation"><span class="toc-section-number">20.3.2</span> Factor Rotation</a></li>
<li><a href="factor-analysis.html#estimation-of-factor-scores" id="toc-estimation-of-factor-scores"><span class="toc-section-number">20.3.3</span> Estimation of Factor Scores</a></li>
<li><a href="factor-analysis.html#model-diagnostic" id="toc-model-diagnostic"><span class="toc-section-number">20.3.4</span> Model Diagnostic</a></li>
<li><a href="factor-analysis.html#application-11" id="toc-application-11"><span class="toc-section-number">20.3.5</span> Application</a></li>
</ul></li>
<li><a href="discriminant-analysis.html#discriminant-analysis" id="toc-discriminant-analysis"><span class="toc-section-number">20.4</span> Discriminant Analysis</a>
<ul>
<li><a href="discriminant-analysis.html#known-populations" id="toc-known-populations"><span class="toc-section-number">20.4.1</span> Known Populations</a></li>
<li><a href="discriminant-analysis.html#probabilities-of-misclassification" id="toc-probabilities-of-misclassification"><span class="toc-section-number">20.4.2</span> Probabilities of Misclassification</a></li>
<li><a href="discriminant-analysis.html#unknown-populations-nonparametric-discrimination" id="toc-unknown-populations-nonparametric-discrimination"><span class="toc-section-number">20.4.3</span> Unknown Populations/ Nonparametric Discrimination</a></li>
<li><a href="discriminant-analysis.html#application-12" id="toc-application-12"><span class="toc-section-number">20.4.4</span> Application</a></li>
</ul></li>
</ul></li>
<li><a href="#part-b.-quasi-experimental-design" id="toc-part-b.-quasi-experimental-design">(PART*) B. QUASI-EXPERIMENTAL DESIGN</a></li>
<li><a href="quasi-experimental.html#quasi-experimental" id="toc-quasi-experimental"><span class="toc-section-number">21</span> Quasi-experimental</a></li>
<li><a href="regression-discontinuity.html#regression-discontinuity" id="toc-regression-discontinuity"><span class="toc-section-number">22</span> Regression Discontinuity</a>
<ul>
<li><a href="specification-checks.html#specification-checks" id="toc-specification-checks"><span class="toc-section-number">22.1</span> Specification Checks</a>
<ul>
<li><a href="specification-checks.html#balance-checks" id="toc-balance-checks"><span class="toc-section-number">22.1.1</span> Balance Checks</a></li>
<li><a href="specification-checks.html#sortingbunchingmanipulation" id="toc-sortingbunchingmanipulation"><span class="toc-section-number">22.1.2</span> Sorting/Bunching/Manipulation</a></li>
<li><a href="specification-checks.html#placebo-tests" id="toc-placebo-tests"><span class="toc-section-number">22.1.3</span> Placebo Tests</a></li>
<li><a href="specification-checks.html#sensitivity-to-bandwidth-choice" id="toc-sensitivity-to-bandwidth-choice"><span class="toc-section-number">22.1.4</span> Sensitivity to Bandwidth Choice</a></li>
<li><a href="specification-checks.html#fuzzy-rd-design" id="toc-fuzzy-rd-design"><span class="toc-section-number">22.1.5</span> Fuzzy RD Design</a></li>
<li><a href="specification-checks.html#regression-kink-design" id="toc-regression-kink-design"><span class="toc-section-number">22.1.6</span> Regression Kink Design</a></li>
<li><a href="specification-checks.html#mutli-cutoff-multi-score-geographic-rd" id="toc-mutli-cutoff-multi-score-geographic-rd"><span class="toc-section-number">22.1.7</span> Mutli-cutoff, Multi-score, geographic RD</a></li>
</ul></li>
<li><a href="steps-for-sharp-rd.html#steps-for-sharp-rd" id="toc-steps-for-sharp-rd"><span class="toc-section-number">22.2</span> Steps for Sharp RD</a></li>
<li><a href="steps-for-fuzzy-rd.html#steps-for-fuzzy-rd" id="toc-steps-for-fuzzy-rd"><span class="toc-section-number">22.3</span> Steps for Fuzzy RD</a></li>
<li><a href="steps-for-rdit-regression-discontinuity-in-time.html#steps-for-rdit-regression-discontinuity-in-time" id="toc-steps-for-rdit-regression-discontinuity-in-time"><span class="toc-section-number">22.4</span> Steps for RDiT (Regression Discontinuity in Time)</a></li>
<li><a href="evaluation-of-an-rd.html#evaluation-of-an-rd" id="toc-evaluation-of-an-rd"><span class="toc-section-number">22.5</span> Evaluation of an RD</a></li>
<li><a href="applications.html#applications" id="toc-applications"><span class="toc-section-number">22.6</span> Applications</a>
<ul>
<li><a href="applications.html#example-1-1" id="toc-example-1-1"><span class="toc-section-number">22.6.1</span> Example 1</a></li>
<li><a href="applications.html#example-2" id="toc-example-2"><span class="toc-section-number">22.6.2</span> Example 2</a></li>
<li><a href="applications.html#example-3" id="toc-example-3"><span class="toc-section-number">22.6.3</span> Example 3</a></li>
<li><a href="applications.html#example-4" id="toc-example-4"><span class="toc-section-number">22.6.4</span> Example 4</a></li>
</ul></li>
</ul></li>
<li><a href="difference-in-differences.html#difference-in-differences" id="toc-difference-in-differences"><span class="toc-section-number">23</span> Difference-in-differences</a>
<ul>
<li><a href="simple-dif-n-dif.html#simple-dif-n-dif" id="toc-simple-dif-n-dif"><span class="toc-section-number">23.1</span> Simple Dif-n-dif</a>
<ul>
<li><a href="simple-dif-n-dif.html#assumptions-2" id="toc-assumptions-2"><span class="toc-section-number">23.1.1</span> Assumptions</a></li>
<li><a href="simple-dif-n-dif.html#examples" id="toc-examples"><span class="toc-section-number">23.1.2</span> Examples</a></li>
</ul></li>
<li><a href="multiple-periods-and-variation-in-treatment-timing.html#multiple-periods-and-variation-in-treatment-timing" id="toc-multiple-periods-and-variation-in-treatment-timing"><span class="toc-section-number">23.2</span> Multiple periods and variation in treatment timing</a></li>
<li><a href="staggered-dif-n-dif.html#staggered-dif-n-dif" id="toc-staggered-dif-n-dif"><span class="toc-section-number">23.3</span> Staggered Dif-n-dif</a>
<ul>
<li><a href="staggered-dif-n-dif.html#example-by-doleac2020" id="toc-example-by-doleac2020"><span class="toc-section-number">23.3.1</span> Example by <span class="citation">Doleac and Hansen (<span>2020</span>)</span></a></li>
</ul></li>
<li><a href="two-way-fixed-effects.html#two-way-fixed-effects" id="toc-two-way-fixed-effects"><span class="toc-section-number">23.4</span> Two-way Fixed-effects</a></li>
</ul></li>
<li><a href="synthetic-control.html#synthetic-control" id="toc-synthetic-control"><span class="toc-section-number">24</span> Synthetic Control</a>
<ul>
<li><a href="synthetic-control.html#example-1-2" id="toc-example-1-2"><span class="toc-section-number">24.0.1</span> Example 1</a></li>
<li><a href="synthetic-control.html#example-2-1" id="toc-example-2-1"><span class="toc-section-number">24.0.2</span> Example 2</a></li>
<li><a href="synthetic-control.html#example-3-1" id="toc-example-3-1"><span class="toc-section-number">24.0.3</span> Example 3</a></li>
<li><a href="synthetic-control.html#example-4-1" id="toc-example-4-1"><span class="toc-section-number">24.0.4</span> Example 4</a></li>
<li><a href="synthetic-difference-in-differences.html#synthetic-difference-in-differences" id="toc-synthetic-difference-in-differences"><span class="toc-section-number">24.1</span> Synthetic Difference-in-differences</a></li>
</ul></li>
<li><a href="event-studies.html#event-studies" id="toc-event-studies"><span class="toc-section-number">25</span> Event Studies</a>
<ul>
<li><a href="other-issues.html#other-issues" id="toc-other-issues"><span class="toc-section-number">25.1</span> Other Issues</a>
<ul>
<li><a href="other-issues.html#economic-significance" id="toc-economic-significance"><span class="toc-section-number">25.1.1</span> Economic significance</a></li>
<li><a href="other-issues.html#statistical-power" id="toc-statistical-power"><span class="toc-section-number">25.1.2</span> Statistical Power</a></li>
<li><a href="other-issues.html#testing" id="toc-testing"><span class="toc-section-number">25.1.3</span> Testing</a></li>
<li><a href="other-issues.html#confounders" id="toc-confounders"><span class="toc-section-number">25.1.4</span> Confounders</a></li>
<li><a href="other-issues.html#biases" id="toc-biases"><span class="toc-section-number">25.1.5</span> Biases</a></li>
<li><a href="other-issues.html#long-run-event-studies" id="toc-long-run-event-studies"><span class="toc-section-number">25.1.6</span> Long-run event studies</a></li>
</ul></li>
<li><a href="aggregation.html#aggregation" id="toc-aggregation"><span class="toc-section-number">25.2</span> Aggregation</a>
<ul>
<li><a href="aggregation.html#over-time" id="toc-over-time"><span class="toc-section-number">25.2.1</span> Over Time</a></li>
<li><a href="aggregation.html#across-firms-over-time" id="toc-across-firms-over-time"><span class="toc-section-number">25.2.2</span> Across Firms + Over Time</a></li>
</ul></li>
<li><a href="heterogeneity-in-the-event-effect.html#heterogeneity-in-the-event-effect" id="toc-heterogeneity-in-the-event-effect"><span class="toc-section-number">25.3</span> Heterogeneity in the event effect</a></li>
<li><a href="expected-return-calculation.html#expected-return-calculation" id="toc-expected-return-calculation"><span class="toc-section-number">25.4</span> Expected Return Calculation</a>
<ul>
<li><a href="expected-return-calculation.html#statistical-models" id="toc-statistical-models"><span class="toc-section-number">25.4.1</span> Statistical Models</a></li>
<li><a href="expected-return-calculation.html#economic-model" id="toc-economic-model"><span class="toc-section-number">25.4.2</span> Economic Model</a></li>
</ul></li>
<li><a href="application-13.html#application-13" id="toc-application-13"><span class="toc-section-number">25.5</span> Application</a></li>
</ul></li>
<li><a href="matching-methods.html#matching-methods" id="toc-matching-methods"><span class="toc-section-number">26</span> Matching Methods</a>
<ul>
<li><a href="matchit.html#matchit" id="toc-matchit"><span class="toc-section-number">26.1</span> MatchIt</a></li>
<li><a href="matchingfrontier.html#matchingfrontier" id="toc-matchingfrontier"><span class="toc-section-number">26.2</span> MatchingFrontier</a></li>
<li><a href="propensity-scores.html#propensity-scores" id="toc-propensity-scores"><span class="toc-section-number">26.3</span> Propensity Scores</a></li>
<li><a href="mahalanobis-distance.html#mahalanobis-distance" id="toc-mahalanobis-distance"><span class="toc-section-number">26.4</span> Mahalanobis Distance</a></li>
<li><a href="coarsened-exact-matching.html#coarsened-exact-matching" id="toc-coarsened-exact-matching"><span class="toc-section-number">26.5</span> Coarsened Exact Matching</a></li>
<li><a href="genetic-matching.html#genetic-matching" id="toc-genetic-matching"><span class="toc-section-number">26.6</span> Genetic Matching</a></li>
<li><a href="matching-for-time-series-cross-section-data.html#matching-for-time-series-cross-section-data" id="toc-matching-for-time-series-cross-section-data"><span class="toc-section-number">26.7</span> Matching for time series-cross-section data</a></li>
</ul></li>
<li><a href="interrupted-time-series.html#interrupted-time-series" id="toc-interrupted-time-series"><span class="toc-section-number">27</span> Interrupted Time Series</a>
<ul>
<li><a href="autocorrelation.html#autocorrelation" id="toc-autocorrelation"><span class="toc-section-number">27.1</span> Autocorrelation</a></li>
<li><a href="multiple-groups.html#multiple-groups" id="toc-multiple-groups"><span class="toc-section-number">27.2</span> Multiple Groups</a></li>
</ul></li>
<li><a href="#part-c.-other-concerns" id="toc-part-c.-other-concerns">(PART*) C. OTHER CONCERNS</a></li>
<li><a href="endogeneity.html#endogeneity" id="toc-endogeneity"><span class="toc-section-number">28</span> Endogeneity</a>
<ul>
<li><a href="measurement-error.html#measurement-error" id="toc-measurement-error"><span class="toc-section-number">28.1</span> Measurement Error</a>
<ul>
<li><a href="measurement-error.html#classical-measurement-errors" id="toc-classical-measurement-errors"><span class="toc-section-number">28.1.1</span> Classical Measurement Errors</a></li>
<li><a href="measurement-error.html#non-classical-measurement-errors" id="toc-non-classical-measurement-errors"><span class="toc-section-number">28.1.2</span> Non-classical Measurement Errors</a></li>
<li><a href="measurement-error.html#solution-to-measurement-errors" id="toc-solution-to-measurement-errors"><span class="toc-section-number">28.1.3</span> Solution to Measurement Errors</a></li>
</ul></li>
<li><a href="simultaneity.html#simultaneity" id="toc-simultaneity"><span class="toc-section-number">28.2</span> Simultaneity</a></li>
<li><a href="endogenous-treatment.html#endogenous-treatment" id="toc-endogenous-treatment"><span class="toc-section-number">28.3</span> Endogenous Treatment</a>
<ul>
<li><a href="endogenous-treatment.html#instrumental-variable" id="toc-instrumental-variable"><span class="toc-section-number">28.3.1</span> Instrumental Variable</a></li>
<li><a href="endogenous-treatment.html#internal-instrumental-variable" id="toc-internal-instrumental-variable"><span class="toc-section-number">28.3.2</span> Internal instrumental variable</a></li>
<li><a href="endogenous-treatment.html#proxy-variables" id="toc-proxy-variables"><span class="toc-section-number">28.3.3</span> Proxy Variables</a></li>
</ul></li>
<li><a href="endogenous-sample-selection.html#endogenous-sample-selection" id="toc-endogenous-sample-selection"><span class="toc-section-number">28.4</span> Endogenous Sample Selection</a>
<ul>
<li><a href="endogenous-sample-selection.html#tobit-2" id="toc-tobit-2"><span class="toc-section-number">28.4.1</span> Tobit-2</a></li>
<li><a href="endogenous-sample-selection.html#tobit-5" id="toc-tobit-5"><span class="toc-section-number">28.4.2</span> Tobit-5</a></li>
</ul></li>
</ul></li>
<li><a href="mediation.html#mediation" id="toc-mediation"><span class="toc-section-number">29</span> Mediation</a>
<ul>
<li><a href="traditional.html#traditional" id="toc-traditional"><span class="toc-section-number">29.1</span> Traditional</a>
<ul>
<li><a href="traditional.html#example-1-mediation-traditional" id="toc-example-1-mediation-traditional"><span class="toc-section-number">29.1.1</span> Example 1</a></li>
</ul></li>
<li><a href="model-based-causal-mediation-analysis.html#model-based-causal-mediation-analysis" id="toc-model-based-causal-mediation-analysis"><span class="toc-section-number">29.2</span> Model-based causal mediation analysis</a></li>
</ul></li>
<li><a href="directed-acyclic-graph.html#directed-acyclic-graph" id="toc-directed-acyclic-graph"><span class="toc-section-number">30</span> Directed Acyclic Graph</a></li>
<li><a href="#part-v.-miscellaneous" id="toc-part-v.-miscellaneous">(PART*) V. MISCELLANEOUS</a></li>
<li><a href="report.html#report" id="toc-report"><span class="toc-section-number">31</span> Report</a>
<ul>
<li><a href="one-summary-table.html#one-summary-table" id="toc-one-summary-table"><span class="toc-section-number">31.1</span> One summary table</a></li>
<li><a href="model-comparison.html#model-comparison" id="toc-model-comparison"><span class="toc-section-number">31.2</span> Model Comparison</a></li>
<li><a href="changes-in-an-estimate.html#changes-in-an-estimate" id="toc-changes-in-an-estimate"><span class="toc-section-number">31.3</span> Changes in an estimate</a></li>
</ul></li>
<li><a href="exploratory-data-analysis.html#exploratory-data-analysis" id="toc-exploratory-data-analysis"><span class="toc-section-number">32</span> Exploratory Data Analysis</a></li>
<li><a href="sensitivity-analysis-robustness-check.html#sensitivity-analysis-robustness-check" id="toc-sensitivity-analysis-robustness-check"><span class="toc-section-number">33</span> Sensitivity Analysis/ Robustness Check</a>
<ul>
<li><a href="specification-curve.html#specification-curve" id="toc-specification-curve"><span class="toc-section-number">33.1</span> Specification curve</a>
<ul>
<li><a href="specification-curve.html#starbility" id="toc-starbility"><span class="toc-section-number">33.1.1</span> starbility</a></li>
<li><a href="specification-curve.html#rdfanalysis" id="toc-rdfanalysis"><span class="toc-section-number">33.1.2</span> rdfanalysis</a></li>
</ul></li>
<li><a href="coefficient-stability.html#coefficient-stability" id="toc-coefficient-stability"><span class="toc-section-number">33.2</span> Coefficient stability</a></li>
</ul></li>
<li><a href="#appendix-appendix" id="toc-appendix-appendix">(APPENDIX) APPENDIX</a></li>
<li><a href="appendix.html#appendix" id="toc-appendix"><span class="toc-section-number">34</span> Appendix</a>
<ul>
<li><a href="git.html#git" id="toc-git"><span class="toc-section-number">34.1</span> Git</a></li>
<li><a href="short-cut.html#short-cut" id="toc-short-cut"><span class="toc-section-number">34.2</span> Short-cut</a></li>
<li><a href="function-short-cut.html#function-short-cut" id="toc-function-short-cut"><span class="toc-section-number">34.3</span> Function short-cut</a></li>
<li><a href="citation.html#citation" id="toc-citation"><span class="toc-section-number">34.4</span> Citation</a></li>
<li><a href="install-all-necessary-packageslibaries-on-your-local-machine.html#install-all-necessary-packageslibaries-on-your-local-machine" id="toc-install-all-necessary-packageslibaries-on-your-local-machine"><span class="toc-section-number">34.5</span> Install all necessary packages/libaries on your local machine</a></li>
</ul></li>
<li><a href="bookdown-cheat-sheet.html#bookdown-cheat-sheet" id="toc-bookdown-cheat-sheet"><span class="toc-section-number">35</span> Bookdown cheat sheet</a>
<ul>
<li><a href="operation.html#operation" id="toc-operation"><span class="toc-section-number">35.1</span> Operation</a></li>
<li><a href="math-expresssion-syntax.html#math-expresssion-syntax" id="toc-math-expresssion-syntax"><span class="toc-section-number">35.2</span> Math Expresssion/ Syntax</a>
<ul>
<li><a href="math-expresssion-syntax.html#statistics-notation" id="toc-statistics-notation"><span class="toc-section-number">35.2.1</span> Statistics Notation</a></li>
</ul></li>
<li><a href="table.html#table" id="toc-table"><span class="toc-section-number">35.3</span> Table</a></li>
</ul></li>
<li><a href="references.html#references" id="toc-references">References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A Guide on Data Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="endogenous-treatment" class="section level2" number="28.3">
<h2><span class="header-section-number">28.3</span> Endogenous Treatment</h2>
<p>Using the OLS estimates as a reference point</p>
<div class="sourceCode" id="cb446"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb446-1"><a href="endogenous-treatment.html#cb446-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AER)</span>
<span id="cb446-2"><a href="endogenous-treatment.html#cb446-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(REndo)</span>
<span id="cb446-3"><a href="endogenous-treatment.html#cb446-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">421</span>)</span>
<span id="cb446-4"><a href="endogenous-treatment.html#cb446-4" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;CASchools&quot;</span>)</span>
<span id="cb446-5"><a href="endogenous-treatment.html#cb446-5" aria-hidden="true" tabindex="-1"></a>school <span class="ot">&lt;-</span> CASchools</span>
<span id="cb446-6"><a href="endogenous-treatment.html#cb446-6" aria-hidden="true" tabindex="-1"></a>school<span class="sc">$</span>stratio <span class="ot">&lt;-</span> <span class="fu">with</span>(CASchools, students <span class="sc">/</span> teachers)</span>
<span id="cb446-7"><a href="endogenous-treatment.html#cb446-7" aria-hidden="true" tabindex="-1"></a>m1.ols <span class="ot">&lt;-</span></span>
<span id="cb446-8"><a href="endogenous-treatment.html#cb446-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(read <span class="sc">~</span> stratio <span class="sc">+</span> english <span class="sc">+</span> lunch <span class="sc">+</span> grades <span class="sc">+</span> income <span class="sc">+</span> calworks <span class="sc">+</span> county,</span>
<span id="cb446-9"><a href="endogenous-treatment.html#cb446-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">data =</span> school)</span>
<span id="cb446-10"><a href="endogenous-treatment.html#cb446-10" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1.ols)<span class="sc">$</span>coefficients[<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>, ]</span>
<span id="cb446-11"><a href="endogenous-treatment.html#cb446-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                 Estimate Std. Error     t value      Pr(&gt;|t|)</span></span>
<span id="cb446-12"><a href="endogenous-treatment.html#cb446-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept) 683.45305948 9.56214469  71.4748711 3.011667e-218</span></span>
<span id="cb446-13"><a href="endogenous-treatment.html#cb446-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; stratio      -0.30035544 0.25797023  -1.1643027  2.450536e-01</span></span>
<span id="cb446-14"><a href="endogenous-treatment.html#cb446-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; english      -0.20550107 0.03765408  -5.4576041  8.871666e-08</span></span>
<span id="cb446-15"><a href="endogenous-treatment.html#cb446-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lunch        -0.38684059 0.03700982 -10.4523759  1.427370e-22</span></span>
<span id="cb446-16"><a href="endogenous-treatment.html#cb446-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; gradesKK-08  -1.91291321 1.35865394  -1.4079474  1.599886e-01</span></span>
<span id="cb446-17"><a href="endogenous-treatment.html#cb446-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; income        0.71615378 0.09832843   7.2832829  1.986712e-12</span></span>
<span id="cb446-18"><a href="endogenous-treatment.html#cb446-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; calworks     -0.05273312 0.06154758  -0.8567863  3.921191e-01</span></span></code></pre></div>
<div id="instrumental-variable" class="section level3" number="28.3.1">
<h3><span class="header-section-number">28.3.1</span> Instrumental Variable</h3>
<p><a href="ordinary-least-squares.html#a3a">A3a</a> requires <span class="math inline">\(\epsilon_i\)</span> to be uncorrelated with <span class="math inline">\(\mathbf{x}_i\)</span></p>
<p>Assume <a href="ordinary-least-squares.html#a1-linearity">A1</a> , <a href="ordinary-least-squares.html#a2-full-rank">A2</a>, <a href="ordinary-least-squares.html#a5-data-generation-random-sampling">A5</a></p>
<p><span class="math display">\[
plim(\hat{\beta}_{OLS}) = \beta + [E(\mathbf{x_i&#39;x_i})]^{-1}E(\mathbf{x_i&#39;}\epsilon_i)
\]</span></p>
<p><a href="ordinary-least-squares.html#a3a">A3a</a> is the weakest assumption needed for OLS to be <strong>consistent</strong></p>
<p><a href="ordinary-least-squares.html#a3-exogeneity-of-independent-variables">A3</a> fails when <span class="math inline">\(x_{ik}\)</span> is correlated with <span class="math inline">\(\epsilon_i\)</span></p>
<ul>
<li>Omitted Variables Bias: <span class="math inline">\(\epsilon_i\)</span> includes any other factors that may influence the dependent variable (linearly)</li>
<li><a href="simultaneity.html#simultaneity">Simultaneity</a> Demand and prices are simultaneously determined.</li>
<li><a href="endogenous-sample-selection.html#endogenous-sample-selection">Endogenous Sample Selection</a> we did not have iid sample</li>
<li><a href="measurement-error.html#measurement-error">Measurement Error</a></li>
</ul>
<p><strong>Note</strong></p>
<ul>
<li>Omitted Variable: an omitted variable is a variable, omitted from the model (but is in the <span class="math inline">\(\epsilon_i\)</span>) and unobserved has predictive power towards the outcome.</li>
<li>Omitted Variable Bias: is the bias (and inconsistency when looking at large sample properties) of the OLS estimator when the omitted variable.</li>
<li>We cam have both positive and negative selection bias (it depends on what our story is)</li>
</ul>
<p>The <strong>structural equation</strong> is used to emphasize that we are interested understanding a <strong>causal relationship</strong></p>
<p><span class="math display">\[
y_{i1} = \beta_0 + \mathbf{z}_i1 \beta_1 + y_{i2}\beta_2 +  \epsilon_i
\]</span></p>
<p>where</p>
<ul>
<li><span class="math inline">\(y_{it}\)</span> is the outcome variable (inherently correlated with <span class="math inline">\(\epsilon_i\)</span>)</li>
<li><span class="math inline">\(y_{i2}\)</span> is the endogenous covariate (presumed to be correlated with <span class="math inline">\(\epsilon_i\)</span>)</li>
<li><span class="math inline">\(\beta_1\)</span> represents the causal effect of <span class="math inline">\(y_{i2}\)</span> on <span class="math inline">\(y_{i1}\)</span></li>
<li><span class="math inline">\(\mathbf{z}_{i1}\)</span> is exogenous controls (uncorrelated with <span class="math inline">\(\epsilon_i\)</span>) (<span class="math inline">\(E(z_{1i}&#39;\epsilon_i) = 0\)</span>)</li>
</ul>
<p>OLS is an inconsistent estimator of the causal effect <span class="math inline">\(\beta_2\)</span></p>
<p>If there was no endogeneity</p>
<ul>
<li><span class="math inline">\(E(y_{i2}&#39;\epsilon_i) = 0\)</span></li>
<li>the exogenous variation in <span class="math inline">\(y_{i2}\)</span> is what identifies the causal effect</li>
</ul>
<p>If there is endogeneity</p>
<ul>
<li>Any wiggle in <span class="math inline">\(y_{i2}\)</span> will shift simultaneously with <span class="math inline">\(\epsilon_i\)</span></li>
</ul>
<p><span class="math display">\[
plim(\hat{\beta}_{OLS}) = \beta + [E(\mathbf{x&#39;_ix_i})]^{-1}E(\mathbf{x&#39;_i}\epsilon_i)
\]</span></p>
<p>where</p>
<ul>
<li><span class="math inline">\(\beta\)</span> is the causal effect</li>
<li><span class="math inline">\([E(\mathbf{x&#39;_ix_i})]^{-1}E(\mathbf{x&#39;_i}\epsilon_i)\)</span> is the endogenous effect</li>
</ul>
<p>Hence <span class="math inline">\(\hat{\beta}_{OLS}\)</span> can be either more positive and negative than the true causal effect.</p>
<p><br></p>
<p>Motivation for <strong>Two Stage Least Squares (2SLS)</strong></p>
<p><span class="math display">\[
y_{i1}=\beta_0 + \mathbf{z}_{i1}\beta_1 + y_{i2}\beta_2 + \epsilon_i
\]</span></p>
<p>We want to understand how movement in <span class="math inline">\(y_{i2}\)</span> effects movement in <span class="math inline">\(y_{i1}\)</span>, but whenever we move <span class="math inline">\(y_{i2}\)</span>, <span class="math inline">\(\epsilon_i\)</span> also moves.</p>
<p><strong>Solution</strong><br />
We need a way to move <span class="math inline">\(y_{i2}\)</span> independently of <span class="math inline">\(\epsilon_i\)</span>, then we can analyze the response in <span class="math inline">\(y_{i1}\)</span> as a causal effect</p>
<ul>
<li><p>Find an <strong>instrumental variable(s)</strong> <span class="math inline">\(z_{i2}\)</span></p>
<ul>
<li>Instrument <strong>Relevance</strong>: when** <span class="math inline">\(z_{i2}\)</span> moves then <span class="math inline">\(y_{i2}\)</span> also moves</li>
<li>Instrument <strong>Exogeneity</strong>: when <span class="math inline">\(z_{i2}\)</span> moves then <span class="math inline">\(\epsilon_i\)</span> does not move.</li>
</ul></li>
<li><p><span class="math inline">\(z_{i2}\)</span> is the <strong>exogenous variation that identifies</strong> the causal effect <span class="math inline">\(\beta_2\)</span></p></li>
</ul>
<p>Finding an Instrumental variable:</p>
<ul>
<li>Random Assignment: + Effect of class size on educational outcomes: instrument is initial random</li>
<li>Relation’s Choice + Effect of Education on Fertility: instrument is parent’s educational level</li>
<li>Eligibility + Trade-off between IRA and 401K retirement savings: instrument is 401k eligibility</li>
</ul>
<p><strong>Example</strong></p>
<p>Return to College</p>
<ul>
<li><p>education is correlated with ability - endogenous</p></li>
<li><p><strong>Near 4year</strong> as an instrument</p>
<ul>
<li>Instrument Relevance: when <strong>near</strong> moves then education also moves</li>
<li>Instrument Exogeneity: when <strong>near</strong> moves then <span class="math inline">\(\epsilon_i\)</span> does not move.</li>
</ul></li>
<li><p>Other potential instruments; near a 2-year college. Parent’s Education. Owning Library Card</p></li>
</ul>
<p><span class="math display">\[
y_{i1}=\beta_0 + \mathbf{z}_{i1}\beta_1 + y_{i2}\beta_2 + \epsilon_i
\]</span></p>
<p>First Stage (Reduced Form) Equation:</p>
<p><span class="math display">\[
y_{i2} = \pi_0 + \mathbf{z_{i1}\pi_1} + \mathbf{z_{i2}\pi_2} + v_i
\]</span></p>
<p>where</p>
<ul>
<li><span class="math inline">\(\pi_0 + \mathbf{z_{i1}\pi_1} + \mathbf{z_{i2}\pi_2}\)</span> is exogenous variation <span class="math inline">\(v_i\)</span> is endogenous variation</li>
</ul>
<p>This is called a <strong>reduced form equation</strong></p>
<ul>
<li><p>Not interested in the causal interpretation of <span class="math inline">\(\pi_1\)</span> or <span class="math inline">\(\pi_2\)</span></p></li>
<li><p>A linear projection of <span class="math inline">\(z_{i1}\)</span> and <span class="math inline">\(z_{i2}\)</span> on <span class="math inline">\(y_{i2}\)</span> (simple correlations)</p></li>
<li><p>The projections <span class="math inline">\(\pi_1\)</span> and <span class="math inline">\(\pi_2\)</span> guarantee that <span class="math inline">\(E(z_{i1}&#39;v_i)=0\)</span> and <span class="math inline">\(E(z_{i2}&#39;v_i)=0\)</span></p></li>
</ul>
<p>Instrumental variable <span class="math inline">\(z_{i2}\)</span></p>
<ul>
<li><strong>Instrument Relevance</strong>: <span class="math inline">\(\pi_2 \neq 0\)</span></li>
<li><strong>Instrument Exogeneity</strong>: <span class="math inline">\(E(\mathbf{z_{i2}\epsilon_i})=0\)</span></li>
</ul>
<p>Moving only the exogenous part of <span class="math inline">\(y_i2\)</span> is moving</p>
<p><span class="math display">\[
\tilde{y}_{i2} = \pi_0 + \mathbf{z_{i1}\pi_1 + z_{i2}\pi_2}
\]</span></p>
<p><strong>two Stage Least Squares (2SLS)</strong></p>
<p><span class="math display">\[
y_{i1} = \beta_0 +\mathbf{z_{i1}\beta_1}+ y_{i2}\beta_2 + \epsilon_i
\]</span></p>
<p><span class="math display">\[
y_{i2} = \pi_0 + \mathbf{z_{i2}\pi_2} + \mathbf{v_i}
\]</span></p>
<p>Equivalently,</p>
<span class="math display" id="eq:2SLS">\[\begin{equation}
\begin{split}
y_{i1} = \beta_0 + \mathbf{z_{i1}}\beta_1 + \tilde{y}_{i2}\beta_2 + u_i
\end{split}
\tag{28.1}
\end{equation}\]</span>
<p>where</p>
<ul>
<li><span class="math inline">\(\tilde{y}_{i2} =\pi_0 + \mathbf{z_{i2}\pi_2}\)</span></li>
<li><span class="math inline">\(u_i = v_i \beta_2+ \epsilon_i\)</span></li>
</ul>
<p>The <a href="endogenous-treatment.html#eq:2SLS">(28.1)</a> holds for <a href="ordinary-least-squares.html#a1-linearity">A1</a>, <a href="ordinary-least-squares.html#a5-data-generation-random-sampling">A5</a></p>
<ul>
<li><a href="ordinary-least-squares.html#a2-full-rank">A2</a> holds if the instrument is relevant <span class="math inline">\(\pi_2 \neq 0\)</span> + <span class="math inline">\(y_{i1} = \beta_0 + \mathbf{z_{i1}\beta_1 + (\pi_0 + z_{i1}\pi_1 + z_{i2}\pi_2)}\beta_2 + u_i\)</span></li>
<li><a href="ordinary-least-squares.html#a3a">A3a</a> holds if the instrument is exogenous <span class="math inline">\(E(\mathbf{z}_{i2}\epsilon_i)=0\)</span></li>
</ul>
<p><span class="math display">\[
\begin{aligned}
E(\tilde{y}_{i2}&#39;u_i) &amp;= E((\pi_0 + \mathbf{z_{i1}\pi_1+z_{i2}})(v_i\beta_2 + \epsilon_i)) \\
&amp;= E((\pi_0 + \mathbf{z_{i1}\pi_1+z_{i2}})( \epsilon_i)) \\
&amp;= E(\epsilon_i)\pi_0 + E(\epsilon_iz_{i1})\pi_1 + E(\epsilon_iz_{i2}) \\
&amp;=0
\end{aligned}
\]</span></p>
<p>Hence, <a href="endogenous-treatment.html#eq:2SLS">(28.1)</a> is consistent</p>
<p>The 2SLS Estimator<br />
1. Estimate the first stage using <a href="ordinary-least-squares.html#ordinary-least-squares">OLS</a></p>
<p><span class="math display">\[
y_{i2} = \pi_0 + \mathbf{z_{i2}\pi_2} + \mathbf{v_i}
\]</span></p>
<p>and obtained estimated value <span class="math inline">\(\hat{y}_{i2}\)</span></p>
<ol start="2" style="list-style-type: decimal">
<li>Estimate the altered equation using <a href="ordinary-least-squares.html#ordinary-least-squares">OLS</a></li>
</ol>
<p><span class="math display">\[
y_{i1} = \beta_0 +\mathbf{z_{i1}\beta_1}+ \hat{y}_{i2}\beta_2 + \epsilon_i \\
\]</span></p>
<p><strong>Properties of the 2SLS Estimator</strong></p>
<ul>
<li>Under <a href="ordinary-least-squares.html#a1-linearity">A1</a>, <a href="ordinary-least-squares.html#a2-full-rank">A2</a>, <a href="ordinary-least-squares.html#a3a">A3a</a> (for <span class="math inline">\(z_{i1}\)</span>), <a href="ordinary-least-squares.html#a5-data-generation-random-sampling">A5</a> and if the instrument satisfies the following two conditions, + <strong>Instrument Relevance</strong>: <span class="math inline">\(\pi_2 \neq 0\)</span> + <strong>Instrument Exogeneity</strong>: <span class="math inline">\(E(\mathbf{z}_{i2}&#39;\epsilon_i) = 0\)</span> then the 2SLS estimator is consistent</li>
<li>Can handle more than one endogenous variable and more than one instrumental variable</li>
</ul>
<p><span class="math display">\[
y_{i1} = \beta_0 + z_{i1}\beta_1 + y_{i2}\beta_2 + y_{i3}\beta_3 + \epsilon_i \\
y_{i2} = \pi_0 + z_{i1}\pi_1 + z_{i2}\pi_2 + z_{i3}\pi_3 + z_{i4}\pi_4 + v_{i2} \\
y_{i3} = \gamma_0 + z_{i1}\gamma_1 + z_{i2}\gamma_2 + z_{i3}\gamma_3 + z_{i4}\gamma_4 + v_{i3}
\]</span></p>
<pre><code>    + **IV estimator**: one endogenous variable with a single instrument 
    + **2SLS estimator**: one endogenous variable with multiple instruments 
    + **GMM estimator**: multiple endogenous variables with multiple instruments
    </code></pre>
<ul>
<li><p>Standard errors produced in the second step are not correct</p>
<ul>
<li>Because we do not know <span class="math inline">\(\tilde{y}\)</span> perfectly and need to estimate it in the firs step, we are introducing additional variation</li>
<li>We did not have this problem with <a href="feasible-generalized-least-squares.html#feasible-generalized-least-squares">FGLS</a> because “the first stage was orthogonal to the second stage.” This is generally not true for most multi-step procedure.<br />
</li>
<li>If <a href="ordinary-least-squares.html#a4-homoskedasticity">A4</a> does not hold, need to report robust standard errors.</li>
</ul></li>
<li><p>2SLS is less efficient than OLS and will always have larger standard errors.<br />
</p>
<ul>
<li>First, <span class="math inline">\(Var(u_i) = Var(v_i\beta_2 + \epsilon_i) &gt; Var(\epsilon_i)\)</span><br />
</li>
<li>Second, <span class="math inline">\(\hat{y}_{i2}\)</span> is generally highly collinear with <span class="math inline">\(\mathbf{z}_{i1}\)</span><br />
</li>
</ul></li>
<li><p>The number of instruments need to be at least as many or more the number of endogenous variables.</p></li>
</ul>
<p><strong>Note</strong></p>
<ul>
<li>2SLS can be combined with <a href="feasible-generalized-least-squares.html#feasible-generalized-least-squares">FGLS</a> to make the estimator more efficient: You have the same first-stage, and in the second-stage, instead of using OLS, you can use FLGS with the weight matrix <span class="math inline">\(\hat{w}\)</span><br />
</li>
<li>Generalized Method of Moments can be more efficient than 2SLS.<br />
</li>
<li>In the second-stage of 2SLS, you can also use <a href="solutions-to-missing-data.html#maximum-likelihood">MLE</a>, but then you are making assumption on the distribution of the outcome variable, the endogenous variable, and their relationship (joint distribution).</li>
</ul>
<div id="testing-assumption" class="section level4" number="28.3.1.1">
<h4><span class="header-section-number">28.3.1.1</span> Testing Assumption</h4>
<ol style="list-style-type: decimal">
<li><p><a href="endogenous-treatment.html#test-of-endogeneity">Test of Endogeneity</a>: Is <span class="math inline">\(y_{i2}\)</span> truly endogenous (i.e., can we just use OLS instead of 2SLS)?</p></li>
<li><p><a href="endogenous-treatment.html#testing-instruments-assumptions">Testing Instrument’s assumptions</a></p>
<ul>
<li><p><a href="endogenous-treatment.html#exogeneity">Exogeneity</a> (Cannot always test “and when you can it might not be informative”)</p></li>
<li><p><a href="endogenous-treatment.html#relevancy">Relevancy</a> (need to avoid “weak instruments”)</p></li>
</ul></li>
</ol>
<div id="test-of-endogeneity" class="section level5" number="28.3.1.1.1">
<h5><span class="header-section-number">28.3.1.1.1</span> Test of Endogeneity</h5>
<ul>
<li><p>2SLS is generally so inefficient that we may prefer OLS if there is not much endogeneity</p></li>
<li><p>Biased but inefficient vs efficient but biased</p></li>
<li><p>Want a sense of “how endogenous” <span class="math inline">\(y_{i2}\)</span> is</p>
<ul>
<li>if “very” endogeneous - should use 2SLS</li>
<li>if not “very” endogenous - perhaps prefer OLS</li>
</ul></li>
</ul>
<p><strong>Invalid</strong> Test of Endogeneity: <span class="math inline">\(y_{i2}\)</span> is endogenous if it is correlated with <span class="math inline">\(\epsilon_i\)</span>,</p>
<p><span class="math display">\[
\epsilon_i = \gamma_0 + y_{i2}\gamma_1 + error_i
\]</span></p>
<p>where <span class="math inline">\(\gamma_1 \neq 0\)</span> implies that there is endogeneity</p>
<ul>
<li><span class="math inline">\(\epsilon_i\)</span> is not observed, but using the residuals</li>
</ul>
<p><span class="math display">\[
e_i = \gamma_0 + y_{i2}\gamma_1 + error_i
\]</span></p>
<p>is <strong>NOT</strong> a valid test of endogeneity + The OLS residual, e is mechanically uncorrelated with <span class="math inline">\(y_{i2}\)</span> (by FOC for OLS) + In every situation, <span class="math inline">\(\gamma_1\)</span> will be essentially 0 and you will never be able to reject the null of no endogeneity</p>
<p><br></p>
<p><strong>Valid</strong> test of endogeneity</p>
<ul>
<li>If <span class="math inline">\(y_{i2}\)</span> is not endogenous then <span class="math inline">\(\epsilon_i\)</span> and v are uncorrelated</li>
</ul>
<p><span class="math display">\[
y_{i1} = \beta_0 + \mathbf{z}_{i1}\beta_1 + y_{i2}\beta_2 + \epsilon_i \\
y_{i2} = \pi_0 + \mathbf{z}_{i1}\pi_1 + z_{i2}\pi_2 + v_i
\]</span></p>
<p><strong>variable Addition test</strong>: include the first stage residuals as an additional variable,</p>
<p><span class="math display">\[
y_{i1} = \beta_0 + \mathbf{z}_{i1}\beta_1 + y_{i2}\beta_2 + \hat{v}_i \theta + error_i
\]</span></p>
<p>Then the usual t-test of significance is a valid test to evaluate the following hypothesis. <strong>note</strong> this test requires your instrument to be valid instrument.</p>
<p><span class="math display">\[
\begin{aligned}
H_0: \theta = 0 &amp;&amp; \text{  (not endogenous)} \\
H_1: \theta \neq 0 &amp;&amp; \text{  (endogenous)}
\end{aligned}
\]</span></p>
</div>
<div id="testing-instruments-assumptions" class="section level5" number="28.3.1.1.2">
<h5><span class="header-section-number">28.3.1.1.2</span> Testing Instrument’s assumptions</h5>
<p>The instrumental variable must satisfy</p>
<ol style="list-style-type: decimal">
<li><a href="endogenous-treatment.html#exogeneity">Exogeneity</a> (Cannot always test “and when you can it might not be informative”)</li>
<li><a href="endogenous-treatment.html#relevancy">Relevancy</a> (need to avoid “weak instruments”)</li>
</ol>
<div id="exogeneity" class="section level6" number="28.3.1.1.2.1">
<h6><span class="header-section-number">28.3.1.1.2.1</span> Exogeneity</h6>
<p>Why exogeneity matter?</p>
<p><span class="math display">\[
E(\mathbf{z}_{i2}&#39;\epsilon_i) = 0
\]</span></p>
<ul>
<li>If <a href="ordinary-least-squares.html#a3a">A3a</a> fails - 2SLS is also inconsistent</li>
<li>If instrument is not exogenous, then we need to find a new one.</li>
<li>Similar to <a href="endogenous-treatment.html#test-of-endogeneity">Test of Endogeneity</a>, when there is a single instrument</li>
</ul>
<p><span class="math display">\[
e_i = \gamma_0 + \mathbf{z}_{i2}\gamma_1 + error_i \\
H_0: \gamma_1 = 0
\]</span></p>
<p>is <strong>NOT</strong> a valid test of endogeneity</p>
<ul>
<li>the OLS residual, e is mechanically uncorrelated with <span class="math inline">\(z_{i2}\)</span>: <span class="math inline">\(\hat{\gamma}_1\)</span> will be essentially 0 and you will never be able to determine if the instrument is endogenous.</li>
</ul>
<p><br></p>
<p><strong>Solution</strong></p>
<p>Testing Instrumental Exegeneity in an Over-identified Model</p>
<ul>
<li><p>When there is more than one exogenous instrument (per endogenous variable), we can test for instrument exogeneity.</p>
<ul>
<li><p>When we have multiple instruments, the model is said to be over-identified.</p></li>
<li><p>Could estimate the same model several ways (i.e., can identify/ estimate <span class="math inline">\(\beta_1\)</span> more than one way)</p></li>
</ul></li>
<li><p>Idea behind the test: if the controls and instruments are truly exogenous then OLS estimation of the following regression,</p></li>
</ul>
<p><span class="math display">\[
\epsilon_i = \gamma_0 + \mathbf{z}_{i1}\gamma_1 + \mathbf{z}_{i2}\gamma_2 + error_i
\]</span></p>
<p>should have a very low <span class="math inline">\(R^2\)</span></p>
<ul>
<li>if the model is <strong>just identified</strong> (one instrument per endogenous variable) then the <span class="math inline">\(R^2 = 0\)</span></li>
</ul>
<p>Steps:</p>
<ol style="list-style-type: decimal">
<li><p>Estimate the structural equation by 2SLS (using all available instruments) and obtain the residuals e</p></li>
<li><p>Regress e on all controls and instruments and obtain the <span class="math inline">\(R^2\)</span></p></li>
<li><p>Under the null hypothesis (all IV’s are uncorrelated), <span class="math inline">\(nR^2 \sim \chi^2(q)\)</span>, where q is the number of instrumental variables minus the number of endogenous variables</p>
<ul>
<li>if the model is just identified (one instrument per endogenous variable) then q = 0, and the distribution under the null collapses.</li>
</ul></li>
</ol>
<p>low p-value means you reject the null of exogenous instruments. Hence you would like to have high p-value in this test.</p>
<p><br></p>
<p><strong>Pitfalls for the Overid test</strong></p>
<ul>
<li><p>the overid test is essentially compiling the following information.<br />
</p>
<ul>
<li>Conditional on first instrument being exogenous is the other instrument exogenous?<br />
</li>
<li>Conditional on the other instrument being exogenous, is the first instrument exogenous?<br />
</li>
</ul></li>
<li><p>If all instruments are endogenous than neither test will be valid</p></li>
<li><p>really only useful if one instrument is thought to be truly exogenous (randomly assigned). even f you do reject the null, the test does not tell you which instrument is exogenous and which is endogenous.</p></li>
</ul>
<table>
<colgroup>
<col width="22%" />
<col width="77%" />
</colgroup>
<thead>
<tr class="header">
<th>Result</th>
<th>Implication</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>reject the null</td>
<td>you can be pretty sure there is an endogenous instrument, but don’t know which one.</td>
</tr>
<tr class="even">
<td>fail to reject</td>
<td>could be either (1) they are both exogenous, (2) they are both endogenous.</td>
</tr>
</tbody>
</table>
</div>
<div id="relevancy" class="section level6" number="28.3.1.1.2.2">
<h6><span class="header-section-number">28.3.1.1.2.2</span> Relevancy</h6>
<p>Why Relevance matter?</p>
<p><span class="math display">\[
\pi_2 \neq 0
\]</span></p>
<p>* used to show <a href="ordinary-least-squares.html#a2-full-rank">A2</a> holds + If <span class="math inline">\(\pi_2 = 0\)</span> (instrument is not relevant) then <a href="ordinary-least-squares.html#a2-full-rank">A2</a> fails - perfect multicollinearity<br />
+ If <span class="math inline">\(\pi_2\)</span> is close to 0 (<strong>weak instrument</strong>) then there is near perfect multicollinearity - 2SLS is highly inefficient (Large standard errors).<br />
* A weak instrument will exacerbate any inconsistency due to an instrument being (even slightly) endogenous.<br />
+ In the simple case with no controls and a single endogenous variable and single instrumental variable,</p>
<p><span class="math display">\[
plim(\hat{\beta}_{2_{2SLS}}) = \beta_2 + \frac{E(z_{i2}\epsilon_i)}{E(z_{i2}y_{i2})}
\]</span></p>
<p><strong>Testing Weak Instruments</strong></p>
<ul>
<li><p>can use t-test (or F-test for over-identified models) in the first stage to determine if there is a weak instrument problem.</p></li>
<li><p><span class="citation">(<a href="#ref-Stock_2005" role="doc-biblioref">James H. Stock and Yogo 2005</a>)</span>: a statistical rejection of the null hypothesis in the first stage at the 5% (or even 1%) level is not enough to insure the instrument is not weak<br />
</p>
<ul>
<li>Rule of Thumb: need a F-stat of at least 10 (or a t-stat of at least 3.2) to reject the null hypothesis that the instrument is weak.</li>
</ul></li>
</ul>
<p><strong>Summary of the 2SLS Estimator</strong></p>
<p><span class="math display">\[
y_{i1}=\beta_0 + \mathbf{z}_{i1}\beta_1 + y_{i2}\beta_2 + \epsilon_i \\
y_{i2} = \pi_0 + \mathbf{z_{i1}\pi_1} + \mathbf{z_{i2}\pi_2} + v_i
\]</span></p>
<ul>
<li>when <a href="ordinary-least-squares.html#a3a">A3a</a> does not hold</li>
</ul>
<p><span class="math display">\[
E(y_{i2}&#39;\epsilon_i) \neq 0
\]</span></p>
<ul>
<li><p>Then the OLS estimator is no longer unbiased or consistent.</p></li>
<li><p>If we have valid instruments <span class="math inline">\(\mathbf{z}_{i2}\)</span></p></li>
<li><p><a href="endogenous-treatment.html#relevancy">Relevancy</a> (need to avoid “weak instruments”): <span class="math inline">\(\pi_2 \neq 0\)</span> Then the 2SLS estimator is consistent under <a href="ordinary-least-squares.html#a1-linearity">A1</a>, <a href="ordinary-least-squares.html#a2-full-rank">A2</a>, <a href="ordinary-least-squares.html#a5a">A5a</a>, and the above two conditions. + If <a href="ordinary-least-squares.html#a4-homoskedasticity">A4</a> also holds, then the usual standard errors are valid. + If <a href="ordinary-least-squares.html#a4-homoskedasticity">A4</a> does not hold then use the robust standard errors.</p></li>
</ul>
<p><span class="math display">\[
y_{i1}=\beta_0 + \mathbf{z}_{i1}\beta_1 + y_{i2}\beta_2 + \epsilon_i \\
y_{i2} = \pi_0 + \mathbf{z_{i1}\pi_1} + \mathbf{z_{i2}\pi_2} + v_i
\]</span></p>
<ul>
<li>When <a href="ordinary-least-squares.html#a3a">A3a</a> does hold</li>
</ul>
<p><span class="math display">\[
E(y_{i2}&#39;\epsilon_i) = 0
\]</span></p>
<p>and we have valid instruments, then both the OLS and 2SLS estimators are consistent.</p>
<ul>
<li>The OLS estimator is always more efficient</li>
<li>can use the variable addition test to determine if 2SLS is need (A3a does hold) or if OLS is valid (A3a does not hold)</li>
</ul>
<p>Sometimes we can test the assumption for instrument to be valid:</p>
<ul>
<li><a href="endogenous-treatment.html#exogeneity">Exogeneity</a> : Only table when there are more instruments than endogenous variables.</li>
<li><a href="endogenous-treatment.html#relevancy">Relevancy</a> (need to avoid “weak instruments”): Always testable, need the F-stat to be greater than 10 to rule out a weak instrument</li>
</ul>
<p>Application</p>
<p>Expenditure as observed instrument</p>
<div class="sourceCode" id="cb448"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb448-1"><a href="endogenous-treatment.html#cb448-1" aria-hidden="true" tabindex="-1"></a>m2<span class="fl">.2</span>sls <span class="ot">&lt;-</span></span>
<span id="cb448-2"><a href="endogenous-treatment.html#cb448-2" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ivreg</span>(</span>
<span id="cb448-3"><a href="endogenous-treatment.html#cb448-3" aria-hidden="true" tabindex="-1"></a>                read <span class="sc">~</span> stratio <span class="sc">+</span> english <span class="sc">+</span> lunch <span class="sc">+</span> grades <span class="sc">+</span> income <span class="sc">+</span> calworks <span class="sc">+</span></span>
<span id="cb448-4"><a href="endogenous-treatment.html#cb448-4" aria-hidden="true" tabindex="-1"></a>                        county <span class="sc">|</span> expenditure <span class="sc">+</span> english <span class="sc">+</span> lunch <span class="sc">+</span> grades <span class="sc">+</span> income <span class="sc">+</span> calworks <span class="sc">+</span></span>
<span id="cb448-5"><a href="endogenous-treatment.html#cb448-5" aria-hidden="true" tabindex="-1"></a>                        county ,</span>
<span id="cb448-6"><a href="endogenous-treatment.html#cb448-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> school</span>
<span id="cb448-7"><a href="endogenous-treatment.html#cb448-7" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb448-8"><a href="endogenous-treatment.html#cb448-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m2<span class="fl">.2</span>sls)<span class="sc">$</span>coefficients[<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>, ]</span>
<span id="cb448-9"><a href="endogenous-treatment.html#cb448-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                 Estimate  Std. Error     t value      Pr(&gt;|t|)</span></span>
<span id="cb448-10"><a href="endogenous-treatment.html#cb448-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept) 700.47891593 13.58064436  51.5792106 8.950497e-171</span></span>
<span id="cb448-11"><a href="endogenous-treatment.html#cb448-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; stratio      -1.13674002  0.53533638  -2.1234126  3.438427e-02</span></span>
<span id="cb448-12"><a href="endogenous-treatment.html#cb448-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; english      -0.21396934  0.03847833  -5.5607753  5.162571e-08</span></span>
<span id="cb448-13"><a href="endogenous-treatment.html#cb448-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lunch        -0.39384225  0.03773637 -10.4366757  1.621794e-22</span></span>
<span id="cb448-14"><a href="endogenous-treatment.html#cb448-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; gradesKK-08  -1.89227865  1.37791820  -1.3732881  1.704966e-01</span></span>
<span id="cb448-15"><a href="endogenous-treatment.html#cb448-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; income        0.62487986  0.11199008   5.5797785  4.668490e-08</span></span>
<span id="cb448-16"><a href="endogenous-treatment.html#cb448-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; calworks     -0.04950501  0.06244410  -0.7927892  4.284101e-01</span></span></code></pre></div>
<p><br></p>
</div>
</div>
</div>
<div id="checklist" class="section level4" number="28.3.1.2">
<h4><span class="header-section-number">28.3.1.2</span> Checklist</h4>
<ol style="list-style-type: decimal">
<li>Regress the dependent variable on the instrument (reduced form). Since under OLS, we have unbiased estimate, the coefficient estimate should be significant (make sure the sign makes sense)</li>
<li>Report F-stat on the excluded instruments. F-stat &lt; 10 means you have a weak instrument <span class="citation">(<a href="#ref-stock2002survey" role="doc-biblioref">James H. Stock, Wright, and Yogo 2002</a>)</span>.</li>
<li>Present <span class="math inline">\(R^2\)</span> before and after including the instrument <span class="citation">(<a href="#ref-rossi2014even" role="doc-biblioref">Rossi 2014</a>)</span></li>
<li>For models with multiple instrument, present firs-t and second-stage result for each instrument separately. Overid test should be conducted (e.g., Sargan-Hansen J)</li>
<li>Hausman test between OLS and 2SLS (don’t confuse this test for evidence that endogeneity is irrelevant - under invalid IV, the test is useless)</li>
<li>Compare the 2SLS with the limited information ML. If they are different, you have evidence for weak instruments.</li>
</ol>
</div>
<div id="good-instruments" class="section level4" number="28.3.1.3">
<h4><span class="header-section-number">28.3.1.3</span> Good Instruments</h4>
<p><a href="endogenous-treatment.html#exogeneity">Exogeneity</a> and <a href="endogenous-treatment.html#relevancy">Relevancy</a> are necessary but not sufficient for IV to produce consistent estimates.</p>
<p>Without theory or possible explanation, you can always create a new variable that is correlated with <span class="math inline">\(X\)</span> and uncorrelated with <span class="math inline">\(\epsilon\)</span></p>
<p>For example, we want to estimate the effect of price on quantity <span class="citation">(<a href="#ref-reiss2011" role="doc-biblioref">Reiss 2011, 960</a>)</span></p>
<p><span class="math display">\[
Q = \beta_1 P + \beta_2 X + \epsilon \\
P = \pi_1 X + \eta
\]</span></p>
<p>where <span class="math inline">\(\epsilon\)</span> and <span class="math inline">\(\eta\)</span> are jointly determined, <span class="math inline">\(X \perp \epsilon, \eta\)</span></p>
<p>Without theory, we can just create a new variable <span class="math inline">\(Z = X + u\)</span> where <span class="math inline">\(E(u) = 0; u \perp X, \epsilon, \eta\)</span></p>
<p>Then, <span class="math inline">\(Z\)</span> satisfied both conditions:</p>
<ul>
<li><p>Relevancy: <span class="math inline">\(X\)</span> correlates <span class="math inline">\(P\)</span> <span class="math inline">\(\rightarrow\)</span> <span class="math inline">\(Z\)</span> correlates <span class="math inline">\(P\)</span></p></li>
<li><p>Exogeneity: <span class="math inline">\(u \perp \epsilon\)</span> (random noise)</p></li>
</ul>
<p>But obviously, it’s not a valid instrument (intuitively). But theoretically, relevance and exogeneity are not sufficient to identify <span class="math inline">\(\beta\)</span> because of unsatisfied rank condition for identification.</p>
<p>Moreover, the functional form of the instrument also plays a role when choosing a good instrument. Hence, we always need to check for the robustness of our instrument.</p>
<p>IV methods even with valid instruments can still have poor sampling properties (finite sample bias, large sampling errors) <span class="citation">(<a href="#ref-rossi2014even" role="doc-biblioref">Rossi 2014</a>)</span></p>
<p>When you have a weak instrument, it’s important to report it appropriately <span class="citation">(<a href="#ref-lee2021valid" role="doc-biblioref">D. S. Lee et al. 2021</a>)</span>. This problem will be exacerbated if you have multiple instruments.</p>
<div id="lagged-dependent-variable" class="section level5" number="28.3.1.3.1">
<h5><span class="header-section-number">28.3.1.3.1</span> Lagged dependent variable</h5>
<p>In time series data sets, we can use lagged dependent variable as an instrument because it is not influenced by current shocks.</p>
<p>Citations for lagged dependent variable in econ <span class="citation">(<a href="#ref-chetty2013" role="doc-biblioref">Raj Chetty, Friedman, and Rockoff 2013</a>)</span>,</p>
<p><br></p>
</div>
</div>
</div>
<div id="internal-instrumental-variable" class="section level3" number="28.3.2">
<h3><span class="header-section-number">28.3.2</span> Internal instrumental variable</h3>
<ul>
<li><p>(also known as <strong>instrument free methods</strong>). This section is based on Raluca Gui’s <a href="https://cran.r-project.org/web/packages/REndo/vignettes/REndo-introduction.pdf">guide</a></p></li>
<li><p>alternative to external instrumental variable approaches</p></li>
<li><p>All approaches here assume a <strong>continuous dependent variable</strong></p></li>
</ul>
<div id="non-hierarchical-data-cross-classified" class="section level4" number="28.3.2.1">
<h4><span class="header-section-number">28.3.2.1</span> Non-hierarchical Data (Cross-classified)</h4>
<p><span class="math display">\[
Y_t = \beta_0 + \beta_1 P_t + \beta_2 X_t + \epsilon_t
\]</span></p>
<p>where</p>
<ul>
<li><span class="math inline">\(t = 1, .., T\)</span> (indexes either time or cross-sectional units)</li>
<li><span class="math inline">\(Y_t\)</span> is a k x 1 response variable</li>
<li><span class="math inline">\(X_t\)</span> is a k x n exogenous regressor</li>
<li><span class="math inline">\(P_t\)</span> is a k x 1 continuous endogenous regressor</li>
<li><span class="math inline">\(\epsilon_t\)</span> is a structural error term with <span class="math inline">\(\mu_\epsilon =0\)</span> and <span class="math inline">\(E(\epsilon^2) = \sigma^2\)</span></li>
<li><span class="math inline">\(\beta\)</span> are model parameters</li>
</ul>
<p>The endogeneity problem arises from the correlation of <span class="math inline">\(P_t\)</span> and <span class="math inline">\(\epsilon_t\)</span>:</p>
<p><span class="math display">\[
P_t = \gamma Z_t + v_t
\]</span></p>
<p>where</p>
<ul>
<li><span class="math inline">\(Z_t\)</span> is a l x 1 vector of internal instrumental variables<br />
</li>
<li><span class="math inline">\(ν_t\)</span> is a random error with <span class="math inline">\(\mu_{v_t}, E(v^2) = \sigma^2_v, E(\epsilon v) = \sigma_{\epsilon v}\)</span><br />
</li>
<li><span class="math inline">\(Z_t\)</span> is assumed to be stochastic with distribution G<br />
</li>
<li><span class="math inline">\(ν_t\)</span> is assumed to have density h(·)</li>
</ul>
<div id="latent-instrumental-variable" class="section level5" number="28.3.2.1.1">
<h5><span class="header-section-number">28.3.2.1.1</span> Latent Instrumental Variable</h5>
<p><span class="citation">(<a href="#ref-Ebbes_2005" role="doc-biblioref">Ebbes et al. 2005</a>)</span></p>
<p>assume <span class="math inline">\(Z_t\)</span> (unobserved) to be uncorrelated with <span class="math inline">\(\epsilon_t\)</span>, which is similar to <a href="endogenous-treatment.html#instrumental-variable">Instrumental Variable</a>. Hence, <span class="math inline">\(Z_t\)</span> and <span class="math inline">\(ν_t\)</span> can’t be identified without distributional assumptions</p>
<p>The distributions of <span class="math inline">\(Z_t\)</span> and <span class="math inline">\(ν_t\)</span> need to be specified such that:</p>
<ol style="list-style-type: decimal">
<li>endogeneity of <span class="math inline">\(P_t\)</span> is corrected<br />
</li>
<li>the distribution of <span class="math inline">\(P_t\)</span> is empirically close to the integral that expresses the amount of overlap of Z as it is shifted over ν (= the convolution between <span class="math inline">\(Z_t\)</span> and <span class="math inline">\(ν_t\)</span>).</li>
</ol>
<p>When the density h(·) = Normal, then G cannot be normal because the parameters would not be identified <span class="citation">(<a href="#ref-Ebbes_2005" role="doc-biblioref">Ebbes et al. 2005</a>)</span> .</p>
<p>Hence,</p>
<ul>
<li>in the <a href="endogenous-treatment.html#latent-instrumental-variable">LIV</a> model the distribution of <span class="math inline">\(Z_t\)</span> is discrete</li>
<li>in the <a href="endogenous-treatment.html#higher-moments-method">Higher Moments Method</a> and <a href="endogenous-treatment.html#joint-estimation-using-copula">Joint Estimation Using Copula</a> methods, the distribution of <span class="math inline">\(Z_t\)</span> is taken to be skewed.</li>
</ul>
<p><span class="math inline">\(Z_t\)</span> are assumed <strong>unobserved, discrete and exogenous</strong>, with</p>
<ul>
<li>an unknown number of groups m</li>
<li><span class="math inline">\(\gamma\)</span> is a vector of group means.</li>
</ul>
<p>Identification of the parameters relies on the distributional assumptions of</p>
<ul>
<li><span class="math inline">\(P_t\)</span>: a non-Gaussian distribution</li>
<li><span class="math inline">\(Z_t\)</span> discrete with <span class="math inline">\(m \ge 2\)</span></li>
</ul>
<p>Note:</p>
<ul>
<li>If <span class="math inline">\(Z_t\)</span> is continuous, the model is unidentified</li>
<li>If <span class="math inline">\(P_t \sim N\)</span>, you have inefficient estimates.</li>
</ul>
<div class="sourceCode" id="cb449"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb449-1"><a href="endogenous-treatment.html#cb449-1" aria-hidden="true" tabindex="-1"></a>m3.liv <span class="ot">&lt;-</span> <span class="fu">latentIV</span>(read <span class="sc">~</span> stratio, <span class="at">data=</span>school)</span>
<span id="cb449-2"><a href="endogenous-treatment.html#cb449-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m3.liv)<span class="sc">$</span>coefficients[<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>,]</span>
<span id="cb449-3"><a href="endogenous-treatment.html#cb449-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                   Estimate    Std. Error       z-score     Pr(&gt;|z|)</span></span>
<span id="cb449-4"><a href="endogenous-treatment.html#cb449-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)   6.996014e+02  2.686186e+02  2.604441e+00 9.529597e-03</span></span>
<span id="cb449-5"><a href="endogenous-treatment.html#cb449-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; stratio      -2.272673e+00  1.367757e+01 -1.661605e-01 8.681108e-01</span></span>
<span id="cb449-6"><a href="endogenous-treatment.html#cb449-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; pi1          -4.896363e+01  5.526907e-08 -8.859139e+08 0.000000e+00</span></span>
<span id="cb449-7"><a href="endogenous-treatment.html#cb449-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; pi2           1.963920e+01  9.225351e-02  2.128830e+02 0.000000e+00</span></span>
<span id="cb449-8"><a href="endogenous-treatment.html#cb449-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; theta5       6.939432e-152 3.354672e-160  2.068587e+08 0.000000e+00</span></span>
<span id="cb449-9"><a href="endogenous-treatment.html#cb449-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; theta6        3.787512e+02  4.249457e+01  8.912932e+00 1.541524e-17</span></span>
<span id="cb449-10"><a href="endogenous-treatment.html#cb449-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; theta7       -1.227543e+00  4.885276e+01 -2.512741e-02 9.799653e-01</span></span></code></pre></div>
<p>it will return a coefficient very different from the other methods since there is only one endogenous variable.</p>
</div>
<div id="joint-estimation-using-copula" class="section level5" number="28.3.2.1.2">
<h5><span class="header-section-number">28.3.2.1.2</span> Joint Estimation Using Copula</h5>
<p>assume <span class="math inline">\(Z_t\)</span> (unobserved) to be uncorrelated with <span class="math inline">\(\epsilon_t\)</span>, which is similar to <a href="endogenous-treatment.html#instrumental-variable">Instrumental Variable</a>. Hence, <span class="math inline">\(Z_t\)</span> and <span class="math inline">\(ν_t\)</span> can’t be identified without distributional assumptions</p>
<p><span class="citation">(<a href="#ref-Park_2012" role="doc-biblioref">Park and Gupta 2012</a>)</span> allows joint estimation of the continuous <span class="math inline">\(P_t\)</span> and <span class="math inline">\(\epsilon_t\)</span> using Gaussian copulas, where a copula is a function that maps several conditional distribution functions (CDF) into their joint CDF).</p>
<p>The underlying idea is that using information contained in the observed data, one selects marginal distributions for <span class="math inline">\(P_t\)</span> and <span class="math inline">\(\epsilon_t\)</span>. Then, the copula model constructs a flexible multivariate joint distribution that allows a wide range of correlations between the two marginals.</p>
<p>The method allows both continuous and discrete <span class="math inline">\(P_t\)</span>.</p>
<p>In the special case of <strong>one continuous</strong> <span class="math inline">\(P_t\)</span>, estimation is based on MLE<br />
Otherwise, based on Gaussian copulas, augmented OLS estimation is used.</p>
<p><strong>Assumptions</strong>:</p>
<ul>
<li><p>skewed <span class="math inline">\(P_t\)</span></p></li>
<li><p>the recovery of the correct parameter estimates</p></li>
<li><p><span class="math inline">\(\epsilon_t \sim\)</span> normal marginal distribution. The marginal distribution of <span class="math inline">\(P_t\)</span> is obtained using the <strong>Epanechnikov kernel density estimator</strong><br />
<span class="math display">\[
\hat{h}_p = \frac{1}{T . b} \sum_{t=1}^TK(\frac{p - P_t}{b})
\]</span> where</p></li>
<li><p><span class="math inline">\(P_t\)</span> = endogenous variables</p></li>
<li><p><span class="math inline">\(K(x) = 0.75(1-x^2)I(||x||\le 1)\)</span></p></li>
<li><p><span class="math inline">\(b=0.9T^{-1/5}\times min(s, IQR/1.34)\)</span> suggested by <span class="citation">(<a href="#ref-Silverman_1969" role="doc-biblioref">Silverman 1969</a>)</span></p>
<ul>
<li>IQR = interquartile range</li>
<li>s = sample standard deviation</li>
<li>T = n of time periods observed in the data</li>
</ul></li>
</ul>
<p>In augmented OLS and MLE, the inference procedure occurs in two stages:</p>
<p>(1): the empirical distribution of <span class="math inline">\(P_t\)</span> is computed<br />
(2) used in it constructing the likelihood function)<br />
Hence, the standard errors would not be correct.</p>
<p>So we use the sampling distributions (from bootstrapping) to get standard errors and the variance-covariance matrix. Since the distribution of the bootstraped parameters is highly skewed, we report the percentile confidence intervals is preferable.</p>
<div class="sourceCode" id="cb450"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb450-1"><a href="endogenous-treatment.html#cb450-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">110</span>)</span>
<span id="cb450-2"><a href="endogenous-treatment.html#cb450-2" aria-hidden="true" tabindex="-1"></a>m4.cc <span class="ot">&lt;-</span></span>
<span id="cb450-3"><a href="endogenous-treatment.html#cb450-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">copulaCorrection</span>(</span>
<span id="cb450-4"><a href="endogenous-treatment.html#cb450-4" aria-hidden="true" tabindex="-1"></a>                read <span class="sc">~</span> stratio <span class="sc">+</span> english <span class="sc">+</span> lunch <span class="sc">+</span> calworks <span class="sc">+</span></span>
<span id="cb450-5"><a href="endogenous-treatment.html#cb450-5" aria-hidden="true" tabindex="-1"></a>                        grades <span class="sc">+</span> income <span class="sc">+</span> county <span class="sc">|</span> <span class="fu">continuous</span>(stratio),</span>
<span id="cb450-6"><a href="endogenous-treatment.html#cb450-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> school,</span>
<span id="cb450-7"><a href="endogenous-treatment.html#cb450-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">optimx.args =</span> <span class="fu">list</span>(<span class="at">method =</span> <span class="fu">c</span>(<span class="st">&quot;Nelder-Mead&quot;</span>), <span class="at">itnmax =</span> <span class="dv">60000</span>),</span>
<span id="cb450-8"><a href="endogenous-treatment.html#cb450-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">num.boots =</span> <span class="dv">2</span>,</span>
<span id="cb450-9"><a href="endogenous-treatment.html#cb450-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">verbose =</span> <span class="cn">FALSE</span></span>
<span id="cb450-10"><a href="endogenous-treatment.html#cb450-10" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb450-11"><a href="endogenous-treatment.html#cb450-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m4.cc)<span class="sc">$</span>coefficients[<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>, ]</span>
<span id="cb450-12"><a href="endogenous-treatment.html#cb450-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Point Estimate   Boots SE Lower Boots CI (95%) Upper Boots CI (95%)</span></span>
<span id="cb450-13"><a href="endogenous-treatment.html#cb450-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)   683.06900891 2.80554212                   NA                   NA</span></span>
<span id="cb450-14"><a href="endogenous-treatment.html#cb450-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; stratio        -0.32434608 0.02075999                   NA                   NA</span></span>
<span id="cb450-15"><a href="endogenous-treatment.html#cb450-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; english        -0.21576110 0.01450666                   NA                   NA</span></span>
<span id="cb450-16"><a href="endogenous-treatment.html#cb450-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lunch          -0.37087664 0.01902052                   NA                   NA</span></span>
<span id="cb450-17"><a href="endogenous-treatment.html#cb450-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; calworks       -0.05569058 0.02076781                   NA                   NA</span></span>
<span id="cb450-18"><a href="endogenous-treatment.html#cb450-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; gradesKK-08    -1.92286128 0.25684614                   NA                   NA</span></span>
<span id="cb450-19"><a href="endogenous-treatment.html#cb450-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; income          0.73595353 0.04725700                   NA                   NA</span></span></code></pre></div>
<p>we run this model with only one endogenous continuous regressor (<code>stratio</code>). Sometimes, the code will not converge, in which case you can use different</p>
<ul>
<li>optimization algorithm</li>
<li>starting values</li>
<li>maximum number of iterations</li>
</ul>
</div>
<div id="higher-moments-method" class="section level5" number="28.3.2.1.3">
<h5><span class="header-section-number">28.3.2.1.3</span> Higher Moments Method</h5>
<p>suggested by <span class="citation">(<a href="#ref-Lewbel_1997" role="doc-biblioref">Lewbel 1997</a>)</span> to identify <span class="math inline">\(\epsilon_t\)</span> caused by <strong>measurement error</strong>.</p>
<p>Identification is achieved by using third moments of the data, with no restrictions on the distribution of <span class="math inline">\(\epsilon_t\)</span><br />
The following instruments can be used with 2SLS estimation to obtain consistent estimates:</p>
<p><span class="math display">\[
\begin{aligned}
q_{1t} &amp;=  (G_t - \bar{G}) \\
q_{2t} &amp;=  (G_t - \bar{G})(P_t - \bar{P}) \\
q_{3t} &amp;=   (G_t - \bar{G})(Y_t - \bar{Y})\\
q_{4t} &amp;=  (Y_t - \bar{Y})(P_t - \bar{P}) \\
q_{5t} &amp;=  (P_t - \bar{P})^2 \\
q_{6t} &amp;=  (Y_t - \bar{Y})^2 \\
\end{aligned}
\]</span></p>
<p>where</p>
<ul>
<li><span class="math inline">\(G_t = G(X_t)\)</span> for any given function G that has finite third own and cross moments</li>
<li>X = exogenous variable</li>
</ul>
<p><span class="math inline">\(q_{5t}, q_{6t}\)</span> can be used only when the measurement and <span class="math inline">\(\epsilon_t\)</span> are symmetrically distributed. The rest of the instruments does not require any distributional assumptions for <span class="math inline">\(\epsilon_t\)</span>.</p>
<p>Since the regressors <span class="math inline">\(G(X) = X\)</span> are included as instruments, <span class="math inline">\(G(X)\)</span> can’t be a linear function of X in <span class="math inline">\(q_{1t}\)</span></p>
<p>Since this method has very strong assumptions, <a href="endogenous-treatment.html#higher-moments-method">Higher Moments Method</a> should only be used in case of overidentification</p>
<div class="sourceCode" id="cb451"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb451-1"><a href="endogenous-treatment.html#cb451-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">111</span>)</span>
<span id="cb451-2"><a href="endogenous-treatment.html#cb451-2" aria-hidden="true" tabindex="-1"></a>m5.hetEr <span class="ot">&lt;-</span></span>
<span id="cb451-3"><a href="endogenous-treatment.html#cb451-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">hetErrorsIV</span>(</span>
<span id="cb451-4"><a href="endogenous-treatment.html#cb451-4" aria-hidden="true" tabindex="-1"></a>                read <span class="sc">~</span> stratio <span class="sc">+</span> english <span class="sc">+</span> lunch <span class="sc">+</span> calworks <span class="sc">+</span> income <span class="sc">+</span></span>
<span id="cb451-5"><a href="endogenous-treatment.html#cb451-5" aria-hidden="true" tabindex="-1"></a>                        grades <span class="sc">+</span> county <span class="sc">|</span> stratio <span class="sc">|</span> <span class="fu">IIV</span>(income, english),</span>
<span id="cb451-6"><a href="endogenous-treatment.html#cb451-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> school</span>
<span id="cb451-7"><a href="endogenous-treatment.html#cb451-7" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb451-8"><a href="endogenous-treatment.html#cb451-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m5.hetEr)<span class="sc">$</span>coefficients[<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>, ]</span>
<span id="cb451-9"><a href="endogenous-treatment.html#cb451-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                 Estimate  Std. Error    t value     Pr(&gt;|t|)</span></span>
<span id="cb451-10"><a href="endogenous-treatment.html#cb451-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept) 662.78791557 27.90173069 23.7543657 2.380436e-76</span></span>
<span id="cb451-11"><a href="endogenous-treatment.html#cb451-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; stratio       0.71480686  1.31077325  0.5453322 5.858545e-01</span></span>
<span id="cb451-12"><a href="endogenous-treatment.html#cb451-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; english      -0.19522271  0.04057527 -4.8113717 2.188618e-06</span></span>
<span id="cb451-13"><a href="endogenous-treatment.html#cb451-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lunch        -0.37834232  0.03927793 -9.6324402 9.760809e-20</span></span>
<span id="cb451-14"><a href="endogenous-treatment.html#cb451-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; calworks     -0.05665126  0.06302095 -0.8989273 3.692776e-01</span></span>
<span id="cb451-15"><a href="endogenous-treatment.html#cb451-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; income        0.82693755  0.17236557  4.7975797 2.335271e-06</span></span>
<span id="cb451-16"><a href="endogenous-treatment.html#cb451-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; gradesKK-08  -1.93795843  1.38723186 -1.3969968 1.632541e-01</span></span></code></pre></div>
<p>recommend using this approach to create additional instruments to use with external ones for better efficiency.</p>
</div>
<div id="heteroskedastic-error-approach" class="section level5" number="28.3.2.1.4">
<h5><span class="header-section-number">28.3.2.1.4</span> Heteroskedastic Error Approach</h5>
<ul>
<li>using means of variables that are uncorrelated with the product of heteroskedastic errors to identify structural parameters.</li>
<li>This method can be use either when you don’t have external instruments or you want to use additional instruments to improve the efficiency of the IV estimator <span class="citation">(<a href="#ref-Lewbel_2012" role="doc-biblioref">Lewbel 2012</a>)</span></li>
<li>The instruments are constructed as simple functions of data</li>
<li>Model’s assumptions:</li>
</ul>
<p><span class="math display">\[
E(X \epsilon) = 0 \\
E(X v ) = 0 \\
cov(Z, \epsilon v) = 0  \\
cov(Z, v^2) \neq 0 \text{  (for identification)}
\]</span></p>
<p>Structural parameters are identified by 2SLS regression of Y on X and P, using X and [Z − E(Z)]ν as instruments.</p>
<p><span class="math display">\[
\text{instrument&#39;s strength} \propto cov((Z-\bar{Z})v,v)
\]</span></p>
<p>where <span class="math inline">\(cov((Z-\bar{Z})v,v)\)</span> is the degree of heteroskedasticity of ν with respect to Z <span class="citation">(<a href="#ref-Lewbel_2012" role="doc-biblioref">Lewbel 2012</a>)</span>, which can be empirically tested.</p>
<p>If it is zero or close to zero (i.e.,the instrument is weak), you might have imprecise estimates, with large standard errors.</p>
<ul>
<li>Under homoskedasticity, the parameters of the model are unidentified.</li>
<li>Under heteroskedasticity related to at least some elements of X, the parameters of the model are identified.</li>
</ul>
</div>
</div>
<div id="hierarchical-data" class="section level4" number="28.3.2.2">
<h4><span class="header-section-number">28.3.2.2</span> Hierarchical Data</h4>
<p>Multiple independent assumptions involving various random components at different levels mean that any moderate correlation between some predictors and a random component or error term can result in a significant bias of the coefficients and of the variance components. <span class="citation">(<a href="#ref-Kim_2007" role="doc-biblioref">J.-S. Kim and Frees 2007</a>)</span> proposed a generalized method of moments which uses both, the between and within variations of the exogenous variables, but only assumes the within variation of the variables to be endogenous.</p>
<p><strong>Assumptions</strong></p>
<ul>
<li>the errors at each level <span class="math inline">\(\sim iid N\)</span></li>
<li>the slope variables are exogenous</li>
<li>the level-1 <span class="math inline">\(\epsilon \perp X, P\)</span>. If this is not the case, additional, external instruments are necessary</li>
</ul>
<p><strong>Hierarchical Model</strong></p>
<p><span class="math display">\[
\begin{aligned}
Y_{cst} &amp;= Z_{cst}^1 \beta_{cs}^1 + X_{cst}^1 \beta_1 + \epsilon_{cst}^1 \\
\beta^1_{cs} &amp;= Z_{cs}^2 \beta_{c}^2 + X_{cst}^2 \beta_2 + \epsilon_{cst}^2 \\
\beta^2_{c} &amp;= X^3_c \beta_3 + \epsilon_c^3
\end{aligned}
\]</span></p>
<p>Bias could stem from:</p>
<ul>
<li>errors at the higher two levels (<span class="math inline">\(\epsilon_c^3,\epsilon_{cst}^2\)</span>) are correlated with some of the regressors</li>
<li>only third level errors (<span class="math inline">\(\epsilon_c^3\)</span>) are correlated with some of the regressors</li>
</ul>
<p><span class="citation">(<a href="#ref-Kim_2007" role="doc-biblioref">J.-S. Kim and Frees 2007</a>)</span> proposed</p>
<ul>
<li>When all variables are assumed exogenous, the proposed estimator equals the random effects estimator</li>
<li>When all variables are assumed endogenous, it equals the fixed effects estimator</li>
<li>also use omitted variable test (based on the Hausman-test <span class="citation">(<a href="#ref-Hausman_1978" role="doc-biblioref">J. A. Hausman 1978</a>)</span> for panel data), which allows the comparison of a robust estimator and an estimator that is efficient under the null hypothesis of no omitted variables or the comparison of two robust estimators at different levels.</li>
</ul>
<div class="sourceCode" id="cb452"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb452-1"><a href="endogenous-treatment.html#cb452-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">113</span>)</span>
<span id="cb452-2"><a href="endogenous-treatment.html#cb452-2" aria-hidden="true" tabindex="-1"></a>school<span class="sc">$</span>gr08 <span class="ot">&lt;-</span> school<span class="sc">$</span>grades <span class="sc">==</span> <span class="st">&quot;KK-06&quot;</span></span>
<span id="cb452-3"><a href="endogenous-treatment.html#cb452-3" aria-hidden="true" tabindex="-1"></a>m7.multilevel <span class="ot">&lt;-</span></span>
<span id="cb452-4"><a href="endogenous-treatment.html#cb452-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">multilevelIV</span>(read <span class="sc">~</span> stratio <span class="sc">+</span> english <span class="sc">+</span> lunch <span class="sc">+</span> income <span class="sc">+</span> gr08 <span class="sc">+</span></span>
<span id="cb452-5"><a href="endogenous-treatment.html#cb452-5" aria-hidden="true" tabindex="-1"></a>                             calworks <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> county) <span class="sc">|</span> <span class="fu">endo</span>(stratio),</span>
<span id="cb452-6"><a href="endogenous-treatment.html#cb452-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">data =</span> school)</span>
<span id="cb452-7"><a href="endogenous-treatment.html#cb452-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m7.multilevel)<span class="sc">$</span>coefficients[<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>, ]</span>
<span id="cb452-8"><a href="endogenous-treatment.html#cb452-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                Estimate Std. Error     z-score     Pr(&gt;|z|)</span></span>
<span id="cb452-9"><a href="endogenous-treatment.html#cb452-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept) 675.8228656 5.58008680 121.1133248 0.000000e+00</span></span>
<span id="cb452-10"><a href="endogenous-treatment.html#cb452-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; stratio      -0.4956054 0.23922638  -2.0717005 3.829339e-02</span></span>
<span id="cb452-11"><a href="endogenous-treatment.html#cb452-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; english      -0.2599777 0.03413530  -7.6160948 2.614656e-14</span></span>
<span id="cb452-12"><a href="endogenous-treatment.html#cb452-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lunch        -0.3692954 0.03560210 -10.3728537 3.295342e-25</span></span>
<span id="cb452-13"><a href="endogenous-treatment.html#cb452-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; income        0.6723141 0.08862012   7.5864728 3.287314e-14</span></span>
<span id="cb452-14"><a href="endogenous-treatment.html#cb452-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; gr08TRUE      2.1590333 1.28167222   1.6845440 9.207658e-02</span></span>
<span id="cb452-15"><a href="endogenous-treatment.html#cb452-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; calworks     -0.0570633 0.05711701  -0.9990596 3.177658e-01</span></span></code></pre></div>
<p>Another example using simulated data</p>
<ul>
<li>level-1 regressors: <span class="math inline">\(X_{11}, X_{12}, X_{13}, X_{14}, X_{15}\)</span>, where <span class="math inline">\(X_{15}\)</span> is correlated with the level-2 error (i.e., endogenous).<br />
</li>
<li>level-2 regressors: <span class="math inline">\(X_{21}, X_{22}, X_{23}, X_{24}\)</span><br />
</li>
<li>level-3 regressors: <span class="math inline">\(X_{31}, X_{32}, X_{33}\)</span></li>
</ul>
<p>We estimate a three-level model with X15 assumed endogenous. Having a three-level hierarchy, <code>multilevelIV()</code> returns five estimators, from the most robust to omitted variables (FE_L2), to the most efficient (REF) (i.e. lowest mean squared error).</p>
<ul>
<li>The random effects estimator (REF) is efficient assuming no omitted variables</li>
<li>The fixed effects estimator (FE) is unbiased and asymptotically normal even in the presence of omitted variables.</li>
<li>Because of the efficiency, the random effects estimator is preferable if you think there is no omitted. variables</li>
<li>The robust estimator would be preferable if you think there is omitted variables.</li>
</ul>
<div class="sourceCode" id="cb453"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb453-1"><a href="endogenous-treatment.html#cb453-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(dataMultilevelIV)</span>
<span id="cb453-2"><a href="endogenous-treatment.html#cb453-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">114</span>)</span>
<span id="cb453-3"><a href="endogenous-treatment.html#cb453-3" aria-hidden="true" tabindex="-1"></a>formula1 <span class="ot">&lt;-</span></span>
<span id="cb453-4"><a href="endogenous-treatment.html#cb453-4" aria-hidden="true" tabindex="-1"></a>        y <span class="sc">~</span> X11 <span class="sc">+</span> X12 <span class="sc">+</span> X13 <span class="sc">+</span> X14 <span class="sc">+</span> X15 <span class="sc">+</span> X21 <span class="sc">+</span> X22 <span class="sc">+</span> X23 <span class="sc">+</span> X24 <span class="sc">+</span></span>
<span id="cb453-5"><a href="endogenous-treatment.html#cb453-5" aria-hidden="true" tabindex="-1"></a>        X31 <span class="sc">+</span> X32 <span class="sc">+</span> X33 <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> CID) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> SID) <span class="sc">|</span> <span class="fu">endo</span>(X15)</span>
<span id="cb453-6"><a href="endogenous-treatment.html#cb453-6" aria-hidden="true" tabindex="-1"></a>m8.multilevel <span class="ot">&lt;-</span></span>
<span id="cb453-7"><a href="endogenous-treatment.html#cb453-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">multilevelIV</span>(<span class="at">formula =</span> formula1, <span class="at">data =</span> dataMultilevelIV)</span>
<span id="cb453-8"><a href="endogenous-treatment.html#cb453-8" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(m8.multilevel)</span>
<span id="cb453-9"><a href="endogenous-treatment.html#cb453-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                    REF      FE_L2      FE_L3     GMM_L2     GMM_L3</span></span>
<span id="cb453-10"><a href="endogenous-treatment.html#cb453-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept) 64.3168856  0.0000000  0.0000000 64.3485944 64.3168868</span></span>
<span id="cb453-11"><a href="endogenous-treatment.html#cb453-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X11          3.0213405  3.0459605  3.0214255  3.0146686  3.0213403</span></span>
<span id="cb453-12"><a href="endogenous-treatment.html#cb453-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X12          8.9522160  8.9839088  8.9524723  8.9747533  8.9522169</span></span>
<span id="cb453-13"><a href="endogenous-treatment.html#cb453-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X13         -2.0194178 -2.0145054 -2.0193321 -2.0021426 -2.0194171</span></span>
<span id="cb453-14"><a href="endogenous-treatment.html#cb453-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X14          1.9651420  1.9791437  1.9648317  1.9658681  1.9651421</span></span>
<span id="cb453-15"><a href="endogenous-treatment.html#cb453-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X15         -0.5647915 -0.9777361 -0.5647621 -0.9750309 -0.5648070</span></span>
<span id="cb453-16"><a href="endogenous-treatment.html#cb453-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X21         -2.3316225  0.0000000 -2.2845297 -2.3052516 -2.3316215</span></span>
<span id="cb453-17"><a href="endogenous-treatment.html#cb453-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X22         -3.9564944  0.0000000 -3.9553644 -4.0130975 -3.9564966</span></span>
<span id="cb453-18"><a href="endogenous-treatment.html#cb453-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X23         -2.9779887  0.0000000 -2.9756848 -2.9488487 -2.9779876</span></span>
<span id="cb453-19"><a href="endogenous-treatment.html#cb453-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X24          4.9078293  0.0000000  4.9084694  4.7933756  4.9078250</span></span>
<span id="cb453-20"><a href="endogenous-treatment.html#cb453-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X31          2.1142348  0.0000000  0.0000000  2.1164477  2.1142349</span></span>
<span id="cb453-21"><a href="endogenous-treatment.html#cb453-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X32          0.3934770  0.0000000  0.0000000  0.3799626  0.3934764</span></span>
<span id="cb453-22"><a href="endogenous-treatment.html#cb453-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X33          0.1082086  0.0000000  0.0000000  0.1108386  0.1082087</span></span></code></pre></div>
<div class="sourceCode" id="cb454"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb454-1"><a href="endogenous-treatment.html#cb454-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m8.multilevel, <span class="st">&quot;REF&quot;</span>)</span>
<span id="cb454-2"><a href="endogenous-treatment.html#cb454-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb454-3"><a href="endogenous-treatment.html#cb454-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb454-4"><a href="endogenous-treatment.html#cb454-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; multilevelIV(formula = formula1, data = dataMultilevelIV)</span></span>
<span id="cb454-5"><a href="endogenous-treatment.html#cb454-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb454-6"><a href="endogenous-treatment.html#cb454-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of levels: 3</span></span>
<span id="cb454-7"><a href="endogenous-treatment.html#cb454-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of observations: 2824</span></span>
<span id="cb454-8"><a href="endogenous-treatment.html#cb454-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of groups: L2(CID): 1368  L3(SID): 40</span></span>
<span id="cb454-9"><a href="endogenous-treatment.html#cb454-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb454-10"><a href="endogenous-treatment.html#cb454-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients for model REF:</span></span>
<span id="cb454-11"><a href="endogenous-treatment.html#cb454-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error z-score Pr(&gt;|z|)    </span></span>
<span id="cb454-12"><a href="endogenous-treatment.html#cb454-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept) 64.31689    7.87332   8.169 3.11e-16 ***</span></span>
<span id="cb454-13"><a href="endogenous-treatment.html#cb454-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X11          3.02134    0.02576 117.306  &lt; 2e-16 ***</span></span>
<span id="cb454-14"><a href="endogenous-treatment.html#cb454-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X12          8.95222    0.02572 348.131  &lt; 2e-16 ***</span></span>
<span id="cb454-15"><a href="endogenous-treatment.html#cb454-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X13         -2.01942    0.02409 -83.835  &lt; 2e-16 ***</span></span>
<span id="cb454-16"><a href="endogenous-treatment.html#cb454-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X14          1.96514    0.02521  77.937  &lt; 2e-16 ***</span></span>
<span id="cb454-17"><a href="endogenous-treatment.html#cb454-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X15         -0.56479    0.01950 -28.962  &lt; 2e-16 ***</span></span>
<span id="cb454-18"><a href="endogenous-treatment.html#cb454-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X21         -2.33162    0.16228 -14.368  &lt; 2e-16 ***</span></span>
<span id="cb454-19"><a href="endogenous-treatment.html#cb454-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X22         -3.95649    0.13119 -30.160  &lt; 2e-16 ***</span></span>
<span id="cb454-20"><a href="endogenous-treatment.html#cb454-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X23         -2.97799    0.06611 -45.044  &lt; 2e-16 ***</span></span>
<span id="cb454-21"><a href="endogenous-treatment.html#cb454-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X24          4.90783    0.19796  24.792  &lt; 2e-16 ***</span></span>
<span id="cb454-22"><a href="endogenous-treatment.html#cb454-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X31          2.11423    0.10433  20.264  &lt; 2e-16 ***</span></span>
<span id="cb454-23"><a href="endogenous-treatment.html#cb454-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X32          0.39348    0.30426   1.293   0.1959    </span></span>
<span id="cb454-24"><a href="endogenous-treatment.html#cb454-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X33          0.10821    0.05236   2.067   0.0388 *  </span></span>
<span id="cb454-25"><a href="endogenous-treatment.html#cb454-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb454-26"><a href="endogenous-treatment.html#cb454-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb454-27"><a href="endogenous-treatment.html#cb454-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb454-28"><a href="endogenous-treatment.html#cb454-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Omitted variable tests for model REF:</span></span>
<span id="cb454-29"><a href="endogenous-treatment.html#cb454-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;               df     Chisq  p-value    </span></span>
<span id="cb454-30"><a href="endogenous-treatment.html#cb454-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; GMM_L2_vs_REF  7     18.74 0.009040 ** </span></span>
<span id="cb454-31"><a href="endogenous-treatment.html#cb454-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; GMM_L3_vs_REF 13 -12872.98 1.000000    </span></span>
<span id="cb454-32"><a href="endogenous-treatment.html#cb454-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; FE_L2_vs_REF  13     39.99 0.000139 ***</span></span>
<span id="cb454-33"><a href="endogenous-treatment.html#cb454-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; FE_L3_vs_REF  13     39.99 0.000138 ***</span></span>
<span id="cb454-34"><a href="endogenous-treatment.html#cb454-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb454-35"><a href="endogenous-treatment.html#cb454-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>True <span class="math inline">\(\beta_{X_{15}} =-1\)</span>. We can see that some estimators are bias because <span class="math inline">\(X_{15}\)</span> is correlated with the level-two error, to which only FE_L2 and GMM_L2 are robust</p>
<p>To select the appropriate estimator, we use the omitted variable test.</p>
<p>In a three-level setting, we can have different estimator comparisons:</p>
<ul>
<li>Fixed effects vs. random effects estimators: Test for omitted level-two and level-three omitted effects, simultaneously, one compares FE_L2 to REF. But we will not know at which omitted variables exist.<br />
</li>
<li>Fixed effects vs. GMM estimators: Once the existence of omitted effects is established but not sure at which level, we test for level-2 omitted effects by comparing FE_L2 vs GMM_L3. If you reject the null, the omitted variables are at level-2 The same is accomplished by testing FE_L2 vs. GMM_L2, since the latter is consistent only if there are no omitted effects at level-2.<br />
</li>
<li>Fixed effects vs. fixed effects estimators: We can test for omitted level-2 effects, while allowing for omitted level-3 effects by comparing FE_L2 vs. FE_L3 since FE_L2 is robust against both level-2 and level-3 omitted effects while FE_L3 is only robust to level-3 omitted variables.</li>
</ul>
<p>Summary, use the omitted variable test comparing <code>REF vs. FE_L2</code> first.</p>
<ul>
<li><p>If the null hypothesis is rejected, then there are omitted variables either at level-2 or level-3</p></li>
<li><p>Next, test whether there are level-2 omitted effects, since testing for omitted level three effects relies on the assumption there are no level-two omitted effects. You can use any of these pair of comparisons:</p>
<ul>
<li><code>FE_L2 vs. FE_L3</code></li>
<li><code>FE_L2 vs. GMM_L2</code></li>
</ul></li>
<li><p>If no omitted variables at level-2 are found, test for omitted level-3 effects by comparing either</p>
<ul>
<li><code>FE_L3</code> vs. <code>GMM_L3</code></li>
<li><code>GMM_L2</code> vs. <code>GMM_L3</code></li>
</ul></li>
</ul>
<div class="sourceCode" id="cb455"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb455-1"><a href="endogenous-treatment.html#cb455-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m8.multilevel, <span class="st">&quot;REF&quot;</span>)</span>
<span id="cb455-2"><a href="endogenous-treatment.html#cb455-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb455-3"><a href="endogenous-treatment.html#cb455-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb455-4"><a href="endogenous-treatment.html#cb455-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; multilevelIV(formula = formula1, data = dataMultilevelIV)</span></span>
<span id="cb455-5"><a href="endogenous-treatment.html#cb455-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb455-6"><a href="endogenous-treatment.html#cb455-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of levels: 3</span></span>
<span id="cb455-7"><a href="endogenous-treatment.html#cb455-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of observations: 2824</span></span>
<span id="cb455-8"><a href="endogenous-treatment.html#cb455-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of groups: L2(CID): 1368  L3(SID): 40</span></span>
<span id="cb455-9"><a href="endogenous-treatment.html#cb455-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb455-10"><a href="endogenous-treatment.html#cb455-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients for model REF:</span></span>
<span id="cb455-11"><a href="endogenous-treatment.html#cb455-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error z-score Pr(&gt;|z|)    </span></span>
<span id="cb455-12"><a href="endogenous-treatment.html#cb455-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept) 64.31689    7.87332   8.169 3.11e-16 ***</span></span>
<span id="cb455-13"><a href="endogenous-treatment.html#cb455-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X11          3.02134    0.02576 117.306  &lt; 2e-16 ***</span></span>
<span id="cb455-14"><a href="endogenous-treatment.html#cb455-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X12          8.95222    0.02572 348.131  &lt; 2e-16 ***</span></span>
<span id="cb455-15"><a href="endogenous-treatment.html#cb455-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X13         -2.01942    0.02409 -83.835  &lt; 2e-16 ***</span></span>
<span id="cb455-16"><a href="endogenous-treatment.html#cb455-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X14          1.96514    0.02521  77.937  &lt; 2e-16 ***</span></span>
<span id="cb455-17"><a href="endogenous-treatment.html#cb455-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X15         -0.56479    0.01950 -28.962  &lt; 2e-16 ***</span></span>
<span id="cb455-18"><a href="endogenous-treatment.html#cb455-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X21         -2.33162    0.16228 -14.368  &lt; 2e-16 ***</span></span>
<span id="cb455-19"><a href="endogenous-treatment.html#cb455-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X22         -3.95649    0.13119 -30.160  &lt; 2e-16 ***</span></span>
<span id="cb455-20"><a href="endogenous-treatment.html#cb455-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X23         -2.97799    0.06611 -45.044  &lt; 2e-16 ***</span></span>
<span id="cb455-21"><a href="endogenous-treatment.html#cb455-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X24          4.90783    0.19796  24.792  &lt; 2e-16 ***</span></span>
<span id="cb455-22"><a href="endogenous-treatment.html#cb455-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X31          2.11423    0.10433  20.264  &lt; 2e-16 ***</span></span>
<span id="cb455-23"><a href="endogenous-treatment.html#cb455-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X32          0.39348    0.30426   1.293   0.1959    </span></span>
<span id="cb455-24"><a href="endogenous-treatment.html#cb455-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X33          0.10821    0.05236   2.067   0.0388 *  </span></span>
<span id="cb455-25"><a href="endogenous-treatment.html#cb455-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb455-26"><a href="endogenous-treatment.html#cb455-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb455-27"><a href="endogenous-treatment.html#cb455-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb455-28"><a href="endogenous-treatment.html#cb455-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Omitted variable tests for model REF:</span></span>
<span id="cb455-29"><a href="endogenous-treatment.html#cb455-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;               df     Chisq  p-value    </span></span>
<span id="cb455-30"><a href="endogenous-treatment.html#cb455-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; GMM_L2_vs_REF  7     18.74 0.009040 ** </span></span>
<span id="cb455-31"><a href="endogenous-treatment.html#cb455-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; GMM_L3_vs_REF 13 -12872.98 1.000000    </span></span>
<span id="cb455-32"><a href="endogenous-treatment.html#cb455-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; FE_L2_vs_REF  13     39.99 0.000139 ***</span></span>
<span id="cb455-33"><a href="endogenous-treatment.html#cb455-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; FE_L3_vs_REF  13     39.99 0.000138 ***</span></span>
<span id="cb455-34"><a href="endogenous-treatment.html#cb455-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb455-35"><a href="endogenous-treatment.html#cb455-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb455-36"><a href="endogenous-treatment.html#cb455-36" aria-hidden="true" tabindex="-1"></a><span class="co"># compare REF with all the other estimators. Testing REF (the most efficient estimator) against FE_L2 (the most robust estimator), equivalently we are testing simultaneously for level-2 and level-3 omitted effects. </span></span></code></pre></div>
<p>Since the null hypothesis is rejected (p = 0.000139), there is bias in the random effects estimator.</p>
<p>To test for level-2 omitted effects (regardless of level-3 omitted effects), we compare FE_L2 versus FE_L3</p>
<div class="sourceCode" id="cb456"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb456-1"><a href="endogenous-treatment.html#cb456-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m8.multilevel,<span class="st">&quot;FE_L2&quot;</span>)</span>
<span id="cb456-2"><a href="endogenous-treatment.html#cb456-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb456-3"><a href="endogenous-treatment.html#cb456-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb456-4"><a href="endogenous-treatment.html#cb456-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; multilevelIV(formula = formula1, data = dataMultilevelIV)</span></span>
<span id="cb456-5"><a href="endogenous-treatment.html#cb456-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb456-6"><a href="endogenous-treatment.html#cb456-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of levels: 3</span></span>
<span id="cb456-7"><a href="endogenous-treatment.html#cb456-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of observations: 2824</span></span>
<span id="cb456-8"><a href="endogenous-treatment.html#cb456-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of groups: L2(CID): 1368  L3(SID): 40</span></span>
<span id="cb456-9"><a href="endogenous-treatment.html#cb456-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb456-10"><a href="endogenous-treatment.html#cb456-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients for model FE_L2:</span></span>
<span id="cb456-11"><a href="endogenous-treatment.html#cb456-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;               Estimate Std. Error z-score Pr(&gt;|z|)    </span></span>
<span id="cb456-12"><a href="endogenous-treatment.html#cb456-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)  0.000e+00  4.275e-19    0.00        1    </span></span>
<span id="cb456-13"><a href="endogenous-treatment.html#cb456-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X11          3.046e+00  2.978e-02  102.30   &lt;2e-16 ***</span></span>
<span id="cb456-14"><a href="endogenous-treatment.html#cb456-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X12          8.984e+00  3.360e-02  267.41   &lt;2e-16 ***</span></span>
<span id="cb456-15"><a href="endogenous-treatment.html#cb456-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X13         -2.015e+00  3.107e-02  -64.83   &lt;2e-16 ***</span></span>
<span id="cb456-16"><a href="endogenous-treatment.html#cb456-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X14          1.979e+00  3.203e-02   61.80   &lt;2e-16 ***</span></span>
<span id="cb456-17"><a href="endogenous-treatment.html#cb456-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X15         -9.777e-01  3.364e-02  -29.06   &lt;2e-16 ***</span></span>
<span id="cb456-18"><a href="endogenous-treatment.html#cb456-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X21          0.000e+00  1.824e-18    0.00        1    </span></span>
<span id="cb456-19"><a href="endogenous-treatment.html#cb456-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X22          0.000e+00  1.303e-18    0.00        1    </span></span>
<span id="cb456-20"><a href="endogenous-treatment.html#cb456-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X23          0.000e+00  4.389e-18    0.00        1    </span></span>
<span id="cb456-21"><a href="endogenous-treatment.html#cb456-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X24          0.000e+00  1.724e-18    0.00        1    </span></span>
<span id="cb456-22"><a href="endogenous-treatment.html#cb456-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X31          0.000e+00  1.468e-17    0.00        1    </span></span>
<span id="cb456-23"><a href="endogenous-treatment.html#cb456-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X32          0.000e+00  8.265e-18    0.00        1    </span></span>
<span id="cb456-24"><a href="endogenous-treatment.html#cb456-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X33          0.000e+00  2.793e-17    0.00        1    </span></span>
<span id="cb456-25"><a href="endogenous-treatment.html#cb456-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb456-26"><a href="endogenous-treatment.html#cb456-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb456-27"><a href="endogenous-treatment.html#cb456-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb456-28"><a href="endogenous-treatment.html#cb456-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Omitted variable tests for model FE_L2:</span></span>
<span id="cb456-29"><a href="endogenous-treatment.html#cb456-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                 df Chisq  p-value    </span></span>
<span id="cb456-30"><a href="endogenous-treatment.html#cb456-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; FE_L2_vs_REF    13 39.99 0.000139 ***</span></span>
<span id="cb456-31"><a href="endogenous-treatment.html#cb456-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; FE_L2_vs_FE_L3   9 36.02 3.92e-05 ***</span></span>
<span id="cb456-32"><a href="endogenous-treatment.html#cb456-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; FE_L2_vs_GMM_L2 12 39.99 7.21e-05 ***</span></span>
<span id="cb456-33"><a href="endogenous-treatment.html#cb456-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; FE_L2_vs_GMM_L3 13 39.99 0.000139 ***</span></span>
<span id="cb456-34"><a href="endogenous-treatment.html#cb456-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb456-35"><a href="endogenous-treatment.html#cb456-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>The null hypothesis of no omitted level-2 effects is rejected (<span class="math inline">\(p = 3.92e − 05\)</span>). Hence, there are omitted effects at level-two. We should use FE_L2 which is consistent with the underlying data that we generated (level-2 error correlated with <span class="math inline">\(X_15\)</span>, which leads to biased FE_L3 coefficients.</p>
<p>The omitted variable test between FE_L2 and GMM_L2 should reject the null hypothesis of no omitted level-2 effects (p-value is 0).</p>
<p>If we assume an endogenous variable as exogenous, the RE and GMM estimators will be biased because of the wrong set of internal instrumental variables. To increase our confidence, we should compare the omitted variable tests when the variable is considered endogenous vs. exogenous to get a sense whether the variable is truly endogenous.</p>
</div>
</div>
<div id="proxy-variables" class="section level3" number="28.3.3">
<h3><span class="header-section-number">28.3.3</span> Proxy Variables</h3>
<ul>
<li><p>Can be in place of the omitted variable</p></li>
<li><p>will not be able to estimate the effect of the omitted variable</p></li>
<li><p>will be able to reduce some endogeneity caused bye the omitted variable</p></li>
<li><p>but it can have <a href="measurement-error.html#measurement-error">Measurement Error</a>. Hence, you have to be extremely careful when using proxies.</p></li>
</ul>
<p>Criteria for a proxy variable:</p>
<ol style="list-style-type: decimal">
<li>The proxy is correlated with the omitted variable.</li>
<li>Having the omitted variable in the regression will solve the problem of endogeneity</li>
<li>The variation of the omitted variable unexplained by the proxy is uncorrelated with all independent variables, including the proxy.</li>
</ol>
<p>IQ test can be a proxy for ability in the regression between wage explained education.</p>
<p>For the third requirement</p>
<p><span class="math display">\[
ability = \gamma_0 + \gamma_1 IQ + \epsilon
\]</span></p>
<p>where <span class="math inline">\(\epsilon\)</span> is uncorrelated with education and IQ test.</p>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-chetty2013" class="csl-entry">
Chetty, Raj, John Friedman, and Jonah Rockoff. 2013. <span>“Measuring the Impacts of Teachers i: Evaluating Bias in Teacher Value-Added Estimates,”</span> September. <a href="https://doi.org/10.3386/w19423">https://doi.org/10.3386/w19423</a>.
</div>
<div id="ref-Ebbes_2005" class="csl-entry">
Ebbes, Peter, Michel Wedel, Ulf B?ckenholt, and Ton Steerneman. 2005. <span>“Solving and Testing for Regressor-Error (in)dependence When No Instrumental Variables Are Available: With New Evidence for the Effect of Education on Income.”</span> <em>Quantitative Marketing and Economics</em> 3 (4): 365–92. <a href="https://doi.org/10.1007/s11129-005-1177-6">https://doi.org/10.1007/s11129-005-1177-6</a>.
</div>
<div id="ref-Hausman_1978" class="csl-entry">
Hausman, J. A. 1978. <span>“Specification Tests in Econometrics.”</span> <em>Econometrica</em> 46 (6): 1251. <a href="https://doi.org/10.2307/1913827">https://doi.org/10.2307/1913827</a>.
</div>
<div id="ref-Kim_2007" class="csl-entry">
Kim, Jee-Seon, and Edward W. Frees. 2007. <span>“Multilevel Modeling with Correlated Effects.”</span> <em>Psychometrika</em> 72 (4): 505–33. <a href="https://doi.org/10.1007/s11336-007-9008-1">https://doi.org/10.1007/s11336-007-9008-1</a>.
</div>
<div id="ref-lee2021valid" class="csl-entry">
Lee, David S, Justin McCrary, Marcelo J Moreira, and Jack R Porter. 2021. <span>“Valid t-Ratio Inference for IV.”</span>
</div>
<div id="ref-Lewbel_1997" class="csl-entry">
Lewbel, Arthur. 1997. <span>“Constructing Instruments for Regressions with Measurement Error When No Additional Data Are Available, with an Application to Patents and r<span>&amp;</span>d.”</span> <em>Econometrica</em> 65 (5): 1201. <a href="https://doi.org/10.2307/2171884">https://doi.org/10.2307/2171884</a>.
</div>
<div id="ref-Lewbel_2012" class="csl-entry">
———. 2012. <span>“Using Heteroscedasticity to Identify and Estimate Mismeasured and Endogenous Regressor Models.”</span> <em>Journal of Business <span>&amp;</span> Economic Statistics</em> 30 (1): 67–80. <a href="https://doi.org/10.1080/07350015.2012.643126">https://doi.org/10.1080/07350015.2012.643126</a>.
</div>
<div id="ref-Park_2012" class="csl-entry">
Park, Sungho, and Sachin Gupta. 2012. <span>“Handling Endogenous Regressors by Joint Estimation Using Copulas.”</span> <em>Marketing Science</em> 31 (4): 567–86. <a href="https://doi.org/10.1287/mksc.1120.0718">https://doi.org/10.1287/mksc.1120.0718</a>.
</div>
<div id="ref-reiss2011" class="csl-entry">
Reiss, Peter C. 2011. <span>“Structural Workshop Paper<span></span>Descriptive, Structural, and Experimental Empirical Methods in Marketing Research.”</span> <em>Marketing Science</em> 30 (6): 950–64. <a href="https://doi.org/10.1287/mksc.1110.0681">https://doi.org/10.1287/mksc.1110.0681</a>.
</div>
<div id="ref-rossi2014even" class="csl-entry">
Rossi, Peter E. 2014. <span>“Even the Rich Can Make Themselves Poor: A Critical Examination of IV Methods in Marketing Applications.”</span> <em>Marketing Science</em> 33 (5): 655–72.
</div>
<div id="ref-Silverman_1969" class="csl-entry">
Silverman, B. W. 1969. <em>Density Estimation for Statistics and Data Analysis</em>.
</div>
<div id="ref-stock2002survey" class="csl-entry">
Stock, James H, Jonathan H Wright, and Motohiro Yogo. 2002. <span>“A Survey of Weak Instruments and Weak Identification in Generalized Method of Moments.”</span> <em>Journal of Business &amp; Economic Statistics</em> 20 (4): 518–29.
</div>
<div id="ref-Stock_2005" class="csl-entry">
Stock, James H., and Motohiro Yogo. 2005. <span>“Testing for Weak Instruments in Linear <span>IV</span> Regression,”</span> June, 80–108. <a href="https://doi.org/10.1017/cbo9780511614491.006">https://doi.org/10.1017/cbo9780511614491.006</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="simultaneity.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="endogenous-sample-selection.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/mikenguyen13/data_analysis/edit/main/29-endogeneity.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/mikenguyen13/data_analysis/blob/main/29-endogeneity.Rmd",
"text": null
},
"download": ["data_analysis.pdf", "data_analysis.epub", "data_analysis.mobi"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true,
"sharing": {
"facebook": true,
"github": true,
"twitter": true,
"linkedin": true
},
"info": true,
"edit": "https://github.com/mikenguyen13/data_analysis/edit/main/%s"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
