<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>8.7 Internal instrumental variable | A Guide on Data Analysis</title>
  <meta name="description" content="This is a guide on how to conduct a data analysis routine" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="8.7 Internal instrumental variable | A Guide on Data Analysis" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a guide on how to conduct a data analysis routine" />
  <meta name="github-repo" content="mikenguyen13/data_analysis" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="8.7 Internal instrumental variable | A Guide on Data Analysis" />
  
  <meta name="twitter:description" content="This is a guide on how to conduct a data analysis routine" />
  

<meta name="author" content="Mike Nguyen" />


<meta name="date" content="2021-02-11" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="measurement-error.html"/>
<link rel="next" href="proxy-variables.html"/>
<script src="libs/jquery-3.5.0/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<script src="libs/proj4js-2.3.15/proj4.js"></script>
<link href="libs/highcharts-8.1.2/css/motion.css" rel="stylesheet" />
<script src="libs/highcharts-8.1.2/highcharts.js"></script>
<script src="libs/highcharts-8.1.2/highcharts-3d.js"></script>
<script src="libs/highcharts-8.1.2/highcharts-more.js"></script>
<script src="libs/highcharts-8.1.2/modules/stock.js"></script>
<script src="libs/highcharts-8.1.2/modules/map.js"></script>
<script src="libs/highcharts-8.1.2/modules/annotations.js"></script>
<script src="libs/highcharts-8.1.2/modules/data.js"></script>
<script src="libs/highcharts-8.1.2/modules/drilldown.js"></script>
<script src="libs/highcharts-8.1.2/modules/item-series.js"></script>
<script src="libs/highcharts-8.1.2/modules/offline-exporting.js"></script>
<script src="libs/highcharts-8.1.2/modules/overlapping-datalabels.js"></script>
<script src="libs/highcharts-8.1.2/modules/exporting.js"></script>
<script src="libs/highcharts-8.1.2/modules/export-data.js"></script>
<script src="libs/highcharts-8.1.2/modules/funnel.js"></script>
<script src="libs/highcharts-8.1.2/modules/heatmap.js"></script>
<script src="libs/highcharts-8.1.2/modules/treemap.js"></script>
<script src="libs/highcharts-8.1.2/modules/sankey.js"></script>
<script src="libs/highcharts-8.1.2/modules/dependency-wheel.js"></script>
<script src="libs/highcharts-8.1.2/modules/organization.js"></script>
<script src="libs/highcharts-8.1.2/modules/solid-gauge.js"></script>
<script src="libs/highcharts-8.1.2/modules/streamgraph.js"></script>
<script src="libs/highcharts-8.1.2/modules/sunburst.js"></script>
<script src="libs/highcharts-8.1.2/modules/vector.js"></script>
<script src="libs/highcharts-8.1.2/modules/wordcloud.js"></script>
<script src="libs/highcharts-8.1.2/modules/xrange.js"></script>
<script src="libs/highcharts-8.1.2/modules/tilemap.js"></script>
<script src="libs/highcharts-8.1.2/modules/venn.js"></script>
<script src="libs/highcharts-8.1.2/modules/gantt.js"></script>
<script src="libs/highcharts-8.1.2/modules/timeline.js"></script>
<script src="libs/highcharts-8.1.2/modules/parallel-coordinates.js"></script>
<script src="libs/highcharts-8.1.2/modules/bullet.js"></script>
<script src="libs/highcharts-8.1.2/modules/coloraxis.js"></script>
<script src="libs/highcharts-8.1.2/modules/dumbbell.js"></script>
<script src="libs/highcharts-8.1.2/modules/lollipop.js"></script>
<script src="libs/highcharts-8.1.2/modules/series-label.js"></script>
<script src="libs/highcharts-8.1.2/plugins/motion.js"></script>
<script src="libs/highcharts-8.1.2/custom/reset.js"></script>
<script src="libs/highcharts-8.1.2/modules/boost.js"></script>
<script src="libs/highchart-binding-0.8.2/highchart.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Guide on Data Analysis</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="prerequisites.html"><a href="prerequisites.html"><i class="fa fa-check"></i><b>2</b> Prerequisites</a><ul>
<li class="chapter" data-level="2.1" data-path="matrix-theory.html"><a href="matrix-theory.html"><i class="fa fa-check"></i><b>2.1</b> Matrix Theory</a><ul>
<li class="chapter" data-level="2.1.1" data-path="matrix-theory.html"><a href="matrix-theory.html#rank"><i class="fa fa-check"></i><b>2.1.1</b> Rank</a></li>
<li class="chapter" data-level="2.1.2" data-path="matrix-theory.html"><a href="matrix-theory.html#inverse"><i class="fa fa-check"></i><b>2.1.2</b> Inverse</a></li>
<li class="chapter" data-level="2.1.3" data-path="matrix-theory.html"><a href="matrix-theory.html#definiteness"><i class="fa fa-check"></i><b>2.1.3</b> Definiteness</a></li>
<li class="chapter" data-level="2.1.4" data-path="matrix-theory.html"><a href="matrix-theory.html#matrix-calculus"><i class="fa fa-check"></i><b>2.1.4</b> Matrix Calculus</a></li>
<li class="chapter" data-level="2.1.5" data-path="matrix-theory.html"><a href="matrix-theory.html#optimization"><i class="fa fa-check"></i><b>2.1.5</b> Optimization</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="probability-theory.html"><a href="probability-theory.html"><i class="fa fa-check"></i><b>2.2</b> Probability Theory</a><ul>
<li class="chapter" data-level="2.2.1" data-path="probability-theory.html"><a href="probability-theory.html#axiom-and-theorems-of-probability"><i class="fa fa-check"></i><b>2.2.1</b> Axiom and Theorems of Probability</a></li>
<li class="chapter" data-level="2.2.2" data-path="probability-theory.html"><a href="probability-theory.html#central-limit-theorem"><i class="fa fa-check"></i><b>2.2.2</b> Central Limit Theorem</a></li>
<li class="chapter" data-level="2.2.3" data-path="probability-theory.html"><a href="probability-theory.html#random-variable"><i class="fa fa-check"></i><b>2.2.3</b> Random variable</a></li>
<li class="chapter" data-level="2.2.4" data-path="probability-theory.html"><a href="probability-theory.html#moment-generating-function"><i class="fa fa-check"></i><b>2.2.4</b> Moment generating function</a></li>
<li class="chapter" data-level="2.2.5" data-path="probability-theory.html"><a href="probability-theory.html#moment"><i class="fa fa-check"></i><b>2.2.5</b> Moment</a></li>
<li class="chapter" data-level="2.2.6" data-path="probability-theory.html"><a href="probability-theory.html#distributions"><i class="fa fa-check"></i><b>2.2.6</b> Distributions</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="general-math.html"><a href="general-math.html"><i class="fa fa-check"></i><b>2.3</b> General Math</a><ul>
<li class="chapter" data-level="2.3.1" data-path="general-math.html"><a href="general-math.html#law-of-large-numbers"><i class="fa fa-check"></i><b>2.3.1</b> Law of large numbers</a></li>
<li class="chapter" data-level="2.3.2" data-path="general-math.html"><a href="general-math.html#law-of-iterated-expectation"><i class="fa fa-check"></i><b>2.3.2</b> Law of Iterated Expectation</a></li>
<li class="chapter" data-level="2.3.3" data-path="general-math.html"><a href="general-math.html#convergence"><i class="fa fa-check"></i><b>2.3.3</b> Convergence</a></li>
<li class="chapter" data-level="2.3.4" data-path="general-math.html"><a href="general-math.html#sufficient-statistics"><i class="fa fa-check"></i><b>2.3.4</b> Sufficient Statistics</a></li>
<li class="chapter" data-level="2.3.5" data-path="general-math.html"><a href="general-math.html#parameter-transformations"><i class="fa fa-check"></i><b>2.3.5</b> Parameter transformations</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="methods.html"><a href="methods.html"><i class="fa fa-check"></i><b>2.4</b> Methods</a></li>
<li class="chapter" data-level="2.5" data-path="data-manipulation.html"><a href="data-manipulation.html"><i class="fa fa-check"></i><b>2.5</b> Data Manipulation</a></li>
</ul></li>
<li class="part"><span><b>I BASIC</b></span></li>
<li class="chapter" data-level="3" data-path="descriptive-stat.html"><a href="descriptive-stat.html"><i class="fa fa-check"></i><b>3</b> Descriptive Statistics</a><ul>
<li class="chapter" data-level="3.1" data-path="numerical-measures.html"><a href="numerical-measures.html"><i class="fa fa-check"></i><b>3.1</b> Numerical Measures</a></li>
<li class="chapter" data-level="3.2" data-path="graphical-measures.html"><a href="graphical-measures.html"><i class="fa fa-check"></i><b>3.2</b> Graphical Measures</a><ul>
<li class="chapter" data-level="3.2.1" data-path="graphical-measures.html"><a href="graphical-measures.html#shape"><i class="fa fa-check"></i><b>3.2.1</b> Shape</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="normality-assessment.html"><a href="normality-assessment.html"><i class="fa fa-check"></i><b>3.3</b> Normality Assessment</a><ul>
<li class="chapter" data-level="3.3.1" data-path="normality-assessment.html"><a href="normality-assessment.html#graphical-assessment"><i class="fa fa-check"></i><b>3.3.1</b> Graphical Assessment</a></li>
<li class="chapter" data-level="3.3.2" data-path="normality-assessment.html"><a href="normality-assessment.html#summary-statistics"><i class="fa fa-check"></i><b>3.3.2</b> Summary Statistics</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="basic-statistical-inference.html"><a href="basic-statistical-inference.html"><i class="fa fa-check"></i><b>4</b> Basic Statistical Inference</a><ul>
<li class="chapter" data-level="4.1" data-path="one-sample-inference.html"><a href="one-sample-inference.html"><i class="fa fa-check"></i><b>4.1</b> One Sample Inference</a><ul>
<li class="chapter" data-level="4.1.1" data-path="one-sample-inference.html"><a href="one-sample-inference.html#the-mean"><i class="fa fa-check"></i><b>4.1.1</b> The Mean</a></li>
<li class="chapter" data-level="4.1.2" data-path="one-sample-inference.html"><a href="one-sample-inference.html#single-variance"><i class="fa fa-check"></i><b>4.1.2</b> Single Variance</a></li>
<li class="chapter" data-level="4.1.3" data-path="one-sample-inference.html"><a href="one-sample-inference.html#single-proportion-p"><i class="fa fa-check"></i><b>4.1.3</b> Single Proportion (p)</a></li>
<li class="chapter" data-level="4.1.4" data-path="one-sample-inference.html"><a href="one-sample-inference.html#power"><i class="fa fa-check"></i><b>4.1.4</b> Power</a></li>
<li class="chapter" data-level="4.1.5" data-path="one-sample-inference.html"><a href="one-sample-inference.html#sample-size"><i class="fa fa-check"></i><b>4.1.5</b> Sample Size</a></li>
<li class="chapter" data-level="4.1.6" data-path="one-sample-inference.html"><a href="one-sample-inference.html#note"><i class="fa fa-check"></i><b>4.1.6</b> Note</a></li>
<li class="chapter" data-level="4.1.7" data-path="one-sample-inference.html"><a href="one-sample-inference.html#one-sample-non-parametric-methods"><i class="fa fa-check"></i><b>4.1.7</b> One-sample Non-parametric Methods</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="two-sample-inference.html"><a href="two-sample-inference.html"><i class="fa fa-check"></i><b>4.2</b> Two Sample Inference</a><ul>
<li class="chapter" data-level="4.2.1" data-path="two-sample-inference.html"><a href="two-sample-inference.html#means"><i class="fa fa-check"></i><b>4.2.1</b> Means</a></li>
<li class="chapter" data-level="4.2.2" data-path="two-sample-inference.html"><a href="two-sample-inference.html#variances"><i class="fa fa-check"></i><b>4.2.2</b> Variances</a></li>
<li class="chapter" data-level="4.2.3" data-path="two-sample-inference.html"><a href="two-sample-inference.html#power-1"><i class="fa fa-check"></i><b>4.2.3</b> Power</a></li>
<li class="chapter" data-level="4.2.4" data-path="two-sample-inference.html"><a href="two-sample-inference.html#sample-size-1"><i class="fa fa-check"></i><b>4.2.4</b> Sample Size</a></li>
<li class="chapter" data-level="4.2.5" data-path="two-sample-inference.html"><a href="two-sample-inference.html#matched-pair-designs"><i class="fa fa-check"></i><b>4.2.5</b> Matched Pair Designs</a></li>
<li class="chapter" data-level="4.2.6" data-path="two-sample-inference.html"><a href="two-sample-inference.html#nonparametric-tests-for-two-samples"><i class="fa fa-check"></i><b>4.2.6</b> Nonparametric Tests for Two Samples</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="categorical-data-analysis.html"><a href="categorical-data-analysis.html"><i class="fa fa-check"></i><b>4.3</b> Categorical Data Analysis</a><ul>
<li class="chapter" data-level="4.3.1" data-path="categorical-data-analysis.html"><a href="categorical-data-analysis.html#inferences-for-small-samples"><i class="fa fa-check"></i><b>4.3.1</b> Inferences for Small Samples</a></li>
<li class="chapter" data-level="4.3.2" data-path="categorical-data-analysis.html"><a href="categorical-data-analysis.html#test-of-association"><i class="fa fa-check"></i><b>4.3.2</b> Test of Association</a></li>
<li class="chapter" data-level="4.3.3" data-path="categorical-data-analysis.html"><a href="categorical-data-analysis.html#ordinal-association"><i class="fa fa-check"></i><b>4.3.3</b> Ordinal Association</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II REGRESSION</b></span></li>
<li class="chapter" data-level="5" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i><b>5</b> Linear Regression</a><ul>
<li class="chapter" data-level="5.1" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html"><i class="fa fa-check"></i><b>5.1</b> Ordinary Least Squares</a><ul>
<li class="chapter" data-level="5.1.1" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#simple-regression-basic-model"><i class="fa fa-check"></i><b>5.1.1</b> Simple Regression (Basic Model)</a></li>
<li class="chapter" data-level="5.1.2" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#multiple-linear-regression"><i class="fa fa-check"></i><b>5.1.2</b> Multiple Linear Regression</a></li>
<li class="chapter" data-level="5.1.3" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#ols-assumptions"><i class="fa fa-check"></i><b>5.1.3</b> OLS Assumptions</a></li>
<li class="chapter" data-level="5.1.4" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#theorems"><i class="fa fa-check"></i><b>5.1.4</b> Theorems</a></li>
<li class="chapter" data-level="5.1.5" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#variable-selection"><i class="fa fa-check"></i><b>5.1.5</b> Variable Selection</a></li>
<li class="chapter" data-level="5.1.6" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#diagnostics-1"><i class="fa fa-check"></i><b>5.1.6</b> Diagnostics</a></li>
<li class="chapter" data-level="5.1.7" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#model-validation"><i class="fa fa-check"></i><b>5.1.7</b> Model Validation</a></li>
<li class="chapter" data-level="5.1.8" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#finite-sample-properties"><i class="fa fa-check"></i><b>5.1.8</b> Finite Sample Properties</a></li>
<li class="chapter" data-level="5.1.9" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#large-sample-properties"><i class="fa fa-check"></i><b>5.1.9</b> Large Sample Properties</a></li>
<li class="chapter" data-level="5.1.10" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#application"><i class="fa fa-check"></i><b>5.1.10</b> Application</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="feasible-generalized-least-squares.html"><a href="feasible-generalized-least-squares.html"><i class="fa fa-check"></i><b>5.2</b> Feasible Generalized Least Squares</a><ul>
<li class="chapter" data-level="5.2.1" data-path="feasible-generalized-least-squares.html"><a href="feasible-generalized-least-squares.html#heteroskedasticity"><i class="fa fa-check"></i><b>5.2.1</b> Heteroskedasticity</a></li>
<li class="chapter" data-level="5.2.2" data-path="feasible-generalized-least-squares.html"><a href="feasible-generalized-least-squares.html#serial-correlation"><i class="fa fa-check"></i><b>5.2.2</b> Serial Correlation</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="weighted-least-squares.html"><a href="weighted-least-squares.html"><i class="fa fa-check"></i><b>5.3</b> Weighted Least Squares</a></li>
<li class="chapter" data-level="5.4" data-path="generalized-least-squares.html"><a href="generalized-least-squares.html"><i class="fa fa-check"></i><b>5.4</b> Generalized Least Squares</a></li>
<li class="chapter" data-level="5.5" data-path="feasiable-prais-winsten.html"><a href="feasiable-prais-winsten.html"><i class="fa fa-check"></i><b>5.5</b> Feasiable Prais Winsten</a></li>
<li class="chapter" data-level="5.6" data-path="feasible-group-level-random-effects.html"><a href="feasible-group-level-random-effects.html"><i class="fa fa-check"></i><b>5.6</b> Feasible group level Random Effects</a></li>
<li class="chapter" data-level="5.7" data-path="ridge-regression.html"><a href="ridge-regression.html"><i class="fa fa-check"></i><b>5.7</b> Ridge Regression</a></li>
<li class="chapter" data-level="5.8" data-path="principal-component-regression.html"><a href="principal-component-regression.html"><i class="fa fa-check"></i><b>5.8</b> Principal Component Regression</a></li>
<li class="chapter" data-level="5.9" data-path="robust-regression.html"><a href="robust-regression.html"><i class="fa fa-check"></i><b>5.9</b> Robust Regression</a><ul>
<li class="chapter" data-level="5.9.1" data-path="robust-regression.html"><a href="robust-regression.html#least-absolute-residuals-lar-regression"><i class="fa fa-check"></i><b>5.9.1</b> Least Absolute Residuals (LAR) Regression</a></li>
<li class="chapter" data-level="5.9.2" data-path="robust-regression.html"><a href="robust-regression.html#least-median-of-squares-lms-regression"><i class="fa fa-check"></i><b>5.9.2</b> Least Median of Squares (LMS) Regression</a></li>
<li class="chapter" data-level="5.9.3" data-path="robust-regression.html"><a href="robust-regression.html#iteratively-reweighted-least-squares-irls-robust-regression"><i class="fa fa-check"></i><b>5.9.3</b> Iteratively Reweighted Least Squares (IRLS) Robust Regression</a></li>
</ul></li>
<li class="chapter" data-level="5.10" data-path="maximum-likelihood.html"><a href="maximum-likelihood.html"><i class="fa fa-check"></i><b>5.10</b> Maximum Likelihood</a><ul>
<li class="chapter" data-level="5.10.1" data-path="maximum-likelihood.html"><a href="maximum-likelihood.html#motivation-for-mle"><i class="fa fa-check"></i><b>5.10.1</b> Motivation for MLE</a></li>
<li class="chapter" data-level="5.10.2" data-path="maximum-likelihood.html"><a href="maximum-likelihood.html#assumption"><i class="fa fa-check"></i><b>5.10.2</b> Assumption</a></li>
<li class="chapter" data-level="5.10.3" data-path="maximum-likelihood.html"><a href="maximum-likelihood.html#properties"><i class="fa fa-check"></i><b>5.10.3</b> Properties</a></li>
<li class="chapter" data-level="5.10.4" data-path="maximum-likelihood.html"><a href="maximum-likelihood.html#application-1"><i class="fa fa-check"></i><b>5.10.4</b> Application</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="non-linear-regression.html"><a href="non-linear-regression.html"><i class="fa fa-check"></i><b>6</b> Non-linear Regression</a><ul>
<li class="chapter" data-level="6.1" data-path="inference-1.html"><a href="inference-1.html"><i class="fa fa-check"></i><b>6.1</b> Inference</a><ul>
<li class="chapter" data-level="6.1.1" data-path="inference-1.html"><a href="inference-1.html#linear-function-of-the-parameters"><i class="fa fa-check"></i><b>6.1.1</b> Linear Function of the Parameters</a></li>
<li class="chapter" data-level="6.1.2" data-path="inference-1.html"><a href="inference-1.html#nonlinear"><i class="fa fa-check"></i><b>6.1.2</b> Nonlinear</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="non-linear-least-squares.html"><a href="non-linear-least-squares.html"><i class="fa fa-check"></i><b>6.2</b> Non-linear Least Squares</a><ul>
<li class="chapter" data-level="6.2.1" data-path="non-linear-least-squares.html"><a href="non-linear-least-squares.html#alternative-of-gauss-newton-algorithm"><i class="fa fa-check"></i><b>6.2.1</b> Alternative of Gauss-Newton Algorithm</a></li>
<li class="chapter" data-level="6.2.2" data-path="non-linear-least-squares.html"><a href="non-linear-least-squares.html#practical-considerations"><i class="fa fa-check"></i><b>6.2.2</b> Practical Considerations</a></li>
<li class="chapter" data-level="6.2.3" data-path="non-linear-least-squares.html"><a href="non-linear-least-squares.html#modelestiamtion-adequcy"><i class="fa fa-check"></i><b>6.2.3</b> Model/Estiamtion Adequcy</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html"><i class="fa fa-check"></i><b>6.3</b> Generalized Linear Models</a><ul>
<li class="chapter" data-level="6.3.1" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#logistic-regression"><i class="fa fa-check"></i><b>6.3.1</b> Logistic Regression</a></li>
<li class="chapter" data-level="6.3.2" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#probit-regression"><i class="fa fa-check"></i><b>6.3.2</b> Probit Regression</a></li>
<li class="chapter" data-level="6.3.3" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#poisson-regression"><i class="fa fa-check"></i><b>6.3.3</b> Poisson Regression</a></li>
<li class="chapter" data-level="6.3.4" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#generalization"><i class="fa fa-check"></i><b>6.3.4</b> Generalization</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="genelized-method-of-moments.html"><a href="genelized-method-of-moments.html"><i class="fa fa-check"></i><b>6.4</b> Genelized Method of Moments</a></li>
<li class="chapter" data-level="6.5" data-path="minimum-distance.html"><a href="minimum-distance.html"><i class="fa fa-check"></i><b>6.5</b> Minimum Distance</a></li>
<li class="chapter" data-level="6.6" data-path="spline-regression.html"><a href="spline-regression.html"><i class="fa fa-check"></i><b>6.6</b> Spline Regression</a><ul>
<li class="chapter" data-level="6.6.1" data-path="spline-regression.html"><a href="spline-regression.html#regression-splines"><i class="fa fa-check"></i><b>6.6.1</b> Regression Splines</a></li>
<li class="chapter" data-level="6.6.2" data-path="spline-regression.html"><a href="spline-regression.html#natural-splines"><i class="fa fa-check"></i><b>6.6.2</b> Natural splines</a></li>
<li class="chapter" data-level="6.6.3" data-path="spline-regression.html"><a href="spline-regression.html#smoothing-spliness"><i class="fa fa-check"></i><b>6.6.3</b> Smoothing spliness</a></li>
<li class="chapter" data-level="6.6.4" data-path="spline-regression.html"><a href="spline-regression.html#application-2"><i class="fa fa-check"></i><b>6.6.4</b> Application</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="generalized-additive-models.html"><a href="generalized-additive-models.html"><i class="fa fa-check"></i><b>6.7</b> Generalized Additive Models</a></li>
<li class="chapter" data-level="6.8" data-path="quantile-regression.html"><a href="quantile-regression.html"><i class="fa fa-check"></i><b>6.8</b> Quantile Regression</a><ul>
<li class="chapter" data-level="6.8.1" data-path="quantile-regression.html"><a href="quantile-regression.html#application-3"><i class="fa fa-check"></i><b>6.8.1</b> Application</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="model-specification.html"><a href="model-specification.html"><i class="fa fa-check"></i><b>7</b> Model Specification</a><ul>
<li class="chapter" data-level="7.1" data-path="nested-model.html"><a href="nested-model.html"><i class="fa fa-check"></i><b>7.1</b> Nested Model</a><ul>
<li class="chapter" data-level="7.1.1" data-path="nested-model.html"><a href="nested-model.html#chow-test"><i class="fa fa-check"></i><b>7.1.1</b> Chow test</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="non-nested-model.html"><a href="non-nested-model.html"><i class="fa fa-check"></i><b>7.2</b> Non-Nested Model</a><ul>
<li class="chapter" data-level="7.2.1" data-path="non-nested-model.html"><a href="non-nested-model.html#davidson-mackinnon-test"><i class="fa fa-check"></i><b>7.2.1</b> Davidson-Mackinnon test</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="heteroskedasticity-1.html"><a href="heteroskedasticity-1.html"><i class="fa fa-check"></i><b>7.3</b> Heteroskedasticity</a><ul>
<li class="chapter" data-level="7.3.1" data-path="heteroskedasticity-1.html"><a href="heteroskedasticity-1.html#breusch-pagan-test"><i class="fa fa-check"></i><b>7.3.1</b> Breusch-Pagan test</a></li>
<li class="chapter" data-level="7.3.2" data-path="heteroskedasticity-1.html"><a href="heteroskedasticity-1.html#white-test"><i class="fa fa-check"></i><b>7.3.2</b> White test</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="endogeneity.html"><a href="endogeneity.html"><i class="fa fa-check"></i><b>8</b> Endogeneity</a><ul>
<li class="chapter" data-level="8.1" data-path="instrumental-variable.html"><a href="instrumental-variable.html"><i class="fa fa-check"></i><b>8.1</b> Instrumental Variable</a></li>
<li class="chapter" data-level="8.2" data-path="testing-assumption.html"><a href="testing-assumption.html"><i class="fa fa-check"></i><b>8.2</b> Testing Assumption</a><ul>
<li class="chapter" data-level="8.2.1" data-path="testing-assumption.html"><a href="testing-assumption.html#test-of-endogeneity"><i class="fa fa-check"></i><b>8.2.1</b> Test of Endogeneity</a></li>
<li class="chapter" data-level="8.2.2" data-path="testing-assumption.html"><a href="testing-assumption.html#testing-instruments-assumptions"><i class="fa fa-check"></i><b>8.2.2</b> Testing Instrument’s assumptions</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="omitted-variables-bias.html"><a href="omitted-variables-bias.html"><i class="fa fa-check"></i><b>8.3</b> Omitted Variables Bias</a></li>
<li class="chapter" data-level="8.4" data-path="feedback-effect-simultaneity.html"><a href="feedback-effect-simultaneity.html"><i class="fa fa-check"></i><b>8.4</b> Feedback Effect (Simultaneity)</a></li>
<li class="chapter" data-level="8.5" data-path="endogenous-sample-design-sample-selection.html"><a href="endogenous-sample-design-sample-selection.html"><i class="fa fa-check"></i><b>8.5</b> Endogenous sample design (sample selection)</a></li>
<li class="chapter" data-level="8.6" data-path="measurement-error.html"><a href="measurement-error.html"><i class="fa fa-check"></i><b>8.6</b> Measurement Error</a></li>
<li class="chapter" data-level="8.7" data-path="internal-instrumental-variable.html"><a href="internal-instrumental-variable.html"><i class="fa fa-check"></i><b>8.7</b> Internal instrumental variable</a><ul>
<li class="chapter" data-level="8.7.1" data-path="internal-instrumental-variable.html"><a href="internal-instrumental-variable.html#non-hierarchical-data-cross-classified"><i class="fa fa-check"></i><b>8.7.1</b> Non-hierarchical Data (Cross-classified)</a></li>
<li class="chapter" data-level="8.7.2" data-path="internal-instrumental-variable.html"><a href="internal-instrumental-variable.html#hierarchical-data"><i class="fa fa-check"></i><b>8.7.2</b> Hierarchical Data</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="proxy-variables.html"><a href="proxy-variables.html"><i class="fa fa-check"></i><b>8.8</b> Proxy Variables</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>9</b> Data</a><ul>
<li class="chapter" data-level="9.1" data-path="cross-sectional.html"><a href="cross-sectional.html"><i class="fa fa-check"></i><b>9.1</b> Cross-Sectional</a></li>
<li class="chapter" data-level="9.2" data-path="time-series-1.html"><a href="time-series-1.html"><i class="fa fa-check"></i><b>9.2</b> Time Series</a><ul>
<li class="chapter" data-level="9.2.1" data-path="time-series-1.html"><a href="time-series-1.html#deterministic-time-trend"><i class="fa fa-check"></i><b>9.2.1</b> Deterministic Time trend</a></li>
<li class="chapter" data-level="9.2.2" data-path="time-series-1.html"><a href="time-series-1.html#feedback-effect"><i class="fa fa-check"></i><b>9.2.2</b> Feedback Effect</a></li>
<li class="chapter" data-level="9.2.3" data-path="time-series-1.html"><a href="time-series-1.html#dynamic-specification"><i class="fa fa-check"></i><b>9.2.3</b> Dynamic Specification</a></li>
<li class="chapter" data-level="9.2.4" data-path="time-series-1.html"><a href="time-series-1.html#dynamically-complete"><i class="fa fa-check"></i><b>9.2.4</b> Dynamically Complete</a></li>
<li class="chapter" data-level="9.2.5" data-path="time-series-1.html"><a href="time-series-1.html#highly-persistent-data"><i class="fa fa-check"></i><b>9.2.5</b> Highly Persistent Data</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="repeated-cross-sections.html"><a href="repeated-cross-sections.html"><i class="fa fa-check"></i><b>9.3</b> Repeated Cross Sections</a><ul>
<li class="chapter" data-level="9.3.1" data-path="repeated-cross-sections.html"><a href="repeated-cross-sections.html#pooled-cross-section"><i class="fa fa-check"></i><b>9.3.1</b> Pooled Cross Section</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="panel-data.html"><a href="panel-data.html"><i class="fa fa-check"></i><b>9.4</b> Panel Data</a><ul>
<li class="chapter" data-level="9.4.1" data-path="panel-data.html"><a href="panel-data.html#pooled-ols-esimator"><i class="fa fa-check"></i><b>9.4.1</b> Pooled OLS Esimator</a></li>
<li class="chapter" data-level="9.4.2" data-path="panel-data.html"><a href="panel-data.html#individual-specific-effects-model"><i class="fa fa-check"></i><b>9.4.2</b> Individual-specific effects model</a></li>
<li class="chapter" data-level="9.4.3" data-path="panel-data.html"><a href="panel-data.html#tests-for-assumptions"><i class="fa fa-check"></i><b>9.4.3</b> Tests for Assumptions</a></li>
<li class="chapter" data-level="9.4.4" data-path="panel-data.html"><a href="panel-data.html#model-selection"><i class="fa fa-check"></i><b>9.4.4</b> Model Selection</a></li>
<li class="chapter" data-level="9.4.5" data-path="panel-data.html"><a href="panel-data.html#summary-1"><i class="fa fa-check"></i><b>9.4.5</b> Summary</a></li>
<li class="chapter" data-level="9.4.6" data-path="panel-data.html"><a href="panel-data.html#application-4"><i class="fa fa-check"></i><b>9.4.6</b> Application</a></li>
<li class="chapter" data-level="9.4.7" data-path="panel-data.html"><a href="panel-data.html#other-estimators"><i class="fa fa-check"></i><b>9.4.7</b> Other Estimators</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html"><i class="fa fa-check"></i><b>10</b> Hypothesis Testing</a><ul>
<li class="chapter" data-level="10.1" data-path="types-of-hypothesis-testing.html"><a href="types-of-hypothesis-testing.html"><i class="fa fa-check"></i><b>10.1</b> Types of hypothesis testing</a></li>
<li class="chapter" data-level="10.2" data-path="wald-test.html"><a href="wald-test.html"><i class="fa fa-check"></i><b>10.2</b> Wald test</a><ul>
<li class="chapter" data-level="10.2.1" data-path="wald-test.html"><a href="wald-test.html#multiple-hypothesis"><i class="fa fa-check"></i><b>10.2.1</b> Multiple Hypothesis</a></li>
<li class="chapter" data-level="10.2.2" data-path="wald-test.html"><a href="wald-test.html#linear-combination"><i class="fa fa-check"></i><b>10.2.2</b> Linear Combination</a></li>
<li class="chapter" data-level="10.2.3" data-path="wald-test.html"><a href="wald-test.html#application-5"><i class="fa fa-check"></i><b>10.2.3</b> Application</a></li>
<li class="chapter" data-level="10.2.4" data-path="wald-test.html"><a href="wald-test.html#nonlinear-1"><i class="fa fa-check"></i><b>10.2.4</b> Nonlinear</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="the-likelihood-ratio-test.html"><a href="the-likelihood-ratio-test.html"><i class="fa fa-check"></i><b>10.3</b> The likelihood ratio test</a></li>
<li class="chapter" data-level="10.4" data-path="lagrange-multiplier-score.html"><a href="lagrange-multiplier-score.html"><i class="fa fa-check"></i><b>10.4</b> Lagrange Multiplier (Score)</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="imputation-missing-data.html"><a href="imputation-missing-data.html"><i class="fa fa-check"></i><b>11</b> Imputation (Missing Data)</a><ul>
<li class="chapter" data-level="11.1" data-path="assumptions-1.html"><a href="assumptions-1.html"><i class="fa fa-check"></i><b>11.1</b> Assumptions</a><ul>
<li class="chapter" data-level="11.1.1" data-path="assumptions-1.html"><a href="assumptions-1.html#missing-completely-at-random-mcar"><i class="fa fa-check"></i><b>11.1.1</b> Missing Completely at Random (MCAR)</a></li>
<li class="chapter" data-level="11.1.2" data-path="assumptions-1.html"><a href="assumptions-1.html#missing-at-random-mar"><i class="fa fa-check"></i><b>11.1.2</b> Missing at Random (MAR)</a></li>
<li class="chapter" data-level="11.1.3" data-path="assumptions-1.html"><a href="assumptions-1.html#ignorable"><i class="fa fa-check"></i><b>11.1.3</b> Ignorable</a></li>
<li class="chapter" data-level="11.1.4" data-path="assumptions-1.html"><a href="assumptions-1.html#nonignorable"><i class="fa fa-check"></i><b>11.1.4</b> Nonignorable</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="solutions-to-missing-data.html"><a href="solutions-to-missing-data.html"><i class="fa fa-check"></i><b>11.2</b> Solutions to Missing data</a><ul>
<li class="chapter" data-level="11.2.1" data-path="solutions-to-missing-data.html"><a href="solutions-to-missing-data.html#listwise-deletion"><i class="fa fa-check"></i><b>11.2.1</b> Listwise Deletion</a></li>
<li class="chapter" data-level="11.2.2" data-path="solutions-to-missing-data.html"><a href="solutions-to-missing-data.html#pairwise-deletion"><i class="fa fa-check"></i><b>11.2.2</b> Pairwise Deletion</a></li>
<li class="chapter" data-level="11.2.3" data-path="solutions-to-missing-data.html"><a href="solutions-to-missing-data.html#dummy-variable-adjustment"><i class="fa fa-check"></i><b>11.2.3</b> Dummy Variable Adjustment</a></li>
<li class="chapter" data-level="11.2.4" data-path="solutions-to-missing-data.html"><a href="solutions-to-missing-data.html#imputation"><i class="fa fa-check"></i><b>11.2.4</b> Imputation</a></li>
<li class="chapter" data-level="11.2.5" data-path="solutions-to-missing-data.html"><a href="solutions-to-missing-data.html#heckmans-sample-selection-model"><i class="fa fa-check"></i><b>11.2.5</b> Heckman’s Sample Selection Model</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="criteria-for-choosing-an-effective-approach.html"><a href="criteria-for-choosing-an-effective-approach.html"><i class="fa fa-check"></i><b>11.3</b> Criteria for Choosing an Effective Approach</a></li>
<li class="chapter" data-level="11.4" data-path="another-perspective.html"><a href="another-perspective.html"><i class="fa fa-check"></i><b>11.4</b> Another Perspective</a></li>
<li class="chapter" data-level="11.5" data-path="diagnosing-the-mechanism.html"><a href="diagnosing-the-mechanism.html"><i class="fa fa-check"></i><b>11.5</b> Diagnosing the Mechanism</a><ul>
<li class="chapter" data-level="11.5.1" data-path="diagnosing-the-mechanism.html"><a href="diagnosing-the-mechanism.html#mar-vs.-mnar"><i class="fa fa-check"></i><b>11.5.1</b> MAR vs. MNAR</a></li>
<li class="chapter" data-level="11.5.2" data-path="diagnosing-the-mechanism.html"><a href="diagnosing-the-mechanism.html#mcar-vs.-mar"><i class="fa fa-check"></i><b>11.5.2</b> MCAR vs. MAR</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="application-6.html"><a href="application-6.html"><i class="fa fa-check"></i><b>11.6</b> Application</a><ul>
<li class="chapter" data-level="11.6.1" data-path="application-6.html"><a href="application-6.html#imputation-with-mean-median-mode"><i class="fa fa-check"></i><b>11.6.1</b> Imputation with mean / median / mode</a></li>
<li class="chapter" data-level="11.6.2" data-path="application-6.html"><a href="application-6.html#knn"><i class="fa fa-check"></i><b>11.6.2</b> KNN</a></li>
<li class="chapter" data-level="11.6.3" data-path="application-6.html"><a href="application-6.html#rpart"><i class="fa fa-check"></i><b>11.6.3</b> rpart</a></li>
<li class="chapter" data-level="11.6.4" data-path="application-6.html"><a href="application-6.html#mice-multivariate-imputation-via-chained-equations"><i class="fa fa-check"></i><b>11.6.4</b> MICE (Multivariate Imputation via Chained Equations)</a></li>
<li class="chapter" data-level="11.6.5" data-path="application-6.html"><a href="application-6.html#amelia"><i class="fa fa-check"></i><b>11.6.5</b> Amelia</a></li>
<li class="chapter" data-level="11.6.6" data-path="application-6.html"><a href="application-6.html#missforest"><i class="fa fa-check"></i><b>11.6.6</b> missForest</a></li>
<li class="chapter" data-level="11.6.7" data-path="application-6.html"><a href="application-6.html#hmisc"><i class="fa fa-check"></i><b>11.6.7</b> Hmisc</a></li>
<li class="chapter" data-level="11.6.8" data-path="application-6.html"><a href="application-6.html#mi"><i class="fa fa-check"></i><b>11.6.8</b> mi</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III EXPERIMENTAL DESIGN</b></span></li>
<li class="chapter" data-level="12" data-path="analysis-of-variance-anova.html"><a href="analysis-of-variance-anova.html"><i class="fa fa-check"></i><b>12</b> Analysis of Variance (ANOVA)</a><ul>
<li class="chapter" data-level="12.1" data-path="completely-randomized-design-crd.html"><a href="completely-randomized-design-crd.html"><i class="fa fa-check"></i><b>12.1</b> Completely Randomized Design (CRD)</a><ul>
<li class="chapter" data-level="12.1.1" data-path="completely-randomized-design-crd.html"><a href="completely-randomized-design-crd.html#single-factor-fixed-effects-model"><i class="fa fa-check"></i><b>12.1.1</b> Single Factor Fixed Effects Model</a></li>
<li class="chapter" data-level="12.1.2" data-path="completely-randomized-design-crd.html"><a href="completely-randomized-design-crd.html#single-factor-random-effects-model"><i class="fa fa-check"></i><b>12.1.2</b> Single Factor Random Effects Model</a></li>
<li class="chapter" data-level="12.1.3" data-path="completely-randomized-design-crd.html"><a href="completely-randomized-design-crd.html#two-factor-fixed-effect-anova"><i class="fa fa-check"></i><b>12.1.3</b> Two Factor Fixed Effect ANOVA</a></li>
<li class="chapter" data-level="12.1.4" data-path="completely-randomized-design-crd.html"><a href="completely-randomized-design-crd.html#two-way-random-effects-anova"><i class="fa fa-check"></i><b>12.1.4</b> Two-Way Random Effects ANOVA</a></li>
<li class="chapter" data-level="12.1.5" data-path="completely-randomized-design-crd.html"><a href="completely-randomized-design-crd.html#two-way-mixed-effects-anova"><i class="fa fa-check"></i><b>12.1.5</b> Two-Way Mixed Effects ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="nonparametric-anova.html"><a href="nonparametric-anova.html"><i class="fa fa-check"></i><b>12.2</b> Nonparametric ANOVA</a><ul>
<li class="chapter" data-level="12.2.1" data-path="nonparametric-anova.html"><a href="nonparametric-anova.html#kruskal-wallis"><i class="fa fa-check"></i><b>12.2.1</b> Kruskal-Wallis</a></li>
<li class="chapter" data-level="12.2.2" data-path="nonparametric-anova.html"><a href="nonparametric-anova.html#friedman-test"><i class="fa fa-check"></i><b>12.2.2</b> Friedman Test</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="sample-size-planning-for-anova.html"><a href="sample-size-planning-for-anova.html"><i class="fa fa-check"></i><b>12.3</b> Sample Size Planning for ANOVA</a><ul>
<li class="chapter" data-level="12.3.1" data-path="sample-size-planning-for-anova.html"><a href="sample-size-planning-for-anova.html#balanced-designs"><i class="fa fa-check"></i><b>12.3.1</b> Balanced Designs</a></li>
<li class="chapter" data-level="12.3.2" data-path="sample-size-planning-for-anova.html"><a href="sample-size-planning-for-anova.html#randomized-block-experiments"><i class="fa fa-check"></i><b>12.3.2</b> Randomized Block Experiments</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="randomized-block-designs.html"><a href="randomized-block-designs.html"><i class="fa fa-check"></i><b>12.4</b> Randomized Block Designs</a><ul>
<li class="chapter" data-level="12.4.1" data-path="randomized-block-designs.html"><a href="randomized-block-designs.html#tukey-test-of-additivity"><i class="fa fa-check"></i><b>12.4.1</b> Tukey Test of Additivity</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="nested-designs.html"><a href="nested-designs.html"><i class="fa fa-check"></i><b>12.5</b> Nested Designs</a><ul>
<li class="chapter" data-level="12.5.1" data-path="nested-designs.html"><a href="nested-designs.html#two-factor-nested-designs"><i class="fa fa-check"></i><b>12.5.1</b> Two-Factor Nested Designs</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="analysis-of-covariance.html"><a href="analysis-of-covariance.html"><i class="fa fa-check"></i><b>13</b> Analysis of Covariance</a><ul>
<li class="chapter" data-level="13.1" data-path="single-factor-covariance-model.html"><a href="single-factor-covariance-model.html"><i class="fa fa-check"></i><b>13.1</b> Single Factor Covariance Model</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="causality.html"><a href="causality.html"><i class="fa fa-check"></i><b>14</b> Causality</a></li>
<li class="chapter" data-level="15" data-path="report.html"><a href="report.html"><i class="fa fa-check"></i><b>15</b> Report</a><ul>
<li class="chapter" data-level="15.1" data-path="one-summary-table.html"><a href="one-summary-table.html"><i class="fa fa-check"></i><b>15.1</b> One summary table</a></li>
<li class="chapter" data-level="15.2" data-path="model-comparison.html"><a href="model-comparison.html"><i class="fa fa-check"></i><b>15.2</b> Model Comparison</a></li>
<li class="chapter" data-level="15.3" data-path="changes-in-an-estimate.html"><a href="changes-in-an-estimate.html"><i class="fa fa-check"></i><b>15.3</b> Changes in an estimate</a></li>
</ul></li>
<li class="appendix"><span><b>APPENDIX</b></span></li>
<li class="chapter" data-level="A" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i><b>A</b> Appendix</a><ul>
<li class="chapter" data-level="A.1" data-path="short-cut.html"><a href="short-cut.html"><i class="fa fa-check"></i><b>A.1</b> Short-cut</a></li>
<li class="chapter" data-level="A.2" data-path="function-short-cut.html"><a href="function-short-cut.html"><i class="fa fa-check"></i><b>A.2</b> Function short-cut</a></li>
<li class="chapter" data-level="A.3" data-path="citation.html"><a href="citation.html"><i class="fa fa-check"></i><b>A.3</b> Citation</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="bookdown-cheat-sheet.html"><a href="bookdown-cheat-sheet.html"><i class="fa fa-check"></i><b>B</b> Bookdown cheat sheet</a><ul>
<li class="chapter" data-level="B.1" data-path="operation.html"><a href="operation.html"><i class="fa fa-check"></i><b>B.1</b> Operation</a></li>
<li class="chapter" data-level="B.2" data-path="math-expresssion-syntax.html"><a href="math-expresssion-syntax.html"><i class="fa fa-check"></i><b>B.2</b> Math Expresssion/ Syntax</a><ul>
<li class="chapter" data-level="B.2.1" data-path="math-expresssion-syntax.html"><a href="math-expresssion-syntax.html#statistics-notation"><i class="fa fa-check"></i><b>B.2.1</b> Statistics Notation</a></li>
</ul></li>
<li class="chapter" data-level="B.3" data-path="table.html"><a href="table.html"><i class="fa fa-check"></i><b>B.3</b> Table</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A Guide on Data Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="internal-instrumental-variable" class="section level2">
<h2><span class="header-section-number">8.7</span> Internal instrumental variable</h2>
<p>(also <strong>instrument free methods</strong>). This section is based on Raluca Gui’s <a href="https://cran.r-project.org/web/packages/REndo/vignettes/REndo-introduction.pdf">guide</a></p>
<p>alternative to external instrumental variable approaches</p>
<p>All approaches here assume a <strong>continuous dependent variable</strong></p>
<p><strong>Application</strong></p>
<div id="non-hierarchical-data-cross-classified" class="section level3">
<h3><span class="header-section-number">8.7.1</span> Non-hierarchical Data (Cross-classified)</h3>
<p><span class="math display">\[
Y_t = \beta_0 + \beta_1 P_t + \beta_2 X_t + \epsilon_t
\]</span></p>
<p>where</p>
<ul>
<li><span class="math inline">\(t = 1, .., T\)</span> (indexes either time or cross-sectional units)<br />
</li>
<li><span class="math inline">\(Y_t\)</span> is a k x 1 response variable<br />
</li>
<li><span class="math inline">\(X_t\)</span> is a k x n exogenous regressor<br />
</li>
<li><span class="math inline">\(P_t\)</span> is a k x 1 continuous endogenous regressor<br />
</li>
<li><span class="math inline">\(\epsilon_t\)</span> is a structural error term with <span class="math inline">\(\mu_\epsilon =0\)</span> and <span class="math inline">\(E(\epsilon^2) = \sigma^2\)</span></li>
<li><span class="math inline">\(\beta\)</span> are model parameters</li>
</ul>
<p>The endogeneity problem arises from the correlation of <span class="math inline">\(P_t\)</span> and <span class="math inline">\(\epsilon_t\)</span>:</p>
<p><span class="math display">\[
P_t = \gamma Z_t + v_t
\]</span></p>
<p>where</p>
<ul>
<li><span class="math inline">\(Z_t\)</span> is a l x 1 vector of internal instrumental variables<br />
</li>
<li><span class="math inline">\(ν_t\)</span> is a random error with <span class="math inline">\(\mu_{v_t}, E(v^2) = \sigma^2_v, E(\epsilon v) = \sigma_{\epsilon v}\)</span><br />
</li>
<li><span class="math inline">\(Z_t\)</span> is assumed to be stochastic with distribution G<br />
</li>
<li><span class="math inline">\(ν_t\)</span> is assumed to have density h(·)</li>
</ul>
<div id="latent-instrumental-variable" class="section level4">
<h4><span class="header-section-number">8.7.1.1</span> Latent Instrumental Variable</h4>
<p><span class="citation">(Ebbes et al. <a href="#ref-Ebbes_2005" role="doc-biblioref">2005</a>)</span></p>
<p>assume <span class="math inline">\(Z_t\)</span> (unobserved) to be uncorrelated with <span class="math inline">\(\epsilon_t\)</span>, which is similar to <a href="instrumental-variable.html#instrumental-variable">Instrumental Variable</a>. Hence, <span class="math inline">\(Z_t\)</span> and <span class="math inline">\(ν_t\)</span> can’t be identified without distributional assumptions</p>
<p>The distributions of <span class="math inline">\(Z_t\)</span> and <span class="math inline">\(ν_t\)</span> need to be specified such that:</p>
<ol style="list-style-type: decimal">
<li>endogeneity of <span class="math inline">\(P_t\)</span> is corrected<br />
</li>
<li>the distribution of <span class="math inline">\(P_t\)</span> is empirically close to the integral that expresses the amount of
overlap of Z as it is shifted over ν (= the convolution between <span class="math inline">\(Z_t\)</span> and <span class="math inline">\(ν_t\)</span>).</li>
</ol>
<p>When the density h(·) = Normal, then G cannot be normal because the parameters would not be identified <span class="citation">(Ebbes et al. <a href="#ref-Ebbes_2005" role="doc-biblioref">2005</a>)</span> .</p>
<p>Hence,</p>
<ul>
<li>in the <a href="internal-instrumental-variable.html#latent-instrumental-variable">LIV</a> model the distribution of <span class="math inline">\(Z_t\)</span> is discrete<br />
</li>
<li>in the <a href="internal-instrumental-variable.html#higher-moments-method">Higher Moments Method</a> and <a href="internal-instrumental-variable.html#joint-estimation-using-copula">Joint Estimation Using Copula</a> methods, the distribution of <span class="math inline">\(Z_t\)</span> is taken to be skewed.</li>
</ul>
<p><span class="math inline">\(Z_t\)</span> are assumed <strong>unobserved, discrete and exogenous</strong>, with</p>
<ul>
<li>an unknown number of groups m<br />
</li>
<li><span class="math inline">\(\gamma\)</span> is a vector of group means.</li>
</ul>
<p>Identification of the parameters relies on the distributional assumptions of</p>
<ul>
<li><span class="math inline">\(P_t\)</span>: a non-Gaussian distribution<br />
</li>
<li><span class="math inline">\(Z_t\)</span> discrete with <span class="math inline">\(m \ge 2\)</span></li>
</ul>
<p>Note:</p>
<ul>
<li>If <span class="math inline">\(Z_t\)</span> is continuous, the model is unidentified<br />
</li>
<li>If <span class="math inline">\(P_t \sim N\)</span>, you have inefficient estimates.</li>
</ul>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="internal-instrumental-variable.html#cb211-1"></a>m3.liv &lt;-<span class="st"> </span><span class="kw">latentIV</span>(read <span class="op">~</span><span class="st"> </span>stratio, <span class="dt">data=</span>school)</span>
<span id="cb211-2"><a href="internal-instrumental-variable.html#cb211-2"></a><span class="kw">summary</span>(m3.liv)<span class="op">$</span>coefficients[<span class="dv">1</span><span class="op">:</span><span class="dv">7</span>,]</span></code></pre></div>
<pre><code>##                   Estimate    Std. Error       z-score     Pr(&gt;|z|)
## (Intercept)   6.996014e+02  2.686186e+02  2.604441e+00 9.529597e-03
## stratio      -2.272673e+00  1.367757e+01 -1.661605e-01 8.681108e-01
## pi1          -4.896363e+01  5.526907e-08 -8.859139e+08 0.000000e+00
## pi2           1.963920e+01  9.225351e-02  2.128830e+02 0.000000e+00
## theta5       6.939432e-152 3.354672e-160  2.068587e+08 0.000000e+00
## theta6        3.787512e+02  4.249457e+01  8.912932e+00 1.541524e-17
## theta7       -1.227543e+00  4.885276e+01 -2.512741e-02 9.799653e-01</code></pre>
<p>it will return a coefficient very different from the other methods since there is only one endogenous variable.</p>
</div>
<div id="joint-estimation-using-copula" class="section level4">
<h4><span class="header-section-number">8.7.1.2</span> Joint Estimation Using Copula</h4>
<p>assume <span class="math inline">\(Z_t\)</span> (unobserved) to be uncorrelated with <span class="math inline">\(\epsilon_t\)</span>, which is similar to <a href="instrumental-variable.html#instrumental-variable">Instrumental Variable</a>. Hence, <span class="math inline">\(Z_t\)</span> and <span class="math inline">\(ν_t\)</span> can’t be identified without distributional assumptions</p>
<p><span class="citation">(Park and Gupta <a href="#ref-Park_2012" role="doc-biblioref">2012</a>)</span> allows joint estimation of the continuous <span class="math inline">\(P_t\)</span> and <span class="math inline">\(\epsilon_t\)</span> using Gaussian copulas, where a copula is a function that maps several conditional distribution functions (CDF) into their joint CDF).</p>
<p>The underlying idea is that using information contained in the observed data, one selects marginal distributions for <span class="math inline">\(P_t\)</span> and <span class="math inline">\(\epsilon_t\)</span>. Then, the copula model constructs a flexible multivariate joint distribution that allows a wide range of correlations between the two marginals.</p>
<p>The method allows both continuous and discrete <span class="math inline">\(P_t\)</span>.</p>
<p>In the special case of <strong>one continuous</strong> <span class="math inline">\(P_t\)</span>, estimation is based on MLE<br />
Otherwise, based on Gaussian copulas, augmented OLS estimation is used.</p>
<p><strong>Assumptions</strong>:</p>
<ul>
<li><p>skewed <span class="math inline">\(P_t\)</span><br />
</p></li>
<li><p>the recovery of the correct parameter estimates<br />
</p></li>
<li><p><span class="math inline">\(\epsilon_t \sim\)</span> normal marginal distribution. The marginal distribution of <span class="math inline">\(P_t\)</span> is obtained using the <strong>Epanechnikov kernel density estimator</strong><br />
<span class="math display">\[
\hat{h}_p = \frac{1}{T . b} \sum_{t=1}^TK(\frac{p - P_t}{b})
\]</span>
where</p></li>
<li><p><span class="math inline">\(P_t\)</span> = endogenous variables<br />
</p></li>
<li><p><span class="math inline">\(K(x) = 0.75(1-x^2)I(||x||\le 1)\)</span><br />
</p></li>
<li><p><span class="math inline">\(b=0.9T^{-1/5}\times min(s, IQR/1.34)\)</span> suggested by <span class="citation">(Silverman <a href="#ref-Silverman_1969" role="doc-biblioref">1969</a>)</span><br />
+ IQR = interquartile range<br />
+ s = sample standard deviation<br />
+ T = n of time periods observed in the data</p></li>
</ul>
<p>In augmented OLS and MLE, the inference procedure occurs in two stages:</p>
<p>(1): the empirical distribution of <span class="math inline">\(P_t\)</span> is computed<br />
(2) used in it constructing the likelihood function)<br />
Hence, the standard errors would not be correct.</p>
<p>So we use the sampling distributions (from bootstrapping) to get standard errors and the variance-covariance matrix. Since the distribution of the bootstraped parameters is highly skewed, we report the percentile confidence intervals is preferable.</p>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="internal-instrumental-variable.html#cb213-1"></a><span class="kw">set.seed</span>(<span class="dv">110</span>)</span>
<span id="cb213-2"><a href="internal-instrumental-variable.html#cb213-2"></a>m4.cc &lt;-</span>
<span id="cb213-3"><a href="internal-instrumental-variable.html#cb213-3"></a><span class="st">        </span><span class="kw">copulaCorrection</span>(</span>
<span id="cb213-4"><a href="internal-instrumental-variable.html#cb213-4"></a>                read <span class="op">~</span><span class="st"> </span>stratio <span class="op">+</span><span class="st"> </span>english <span class="op">+</span><span class="st"> </span>lunch <span class="op">+</span><span class="st"> </span>calworks <span class="op">+</span></span>
<span id="cb213-5"><a href="internal-instrumental-variable.html#cb213-5"></a><span class="st">                        </span>grades <span class="op">+</span><span class="st"> </span>income <span class="op">+</span><span class="st"> </span>county <span class="op">|</span><span class="st"> </span><span class="kw">continuous</span>(stratio),</span>
<span id="cb213-6"><a href="internal-instrumental-variable.html#cb213-6"></a>                <span class="dt">data =</span> school,</span>
<span id="cb213-7"><a href="internal-instrumental-variable.html#cb213-7"></a>                <span class="dt">optimx.args =</span> <span class="kw">list</span>(<span class="dt">method =</span> <span class="kw">c</span>(<span class="st">&quot;Nelder-Mead&quot;</span>), <span class="dt">itnmax =</span> <span class="dv">60000</span>),</span>
<span id="cb213-8"><a href="internal-instrumental-variable.html#cb213-8"></a>                <span class="dt">num.boots =</span> <span class="dv">2</span>,</span>
<span id="cb213-9"><a href="internal-instrumental-variable.html#cb213-9"></a>                <span class="dt">verbose =</span> <span class="ot">FALSE</span></span>
<span id="cb213-10"><a href="internal-instrumental-variable.html#cb213-10"></a>        )</span>
<span id="cb213-11"><a href="internal-instrumental-variable.html#cb213-11"></a><span class="kw">summary</span>(m4.cc)<span class="op">$</span>coefficients[<span class="dv">1</span><span class="op">:</span><span class="dv">7</span>, ]</span></code></pre></div>
<pre><code>##             Point Estimate   Boots SE Lower Boots CI (95%) Upper Boots CI (95%)
## (Intercept)   683.06900891 2.80554212                   NA                   NA
## stratio        -0.32434608 0.02075999                   NA                   NA
## english        -0.21576110 0.01450666                   NA                   NA
## lunch          -0.37087664 0.01902052                   NA                   NA
## calworks       -0.05569058 0.02076781                   NA                   NA
## gradesKK-08    -1.92286128 0.25684614                   NA                   NA
## income          0.73595353 0.04725700                   NA                   NA</code></pre>
<p>we run this model with only one endogenous continuous regressor (<code>stratio</code>). Sometimes, the code will not converge, in which case you can use different</p>
<ul>
<li>optimization algorithm<br />
</li>
<li>starting values<br />
</li>
<li>maximum number of iterations</li>
</ul>
</div>
<div id="higher-moments-method" class="section level4">
<h4><span class="header-section-number">8.7.1.3</span> Higher Moments Method</h4>
<p>suggested by <span class="citation">(Lewbel <a href="#ref-Lewbel_1997" role="doc-biblioref">1997</a>)</span> to identify <span class="math inline">\(\epsilon_t\)</span> caused by <strong>measurement error</strong>.</p>
<p>Identification is achieved by using third moments of the data, with no restrictions on the distribution of <span class="math inline">\(\epsilon_t\)</span><br />
The following instruments can be used with 2SLS estimation to obtain consistent estimates:</p>
<p><span class="math display">\[
\begin{align}
q_{1t} &amp;=  (G_t - \bar{G}) \\
q_{2t} &amp;=  (G_t - \bar{G})(P_t - \bar{P}) \\
q_{3t} &amp;=   (G_t - \bar{G})(Y_t - \bar{Y})\\
q_{4t} &amp;=  (Y_t - \bar{Y})(P_t - \bar{P}) \\
q_{5t} &amp;=  (P_t - \bar{P})^2 \\
q_{6t} &amp;=  (Y_t - \bar{Y})^2 \\
\end{align}
\]</span></p>
<p>where</p>
<ul>
<li><span class="math inline">\(G_t = G(X_t)\)</span> for any given function G that has finite third own and cross moments<br />
</li>
<li>X = exogenous variable</li>
</ul>
<p><span class="math inline">\(q_{5t}, q_{6t}\)</span> can be used only when the measurement and <span class="math inline">\(\epsilon_t\)</span> are symmetrically distributed. The rest of the instruments does not require any distributional assumptions for <span class="math inline">\(\epsilon_t\)</span>.</p>
<p>Since the regressors <span class="math inline">\(G(X) = X\)</span> are included as instruments, <span class="math inline">\(G(X)\)</span> can’t be a linear function of X in <span class="math inline">\(q_{1t}\)</span></p>
<p>Since this method has very strong assumptions, <a href="internal-instrumental-variable.html#higher-moments-method">Higher Moments Method</a> should only be used in case of overidentification</p>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="internal-instrumental-variable.html#cb215-1"></a><span class="kw">set.seed</span>(<span class="dv">111</span>)</span>
<span id="cb215-2"><a href="internal-instrumental-variable.html#cb215-2"></a>m5.hetEr &lt;-</span>
<span id="cb215-3"><a href="internal-instrumental-variable.html#cb215-3"></a><span class="st">        </span><span class="kw">hetErrorsIV</span>(</span>
<span id="cb215-4"><a href="internal-instrumental-variable.html#cb215-4"></a>                read <span class="op">~</span><span class="st"> </span>stratio <span class="op">+</span><span class="st"> </span>english <span class="op">+</span><span class="st"> </span>lunch <span class="op">+</span><span class="st"> </span>calworks <span class="op">+</span><span class="st"> </span>income <span class="op">+</span></span>
<span id="cb215-5"><a href="internal-instrumental-variable.html#cb215-5"></a><span class="st">                        </span>grades <span class="op">+</span><span class="st"> </span>county <span class="op">|</span><span class="st"> </span>stratio <span class="op">|</span><span class="st"> </span><span class="kw">IIV</span>(income, english),</span>
<span id="cb215-6"><a href="internal-instrumental-variable.html#cb215-6"></a>                <span class="dt">data =</span> school</span>
<span id="cb215-7"><a href="internal-instrumental-variable.html#cb215-7"></a>        )</span>
<span id="cb215-8"><a href="internal-instrumental-variable.html#cb215-8"></a><span class="kw">summary</span>(m5.hetEr)<span class="op">$</span>coefficients[<span class="dv">1</span><span class="op">:</span><span class="dv">7</span>, ]</span></code></pre></div>
<pre><code>##                 Estimate  Std. Error    t value     Pr(&gt;|t|)
## (Intercept) 662.78791557 27.90173069 23.7543657 2.380436e-76
## stratio       0.71480686  1.31077325  0.5453322 5.858545e-01
## english      -0.19522271  0.04057527 -4.8113717 2.188618e-06
## lunch        -0.37834232  0.03927793 -9.6324402 9.760809e-20
## calworks     -0.05665126  0.06302095 -0.8989273 3.692776e-01
## income        0.82693755  0.17236557  4.7975797 2.335271e-06
## gradesKK-08  -1.93795843  1.38723186 -1.3969968 1.632541e-01</code></pre>
<p>recommend using this approach to create additional instruments to use with external ones for better efficiency.</p>
</div>
<div id="heteroskedastic-error-approach" class="section level4">
<h4><span class="header-section-number">8.7.1.4</span> Heteroskedastic Error Approach</h4>
<ul>
<li>using means of variables that are uncorrelated with the product of heteroskedastic errors to identify structural parameters.<br />
</li>
<li>This method can be use either when you don’t have external instruments or you want to use additional instruments to improve the efficiency of the IV estimator <span class="citation">(Lewbel <a href="#ref-Lewbel_2012" role="doc-biblioref">2012</a>)</span><br />
</li>
<li>The instruments are constructed as simple functions of data<br />
</li>
<li>Model’s assumptions:</li>
</ul>
<p><span class="math display">\[
E(X \epsilon) = 0 \\
E(X v ) = 0 \\
cov(Z, \epsilon v) = 0  \\
cov(Z, v^2) \neq 0 \text{  (for identification)}
\]</span></p>
<p>Structural parameters are identified by 2SLS regression of Y on X and P, using X and [Z − E(Z)]ν as instruments.</p>
<p><span class="math display">\[
\text{instrument&#39;s strength} \propto cov((Z-\bar{Z})v,v)
\]</span>
where <span class="math inline">\(cov((Z-\bar{Z})v,v)\)</span> is the degree of heteroskedasticity of ν with respect to Z <span class="citation">(Lewbel <a href="#ref-Lewbel_2012" role="doc-biblioref">2012</a>)</span>, which can be empirically tested.</p>
<p>If it is zero or close to zero (i.e.,the instrument is weak), you might have imprecise estimates, with large standard errors.</p>
<ul>
<li>Under homoskedasticity, the parameters of the model are unidentified.<br />
</li>
<li>Under heteroskedasticity related to at least some elements of X, the parameters of the model are identified.</li>
</ul>
</div>
</div>
<div id="hierarchical-data" class="section level3">
<h3><span class="header-section-number">8.7.2</span> Hierarchical Data</h3>
<p>Multiple independent assumptions involving various random components at different levels mean that any moderate correlation between some predictors and a random component or error term can result in a significant bias of the coefficients and of the variance components. <span class="citation">(Kim and Frees <a href="#ref-Kim_2007" role="doc-biblioref">2007</a>)</span> proposed a generalized method of moments which uses both, the between and within variations of the exogenous variables, but only
assumes the within variation of the variables to be endogenous.</p>
<p><strong>Assumptions</strong></p>
<ul>
<li>the errors at each level <span class="math inline">\(\sim iid N\)</span><br />
</li>
<li>the slope variables are exogenous<br />
</li>
<li>the level-1 <span class="math inline">\(\epsilon \perp X, P\)</span>. If this is not the case, additional, external instruments are necessary</li>
</ul>
<p><strong>Hierarchical Model</strong></p>
<p><span class="math display">\[
Y_{cst} = Z_{cst}^1 \beta_{cs}^1 + X_{cst}^1 \beta_1 + \epsilon_{cst}^1 \\
\beta^1_{cs} = Z_{cs}^2 \beta_{c}^2 + X_{cst}^2 \beta_2 + \epsilon_{cst}^2 \\
\beta^2_{c} = X^3_c \beta_3 + \epsilon_c^3
\]</span></p>
<p>Bias could stem from:</p>
<ul>
<li>errors at the higher two levels (<span class="math inline">\(\epsilon_c^3,\epsilon_{cst}^2\)</span>) are correlated with some of the regressors<br />
</li>
<li>only third level errors (<span class="math inline">\(\epsilon_c^3\)</span>) are correlated with some of the regressors</li>
</ul>
<p><span class="citation">(Kim and Frees <a href="#ref-Kim_2007" role="doc-biblioref">2007</a>)</span> proposed</p>
<ul>
<li>When all variables are assumed exogenous, the proposed estimator equals the random effects estimator<br />
</li>
<li>When all variables are assumed endogenous, it equals the fixed effects estimator<br />
</li>
<li>also use omitted variable test (based on the Hausman-test <span class="citation">(Hausman <a href="#ref-Hausman_1978" role="doc-biblioref">1978</a>)</span> for panel data), which allows the comparison of a robust estimator and an estimator that is efficient under the null hypothesis of no omitted variables or the comparison of two robust estimators at different levels.</li>
</ul>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="internal-instrumental-variable.html#cb217-1"></a><span class="kw">set.seed</span>(<span class="dv">113</span>)</span>
<span id="cb217-2"><a href="internal-instrumental-variable.html#cb217-2"></a>school<span class="op">$</span>gr08 &lt;-<span class="st"> </span>school<span class="op">$</span>grades <span class="op">==</span><span class="st"> &quot;KK-06&quot;</span></span>
<span id="cb217-3"><a href="internal-instrumental-variable.html#cb217-3"></a>m7.multilevel &lt;-</span>
<span id="cb217-4"><a href="internal-instrumental-variable.html#cb217-4"></a><span class="st">        </span><span class="kw">multilevelIV</span>(read <span class="op">~</span><span class="st"> </span>stratio <span class="op">+</span><span class="st"> </span>english <span class="op">+</span><span class="st"> </span>lunch <span class="op">+</span><span class="st"> </span>income <span class="op">+</span><span class="st"> </span>gr08 <span class="op">+</span></span>
<span id="cb217-5"><a href="internal-instrumental-variable.html#cb217-5"></a><span class="st">                             </span>calworks <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>county) <span class="op">|</span><span class="st"> </span><span class="kw">endo</span>(stratio),</span>
<span id="cb217-6"><a href="internal-instrumental-variable.html#cb217-6"></a>                     <span class="dt">data =</span> school)</span>
<span id="cb217-7"><a href="internal-instrumental-variable.html#cb217-7"></a><span class="kw">summary</span>(m7.multilevel)<span class="op">$</span>coefficients[<span class="dv">1</span><span class="op">:</span><span class="dv">7</span>, ]</span></code></pre></div>
<pre><code>##                Estimate Std. Error     z-score     Pr(&gt;|z|)
## (Intercept) 675.8228656 5.58008680 121.1133248 0.000000e+00
## stratio      -0.4956054 0.23922638  -2.0717005 3.829339e-02
## english      -0.2599777 0.03413530  -7.6160948 2.614656e-14
## lunch        -0.3692954 0.03560210 -10.3728537 3.295342e-25
## income        0.6723141 0.08862012   7.5864728 3.287314e-14
## gr08TRUE      2.1590333 1.28167222   1.6845440 9.207658e-02
## calworks     -0.0570633 0.05711701  -0.9990596 3.177658e-01</code></pre>
<p>Another example using simulated data</p>
<ul>
<li>five level-1 regressors, <span class="math inline">\(X_{11}, X_{12}, X_{13}, X_{14}, X_{15}\)</span>, where X15 is correlated with the level-2 error (i.e., endogenous).<br />
</li>
<li>four level-2 regressors, <span class="math inline">\(X_{21}, X_{22}, X_{23}, X_{24}\)</span><br />
</li>
<li>three level-3 regressors, <span class="math inline">\(X_{31}, X_{32}, X_{33}\)</span></li>
</ul>
<p>We estimate a three-level model with X15 assumed endogenous.
Having a three-level hierarchy, <code>multilevelIV()</code> returns five estimators, from the most robust to omitted
variables (FE_L2), to the most efficient (REF) (i.e. lowest mean squared error).</p>
<ul>
<li>The random effects estimator (REF) is efficient assuming no omitted variables</li>
<li>The fixed effects estimator (FE) is unbiased and asymptotically normal even in the presence of omitted variables.<br />
</li>
<li>Because of the efficiency, the random effects estimator is preferable if you think there is no omitted. variables<br />
</li>
<li>The robust estimator would be preferable if you think there is omitted variables.</li>
</ul>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="internal-instrumental-variable.html#cb219-1"></a><span class="kw">data</span>(dataMultilevelIV)</span>
<span id="cb219-2"><a href="internal-instrumental-variable.html#cb219-2"></a><span class="kw">set.seed</span>(<span class="dv">114</span>)</span>
<span id="cb219-3"><a href="internal-instrumental-variable.html#cb219-3"></a>formula1 &lt;-</span>
<span id="cb219-4"><a href="internal-instrumental-variable.html#cb219-4"></a><span class="st">        </span>y <span class="op">~</span><span class="st"> </span>X11 <span class="op">+</span><span class="st"> </span>X12 <span class="op">+</span><span class="st"> </span>X13 <span class="op">+</span><span class="st"> </span>X14 <span class="op">+</span><span class="st"> </span>X15 <span class="op">+</span><span class="st"> </span>X21 <span class="op">+</span><span class="st"> </span>X22 <span class="op">+</span><span class="st"> </span>X23 <span class="op">+</span><span class="st"> </span>X24 <span class="op">+</span></span>
<span id="cb219-5"><a href="internal-instrumental-variable.html#cb219-5"></a><span class="st">        </span>X31 <span class="op">+</span><span class="st"> </span>X32 <span class="op">+</span><span class="st"> </span>X33 <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>CID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>SID) <span class="op">|</span><span class="st"> </span><span class="kw">endo</span>(X15)</span>
<span id="cb219-6"><a href="internal-instrumental-variable.html#cb219-6"></a>m8.multilevel &lt;-</span>
<span id="cb219-7"><a href="internal-instrumental-variable.html#cb219-7"></a><span class="st">        </span><span class="kw">multilevelIV</span>(<span class="dt">formula =</span> formula1, <span class="dt">data =</span> dataMultilevelIV)</span>
<span id="cb219-8"><a href="internal-instrumental-variable.html#cb219-8"></a><span class="kw">coef</span>(m8.multilevel)</span></code></pre></div>
<pre><code>##                    REF      FE_L2      FE_L3     GMM_L2     GMM_L3
## (Intercept) 64.3168856  0.0000000  0.0000000 64.3485944 64.3168868
## X11          3.0213405  3.0459605  3.0214255  3.0146686  3.0213403
## X12          8.9522160  8.9839088  8.9524723  8.9747533  8.9522169
## X13         -2.0194178 -2.0145054 -2.0193321 -2.0021426 -2.0194171
## X14          1.9651420  1.9791437  1.9648317  1.9658681  1.9651421
## X15         -0.5647915 -0.9777361 -0.5647621 -0.9750309 -0.5648070
## X21         -2.3316225  0.0000000 -2.2845297 -2.3052516 -2.3316215
## X22         -3.9564944  0.0000000 -3.9553644 -4.0130975 -3.9564966
## X23         -2.9779887  0.0000000 -2.9756848 -2.9488487 -2.9779876
## X24          4.9078293  0.0000000  4.9084694  4.7933756  4.9078250
## X31          2.1142348  0.0000000  0.0000000  2.1164477  2.1142349
## X32          0.3934770  0.0000000  0.0000000  0.3799626  0.3934764
## X33          0.1082086  0.0000000  0.0000000  0.1108386  0.1082087</code></pre>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="internal-instrumental-variable.html#cb221-1"></a><span class="kw">summary</span>(m8.multilevel, <span class="st">&quot;REF&quot;</span>)</span></code></pre></div>
<pre><code>## 
## Call:
## multilevelIV(formula = formula1, data = dataMultilevelIV)
## 
## Number of levels: 3
## Number of observations: 2824
## Number of groups: L2(CID): 1368  L3(SID): 40
## 
## Coefficients for model REF:
##             Estimate Std. Error z-score Pr(&gt;|z|)    
## (Intercept) 64.31689    7.87332   8.169 3.11e-16 ***
## X11          3.02134    0.02576 117.306  &lt; 2e-16 ***
## X12          8.95222    0.02572 348.131  &lt; 2e-16 ***
## X13         -2.01942    0.02409 -83.835  &lt; 2e-16 ***
## X14          1.96514    0.02521  77.937  &lt; 2e-16 ***
## X15         -0.56479    0.01950 -28.962  &lt; 2e-16 ***
## X21         -2.33162    0.16228 -14.368  &lt; 2e-16 ***
## X22         -3.95649    0.13119 -30.160  &lt; 2e-16 ***
## X23         -2.97799    0.06611 -45.044  &lt; 2e-16 ***
## X24          4.90783    0.19796  24.792  &lt; 2e-16 ***
## X31          2.11423    0.10433  20.264  &lt; 2e-16 ***
## X32          0.39348    0.30426   1.293   0.1959    
## X33          0.10821    0.05236   2.067   0.0388 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Omitted variable tests for model REF:
##               df     Chisq  p-value    
## GMM_L2_vs_REF  7     18.74 0.009040 ** 
## GMM_L3_vs_REF 13 -12872.98 1.000000    
## FE_L2_vs_REF  13     39.99 0.000139 ***
## FE_L3_vs_REF  13     39.99 0.000138 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>True <span class="math inline">\(\beta_{X_{15}} =-1\)</span>. We can see that some estimators are bias because <span class="math inline">\(X_{15}\)</span> is correlated with the level-two error, to which only FE_L2 and GMM_L2 are robust</p>
<p>To select the appropriate estimator, we use the omitted variable test.</p>
<p>In a three-level setting, we can have different estimator comparisons:</p>
<ul>
<li>Fixed effects vs. random effects estimators: Test for omitted level-two and level-three
omitted effects, simultaneously, one compares FE_L2 to REF. But we will not know at which omitted variables exist.<br />
</li>
<li>Fixed effects vs. GMM estimators: Once the existence of omitted effects is established but not sure at which level, we test for level-2 omitted effects by comparing FE_L2 vs GMM_L3. If you reject the null, the omitted variables are at level-2 The same is accomplished by testing FE_L2 vs. GMM_L2, since the latter is consistent only if there are no omitted effects at level-2.<br />
</li>
<li>Fixed effects vs. fixed effects estimators: We can test for omitted level-2 effects, while
allowing for omitted level-3 effects by comparing FE_L2 vs. FE_L3 since FE_L2 is robust against both level-2 and level-3 omitted effects while FE_L3 is only robust to level-3 omitted variables.</li>
</ul>
<p>Summary, use the omitted variable test comparing <code>REF vs. FE_L2</code> first.</p>
<ul>
<li>If the null hypothesis is rejected, then there are omitted variables either at level-2 or level-3</li>
<li>Next, test whether there are level-2 omitted effects, since testing for omitted level three effects relies on the assumption there are no level-two omitted effects. You can use any of these pair of comparisons:<br />
+ <code>FE_L2 vs. FE_L3</code><br />
+ <code>FE_L2 vs. GMM_L2</code><br />
</li>
<li>If no omitted variables at level-2 are found, test for omitted level-3 effects by comparing either<br />
+ FE_L3 vs. GMM_L3<br />
+ GMM_L2 vs. GMM_L3</li>
</ul>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="internal-instrumental-variable.html#cb223-1"></a><span class="kw">summary</span>(m8.multilevel, <span class="st">&quot;REF&quot;</span>)</span></code></pre></div>
<pre><code>## 
## Call:
## multilevelIV(formula = formula1, data = dataMultilevelIV)
## 
## Number of levels: 3
## Number of observations: 2824
## Number of groups: L2(CID): 1368  L3(SID): 40
## 
## Coefficients for model REF:
##             Estimate Std. Error z-score Pr(&gt;|z|)    
## (Intercept) 64.31689    7.87332   8.169 3.11e-16 ***
## X11          3.02134    0.02576 117.306  &lt; 2e-16 ***
## X12          8.95222    0.02572 348.131  &lt; 2e-16 ***
## X13         -2.01942    0.02409 -83.835  &lt; 2e-16 ***
## X14          1.96514    0.02521  77.937  &lt; 2e-16 ***
## X15         -0.56479    0.01950 -28.962  &lt; 2e-16 ***
## X21         -2.33162    0.16228 -14.368  &lt; 2e-16 ***
## X22         -3.95649    0.13119 -30.160  &lt; 2e-16 ***
## X23         -2.97799    0.06611 -45.044  &lt; 2e-16 ***
## X24          4.90783    0.19796  24.792  &lt; 2e-16 ***
## X31          2.11423    0.10433  20.264  &lt; 2e-16 ***
## X32          0.39348    0.30426   1.293   0.1959    
## X33          0.10821    0.05236   2.067   0.0388 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Omitted variable tests for model REF:
##               df     Chisq  p-value    
## GMM_L2_vs_REF  7     18.74 0.009040 ** 
## GMM_L3_vs_REF 13 -12872.98 1.000000    
## FE_L2_vs_REF  13     39.99 0.000139 ***
## FE_L3_vs_REF  13     39.99 0.000138 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="internal-instrumental-variable.html#cb225-1"></a><span class="co"># compare REF with all the other estimators. Testing REF (the most efficient estimator) against FE_L2 (the most robust estimator), equivalently we are testing simultaneously for level-2 and level-3 omitted effects. </span></span></code></pre></div>
<p>Since the null hypothesis is rejected (p = 0.000139), there is bias in the random effects estimator.</p>
<p>To test for level-2 omitted effects (regardless of level-3 omitted effects), we compare FE_L2 versus FE_L3</p>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="internal-instrumental-variable.html#cb226-1"></a><span class="kw">summary</span>(m8.multilevel,<span class="st">&quot;FE_L2&quot;</span>)</span></code></pre></div>
<pre><code>## 
## Call:
## multilevelIV(formula = formula1, data = dataMultilevelIV)
## 
## Number of levels: 3
## Number of observations: 2824
## Number of groups: L2(CID): 1368  L3(SID): 40
## 
## Coefficients for model FE_L2:
##               Estimate Std. Error z-score Pr(&gt;|z|)    
## (Intercept)  0.000e+00  4.275e-19    0.00        1    
## X11          3.046e+00  2.978e-02  102.30   &lt;2e-16 ***
## X12          8.984e+00  3.360e-02  267.41   &lt;2e-16 ***
## X13         -2.015e+00  3.107e-02  -64.83   &lt;2e-16 ***
## X14          1.979e+00  3.203e-02   61.80   &lt;2e-16 ***
## X15         -9.777e-01  3.364e-02  -29.06   &lt;2e-16 ***
## X21          0.000e+00  1.824e-18    0.00        1    
## X22          0.000e+00  1.303e-18    0.00        1    
## X23          0.000e+00  4.389e-18    0.00        1    
## X24          0.000e+00  1.724e-18    0.00        1    
## X31          0.000e+00  1.468e-17    0.00        1    
## X32          0.000e+00  8.265e-18    0.00        1    
## X33          0.000e+00  2.793e-17    0.00        1    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Omitted variable tests for model FE_L2:
##                 df Chisq  p-value    
## FE_L2_vs_REF    13 39.99 0.000139 ***
## FE_L2_vs_FE_L3   9 36.02 3.92e-05 ***
## FE_L2_vs_GMM_L2 12 39.99 7.21e-05 ***
## FE_L2_vs_GMM_L3 13 39.99 0.000139 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>The null hypothesis of no omitted level-2 effects is rejected (<span class="math inline">\(p = 3.92e − 05\)</span>). Hence, there are omitted effects at level-two. We should use FE_L2 which is consistent with the underlying data that we generated (level-2 error correlated with <span class="math inline">\(X_15\)</span>, which leads to biased FE_L3 coefficients.</p>
<p>The omitted variable test between FE_L2 and GMM_L2 should reject the null hypothesis of no
omitted level-2 effects (p-value is 0).</p>
<p>If we assume an endogenous variable as exogenous, the RE and GMM estimators will be biased because of the wrong set of internal instrumental variables. To increase our confidence, we should compare the omitted variable tests when the variable is considered endogenous vs. exogenous to get a sense whether the variable is truly endogenous.</p>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-Ebbes_2005">
<p>Ebbes, Peter, Michel Wedel, Ulf B?ckenholt, and Ton Steerneman. 2005. “Solving and Testing for Regressor-Error (in)Dependence When No Instrumental Variables Are Available: With New Evidence for the Effect of Education on Income.” <em>Quantitative Marketing and Economics</em> 3 (4): 365–92. <a href="https://doi.org/10.1007/s11129-005-1177-6">https://doi.org/10.1007/s11129-005-1177-6</a>.</p>
</div>
<div id="ref-Hausman_1978">
<p>Hausman, J. A. 1978. “Specification Tests in Econometrics.” <em>Econometrica</em> 46 (6): 1251. <a href="https://doi.org/10.2307/1913827">https://doi.org/10.2307/1913827</a>.</p>
</div>
<div id="ref-Kim_2007">
<p>Kim, Jee-Seon, and Edward W. Frees. 2007. “Multilevel Modeling with Correlated Effects.” <em>Psychometrika</em> 72 (4): 505–33. <a href="https://doi.org/10.1007/s11336-007-9008-1">https://doi.org/10.1007/s11336-007-9008-1</a>.</p>
</div>
<div id="ref-Lewbel_1997">
<p>Lewbel, Arthur. 1997. “Constructing Instruments for Regressions with Measurement Error When No Additional Data Are Available, with an Application to Patents and R&amp;D.” <em>Econometrica</em> 65 (5): 1201. <a href="https://doi.org/10.2307/2171884">https://doi.org/10.2307/2171884</a>.</p>
</div>
<div id="ref-Lewbel_2012">
<p>Lewbel, Arthur. 2012. “Using Heteroscedasticity to Identify and Estimate Mismeasured and Endogenous Regressor Models.” <em>Journal of Business &amp; Economic Statistics</em> 30 (1): 67–80. <a href="https://doi.org/10.1080/07350015.2012.643126">https://doi.org/10.1080/07350015.2012.643126</a>.</p>
</div>
<div id="ref-Park_2012">
<p>Park, Sungho, and Sachin Gupta. 2012. “Handling Endogenous Regressors by Joint Estimation Using Copulas.” <em>Marketing Science</em> 31 (4): 567–86. <a href="https://doi.org/10.1287/mksc.1120.0718">https://doi.org/10.1287/mksc.1120.0718</a>.</p>
</div>
<div id="ref-Silverman_1969">
<p>Silverman, B. W. 1969. <em>Density Estimation for Statistics and Data Analysis</em>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="measurement-error.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="proxy-variables.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/mikenguyen13/data_analysis/edit/main/08-endogeneity.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Data Analysis.pdf", "Data Analysis.epub", "Data Analysis.mobi"],
"toc": {
"collapse": "subsection",
"scroll_highlight": true,
"sharing": {
"facebook": true,
"github": true,
"twitter": true,
"linkedin": true
},
"info": true,
"edit": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
