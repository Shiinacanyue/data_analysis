<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>20.2 Principal Components | A Guide on Data Analysis</title>
  <meta name="description" content="This is a guide on how to conduct data analysis in the field of data science, statistics, or machine learning." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="20.2 Principal Components | A Guide on Data Analysis" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://bookdown.org/mike/data_analysis/" />
  <meta property="og:image" content="https://bookdown.org/mike/data_analysis//images/cover.jpg" />
  <meta property="og:description" content="This is a guide on how to conduct data analysis in the field of data science, statistics, or machine learning." />
  <meta name="github-repo" content="mikenguyen13/data_analysis" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="20.2 Principal Components | A Guide on Data Analysis" />
  
  <meta name="twitter:description" content="This is a guide on how to conduct data analysis in the field of data science, statistics, or machine learning." />
  <meta name="twitter:image" content="https://bookdown.org/mike/data_analysis//images/cover.jpg" />

<meta name="author" content="Mike Nguyen" />


<meta name="date" content="2022-09-24" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  <link rel="apple-touch-icon-precomposed" sizes="120x120" href="logo.png" />
  <link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<link rel="prev" href="manova.html"/>
<link rel="next" href="factor-analysis.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="libs/proj4js-2.3.15/proj4.js"></script>
<link href="libs/highcharts-9.3.1/css/motion.css" rel="stylesheet" />
<script src="libs/highcharts-9.3.1/highcharts.js"></script>
<script src="libs/highcharts-9.3.1/highcharts-3d.js"></script>
<script src="libs/highcharts-9.3.1/highcharts-more.js"></script>
<script src="libs/highcharts-9.3.1/modules/stock.js"></script>
<script src="libs/highcharts-9.3.1/modules/map.js"></script>
<script src="libs/highcharts-9.3.1/modules/data.js"></script>
<script src="libs/highcharts-9.3.1/modules/exporting.js"></script>
<script src="libs/highcharts-9.3.1/modules/offline-exporting.js"></script>
<script src="libs/highcharts-9.3.1/modules/drilldown.js"></script>
<script src="libs/highcharts-9.3.1/modules/item-series.js"></script>
<script src="libs/highcharts-9.3.1/modules/overlapping-datalabels.js"></script>
<script src="libs/highcharts-9.3.1/modules/annotations.js"></script>
<script src="libs/highcharts-9.3.1/modules/export-data.js"></script>
<script src="libs/highcharts-9.3.1/modules/funnel.js"></script>
<script src="libs/highcharts-9.3.1/modules/heatmap.js"></script>
<script src="libs/highcharts-9.3.1/modules/treemap.js"></script>
<script src="libs/highcharts-9.3.1/modules/sankey.js"></script>
<script src="libs/highcharts-9.3.1/modules/dependency-wheel.js"></script>
<script src="libs/highcharts-9.3.1/modules/organization.js"></script>
<script src="libs/highcharts-9.3.1/modules/solid-gauge.js"></script>
<script src="libs/highcharts-9.3.1/modules/streamgraph.js"></script>
<script src="libs/highcharts-9.3.1/modules/sunburst.js"></script>
<script src="libs/highcharts-9.3.1/modules/vector.js"></script>
<script src="libs/highcharts-9.3.1/modules/wordcloud.js"></script>
<script src="libs/highcharts-9.3.1/modules/xrange.js"></script>
<script src="libs/highcharts-9.3.1/modules/tilemap.js"></script>
<script src="libs/highcharts-9.3.1/modules/venn.js"></script>
<script src="libs/highcharts-9.3.1/modules/gantt.js"></script>
<script src="libs/highcharts-9.3.1/modules/timeline.js"></script>
<script src="libs/highcharts-9.3.1/modules/parallel-coordinates.js"></script>
<script src="libs/highcharts-9.3.1/modules/bullet.js"></script>
<script src="libs/highcharts-9.3.1/modules/coloraxis.js"></script>
<script src="libs/highcharts-9.3.1/modules/dumbbell.js"></script>
<script src="libs/highcharts-9.3.1/modules/lollipop.js"></script>
<script src="libs/highcharts-9.3.1/modules/series-label.js"></script>
<script src="libs/highcharts-9.3.1/plugins/motion.js"></script>
<script src="libs/highcharts-9.3.1/custom/reset.js"></script>
<script src="libs/highcharts-9.3.1/modules/boost.js"></script>
<script src="libs/highchart-binding-0.9.4/highchart.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=GA_MEASUREMENT_ID"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){window.dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-DMNX2X65HQ');
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Guide on Data Analysis</a></li>

<li class="divider"></li>
<li><a href="index.html#preface" id="toc-preface">Preface</a></li>
<li><a href="introduction.html#introduction" id="toc-introduction"><span class="toc-section-number">1</span> Introduction</a></li>
<li><a href="prerequisites.html#prerequisites" id="toc-prerequisites"><span class="toc-section-number">2</span> Prerequisites</a>
<ul>
<li><a href="matrix-theory.html#matrix-theory" id="toc-matrix-theory"><span class="toc-section-number">2.1</span> Matrix Theory</a>
<ul>
<li><a href="matrix-theory.html#rank" id="toc-rank"><span class="toc-section-number">2.1.1</span> Rank</a></li>
<li><a href="matrix-theory.html#inverse" id="toc-inverse"><span class="toc-section-number">2.1.2</span> Inverse</a></li>
<li><a href="matrix-theory.html#definiteness" id="toc-definiteness"><span class="toc-section-number">2.1.3</span> Definiteness</a></li>
<li><a href="matrix-theory.html#matrix-calculus" id="toc-matrix-calculus"><span class="toc-section-number">2.1.4</span> Matrix Calculus</a></li>
<li><a href="matrix-theory.html#optimization" id="toc-optimization"><span class="toc-section-number">2.1.5</span> Optimization</a></li>
</ul></li>
<li><a href="probability-theory.html#probability-theory" id="toc-probability-theory"><span class="toc-section-number">2.2</span> Probability Theory</a>
<ul>
<li><a href="probability-theory.html#axiom-and-theorems-of-probability" id="toc-axiom-and-theorems-of-probability"><span class="toc-section-number">2.2.1</span> Axiom and Theorems of Probability</a></li>
<li><a href="probability-theory.html#central-limit-theorem" id="toc-central-limit-theorem"><span class="toc-section-number">2.2.2</span> Central Limit Theorem</a></li>
<li><a href="probability-theory.html#random-variable" id="toc-random-variable"><span class="toc-section-number">2.2.3</span> Random variable</a></li>
<li><a href="probability-theory.html#moment-generating-function" id="toc-moment-generating-function"><span class="toc-section-number">2.2.4</span> Moment generating function</a></li>
<li><a href="probability-theory.html#moment" id="toc-moment"><span class="toc-section-number">2.2.5</span> Moment</a></li>
<li><a href="probability-theory.html#distributions" id="toc-distributions"><span class="toc-section-number">2.2.6</span> Distributions</a></li>
</ul></li>
<li><a href="general-math.html#general-math" id="toc-general-math"><span class="toc-section-number">2.3</span> General Math</a>
<ul>
<li><a href="general-math.html#number-sets" id="toc-number-sets"><span class="toc-section-number">2.3.1</span> Number Sets</a></li>
<li><a href="general-math.html#summation-notation-and-series" id="toc-summation-notation-and-series"><span class="toc-section-number">2.3.2</span> Summation Notation and Series</a></li>
<li><a href="general-math.html#law-of-large-numbers" id="toc-law-of-large-numbers"><span class="toc-section-number">2.3.3</span> Law of large numbers</a></li>
<li><a href="general-math.html#law-of-iterated-expectation" id="toc-law-of-iterated-expectation"><span class="toc-section-number">2.3.4</span> Law of Iterated Expectation</a></li>
<li><a href="general-math.html#convergence" id="toc-convergence"><span class="toc-section-number">2.3.5</span> Convergence</a></li>
<li><a href="general-math.html#sufficient-statistics" id="toc-sufficient-statistics"><span class="toc-section-number">2.3.6</span> Sufficient Statistics</a></li>
<li><a href="general-math.html#parameter-transformations" id="toc-parameter-transformations"><span class="toc-section-number">2.3.7</span> Parameter transformations</a></li>
</ul></li>
<li><a href="data-importexport.html#data-importexport" id="toc-data-importexport"><span class="toc-section-number">2.4</span> Data Import/Export</a>
<ul>
<li><a href="data-importexport.html#medium-size" id="toc-medium-size"><span class="toc-section-number">2.4.1</span> Medium size</a></li>
<li><a href="data-importexport.html#large-size" id="toc-large-size"><span class="toc-section-number">2.4.2</span> Large size</a></li>
</ul></li>
<li><a href="data-manipulation.html#data-manipulation" id="toc-data-manipulation"><span class="toc-section-number">2.5</span> Data Manipulation</a></li>
</ul></li>
<li><a href="#part-i.-basic" id="toc-part-i.-basic">(PART*) I. BASIC</a></li>
<li><a href="descriptive-stat.html#descriptive-stat" id="toc-descriptive-stat"><span class="toc-section-number">3</span> Descriptive Statistics</a>
<ul>
<li><a href="numerical-measures.html#numerical-measures" id="toc-numerical-measures"><span class="toc-section-number">3.1</span> Numerical Measures</a></li>
<li><a href="graphical-measures.html#graphical-measures" id="toc-graphical-measures"><span class="toc-section-number">3.2</span> Graphical Measures</a>
<ul>
<li><a href="graphical-measures.html#shape" id="toc-shape"><span class="toc-section-number">3.2.1</span> Shape</a></li>
<li><a href="graphical-measures.html#scatterplot" id="toc-scatterplot"><span class="toc-section-number">3.2.2</span> Scatterplot</a></li>
</ul></li>
<li><a href="normality-assessment.html#normality-assessment" id="toc-normality-assessment"><span class="toc-section-number">3.3</span> Normality Assessment</a>
<ul>
<li><a href="normality-assessment.html#graphical-assessment" id="toc-graphical-assessment"><span class="toc-section-number">3.3.1</span> Graphical Assessment</a></li>
<li><a href="normality-assessment.html#summary-statistics" id="toc-summary-statistics"><span class="toc-section-number">3.3.2</span> Summary Statistics</a></li>
</ul></li>
<li><a href="bivariate-statistics.html#bivariate-statistics" id="toc-bivariate-statistics"><span class="toc-section-number">3.4</span> Bivariate Statistics</a></li>
<li><a href="two-continuous.html#two-continuous" id="toc-two-continuous"><span class="toc-section-number">3.5</span> Two Continuous</a>
<ul>
<li><a href="two-continuous.html#pearson-correlation" id="toc-pearson-correlation"><span class="toc-section-number">3.5.1</span> Pearson Correlation</a></li>
<li><a href="two-continuous.html#spearman-correlation" id="toc-spearman-correlation"><span class="toc-section-number">3.5.2</span> Spearman Correlation</a></li>
</ul></li>
<li><a href="categorical-and-continuous.html#categorical-and-continuous" id="toc-categorical-and-continuous"><span class="toc-section-number">3.6</span> Categorical and Continuous</a>
<ul>
<li><a href="categorical-and-continuous.html#point-biserial-correlation" id="toc-point-biserial-correlation"><span class="toc-section-number">3.6.1</span> Point-Biserial Correlation</a></li>
<li><a href="categorical-and-continuous.html#logistic-regression" id="toc-logistic-regression"><span class="toc-section-number">3.6.2</span> Logistic Regression</a></li>
</ul></li>
<li><a href="two-discrete.html#two-discrete" id="toc-two-discrete"><span class="toc-section-number">3.7</span> Two Discrete</a>
<ul>
<li><a href="two-discrete.html#distance-metrics" id="toc-distance-metrics"><span class="toc-section-number">3.7.1</span> Distance Metrics</a></li>
<li><a href="two-discrete.html#statistical-metrics" id="toc-statistical-metrics"><span class="toc-section-number">3.7.2</span> Statistical Metrics</a></li>
<li><a href="two-discrete.html#ordinal-association-rank-correlation" id="toc-ordinal-association-rank-correlation"><span class="toc-section-number">3.7.3</span> Ordinal Association (Rank correlation)</a></li>
<li><a href="two-discrete.html#summary-1" id="toc-summary-1"><span class="toc-section-number">3.7.4</span> Summary</a></li>
<li><a href="two-discrete.html#visualization" id="toc-visualization"><span class="toc-section-number">3.7.5</span> Visualization</a></li>
</ul></li>
</ul></li>
<li><a href="basic-statistical-inference.html#basic-statistical-inference" id="toc-basic-statistical-inference"><span class="toc-section-number">4</span> Basic Statistical Inference</a>
<ul>
<li><a href="one-sample-inference.html#one-sample-inference" id="toc-one-sample-inference"><span class="toc-section-number">4.1</span> One Sample Inference</a>
<ul>
<li><a href="one-sample-inference.html#the-mean" id="toc-the-mean"><span class="toc-section-number">4.1.1</span> The Mean</a></li>
<li><a href="one-sample-inference.html#single-variance" id="toc-single-variance"><span class="toc-section-number">4.1.2</span> Single Variance</a></li>
<li><a href="one-sample-inference.html#single-proportion-p" id="toc-single-proportion-p"><span class="toc-section-number">4.1.3</span> Single Proportion (p)</a></li>
<li><a href="one-sample-inference.html#power" id="toc-power"><span class="toc-section-number">4.1.4</span> Power</a></li>
<li><a href="one-sample-inference.html#sample-size" id="toc-sample-size"><span class="toc-section-number">4.1.5</span> Sample Size</a></li>
<li><a href="one-sample-inference.html#note" id="toc-note"><span class="toc-section-number">4.1.6</span> Note</a></li>
<li><a href="one-sample-inference.html#one-sample-non-parametric-methods" id="toc-one-sample-non-parametric-methods"><span class="toc-section-number">4.1.7</span> One-sample Non-parametric Methods</a></li>
</ul></li>
<li><a href="two-sample-inference.html#two-sample-inference" id="toc-two-sample-inference"><span class="toc-section-number">4.2</span> Two Sample Inference</a>
<ul>
<li><a href="two-sample-inference.html#means" id="toc-means"><span class="toc-section-number">4.2.1</span> Means</a></li>
<li><a href="two-sample-inference.html#variances" id="toc-variances"><span class="toc-section-number">4.2.2</span> Variances</a></li>
<li><a href="two-sample-inference.html#power-1" id="toc-power-1"><span class="toc-section-number">4.2.3</span> Power</a></li>
<li><a href="two-sample-inference.html#sample-size-1" id="toc-sample-size-1"><span class="toc-section-number">4.2.4</span> Sample Size</a></li>
<li><a href="two-sample-inference.html#matched-pair-designs" id="toc-matched-pair-designs"><span class="toc-section-number">4.2.5</span> Matched Pair Designs</a></li>
<li><a href="two-sample-inference.html#nonparametric-tests-for-two-samples" id="toc-nonparametric-tests-for-two-samples"><span class="toc-section-number">4.2.6</span> Nonparametric Tests for Two Samples</a></li>
</ul></li>
<li><a href="categorical-data-analysis.html#categorical-data-analysis" id="toc-categorical-data-analysis"><span class="toc-section-number">4.3</span> Categorical Data Analysis</a>
<ul>
<li><a href="categorical-data-analysis.html#inferences-for-small-samples" id="toc-inferences-for-small-samples"><span class="toc-section-number">4.3.1</span> Inferences for Small Samples</a></li>
<li><a href="categorical-data-analysis.html#test-of-association" id="toc-test-of-association"><span class="toc-section-number">4.3.2</span> Test of Association</a></li>
<li><a href="categorical-data-analysis.html#ordinal-association" id="toc-ordinal-association"><span class="toc-section-number">4.3.3</span> Ordinal Association</a></li>
</ul></li>
<li><a href="divergence-metrics-and-test-for-comparing-distributions.html#divergence-metrics-and-test-for-comparing-distributions" id="toc-divergence-metrics-and-test-for-comparing-distributions"><span class="toc-section-number">4.4</span> Divergence Metrics and Test for Comparing Distributions</a>
<ul>
<li><a href="divergence-metrics-and-test-for-comparing-distributions.html#kullback-leibler-divergence" id="toc-kullback-leibler-divergence"><span class="toc-section-number">4.4.1</span> Kullback-Leibler Divergence</a></li>
<li><a href="divergence-metrics-and-test-for-comparing-distributions.html#jensen-shannon-divergence" id="toc-jensen-shannon-divergence"><span class="toc-section-number">4.4.2</span> Jensen-Shannon Divergence</a></li>
<li><a href="divergence-metrics-and-test-for-comparing-distributions.html#wasserstein-distance" id="toc-wasserstein-distance"><span class="toc-section-number">4.4.3</span> Wasserstein Distance</a></li>
<li><a href="divergence-metrics-and-test-for-comparing-distributions.html#kolmogorov-smirnov-test-1" id="toc-kolmogorov-smirnov-test-1"><span class="toc-section-number">4.4.4</span> Kolmogorov-Smirnov Test</a></li>
</ul></li>
</ul></li>
<li><a href="#part-ii.-regression" id="toc-part-ii.-regression">(PART*) II. REGRESSION</a></li>
<li><a href="linear-regression.html#linear-regression" id="toc-linear-regression"><span class="toc-section-number">5</span> Linear Regression</a>
<ul>
<li><a href="ordinary-least-squares.html#ordinary-least-squares" id="toc-ordinary-least-squares"><span class="toc-section-number">5.1</span> Ordinary Least Squares</a>
<ul>
<li><a href="ordinary-least-squares.html#simple-regression-basic-model" id="toc-simple-regression-basic-model"><span class="toc-section-number">5.1.1</span> Simple Regression (Basic Model)</a></li>
<li><a href="ordinary-least-squares.html#multiple-linear-regression" id="toc-multiple-linear-regression"><span class="toc-section-number">5.1.2</span> Multiple Linear Regression</a></li>
<li><a href="ordinary-least-squares.html#ols-assumptions" id="toc-ols-assumptions"><span class="toc-section-number">5.1.3</span> OLS Assumptions</a></li>
<li><a href="ordinary-least-squares.html#theorems" id="toc-theorems"><span class="toc-section-number">5.1.4</span> Theorems</a></li>
<li><a href="ordinary-least-squares.html#variable-selection" id="toc-variable-selection"><span class="toc-section-number">5.1.5</span> Variable Selection</a></li>
<li><a href="ordinary-least-squares.html#diagnostics-1" id="toc-diagnostics-1"><span class="toc-section-number">5.1.6</span> Diagnostics</a></li>
<li><a href="ordinary-least-squares.html#model-validation" id="toc-model-validation"><span class="toc-section-number">5.1.7</span> Model Validation</a></li>
<li><a href="ordinary-least-squares.html#finite-sample-properties" id="toc-finite-sample-properties"><span class="toc-section-number">5.1.8</span> Finite Sample Properties</a></li>
<li><a href="ordinary-least-squares.html#large-sample-properties" id="toc-large-sample-properties"><span class="toc-section-number">5.1.9</span> Large Sample Properties</a></li>
</ul></li>
<li><a href="feasible-generalized-least-squares.html#feasible-generalized-least-squares" id="toc-feasible-generalized-least-squares"><span class="toc-section-number">5.2</span> Feasible Generalized Least Squares</a>
<ul>
<li><a href="feasible-generalized-least-squares.html#heteroskedasticity" id="toc-heteroskedasticity"><span class="toc-section-number">5.2.1</span> Heteroskedasticity</a></li>
<li><a href="feasible-generalized-least-squares.html#serial-correlation" id="toc-serial-correlation"><span class="toc-section-number">5.2.2</span> Serial Correlation</a></li>
</ul></li>
<li><a href="weighted-least-squares.html#weighted-least-squares" id="toc-weighted-least-squares"><span class="toc-section-number">5.3</span> Weighted Least Squares</a></li>
<li><a href="generalized-least-squares.html#generalized-least-squares" id="toc-generalized-least-squares"><span class="toc-section-number">5.4</span> Generalized Least Squares</a></li>
<li><a href="feasiable-prais-winsten.html#feasiable-prais-winsten" id="toc-feasiable-prais-winsten"><span class="toc-section-number">5.5</span> Feasiable Prais Winsten</a></li>
<li><a href="feasible-group-level-random-effects.html#feasible-group-level-random-effects" id="toc-feasible-group-level-random-effects"><span class="toc-section-number">5.6</span> Feasible group level Random Effects</a></li>
<li><a href="ridge-regression.html#ridge-regression" id="toc-ridge-regression"><span class="toc-section-number">5.7</span> Ridge Regression</a></li>
<li><a href="principal-component-regression.html#principal-component-regression" id="toc-principal-component-regression"><span class="toc-section-number">5.8</span> Principal Component Regression</a></li>
<li><a href="robust-regression.html#robust-regression" id="toc-robust-regression"><span class="toc-section-number">5.9</span> Robust Regression</a>
<ul>
<li><a href="robust-regression.html#least-absolute-residuals-lar-regression" id="toc-least-absolute-residuals-lar-regression"><span class="toc-section-number">5.9.1</span> Least Absolute Residuals (LAR) Regression</a></li>
<li><a href="robust-regression.html#least-median-of-squares-lms-regression" id="toc-least-median-of-squares-lms-regression"><span class="toc-section-number">5.9.2</span> Least Median of Squares (LMS) Regression</a></li>
<li><a href="robust-regression.html#iteratively-reweighted-least-squares-irls-robust-regression" id="toc-iteratively-reweighted-least-squares-irls-robust-regression"><span class="toc-section-number">5.9.3</span> Iteratively Reweighted Least Squares (IRLS) Robust Regression</a></li>
</ul></li>
<li><a href="maximum-likelihood-regression.html#maximum-likelihood-regression" id="toc-maximum-likelihood-regression"><span class="toc-section-number">5.10</span> Maximum Likelihood</a>
<ul>
<li><a href="maximum-likelihood-regression.html#motivation-for-mle" id="toc-motivation-for-mle"><span class="toc-section-number">5.10.1</span> Motivation for MLE</a></li>
<li><a href="maximum-likelihood-regression.html#assumption" id="toc-assumption"><span class="toc-section-number">5.10.2</span> Assumption</a></li>
<li><a href="maximum-likelihood-regression.html#properties" id="toc-properties"><span class="toc-section-number">5.10.3</span> Properties</a></li>
<li><a href="maximum-likelihood-regression.html#compare-to-ols" id="toc-compare-to-ols"><span class="toc-section-number">5.10.4</span> Compare to OLS</a></li>
<li><a href="maximum-likelihood-regression.html#application" id="toc-application"><span class="toc-section-number">5.10.5</span> Application</a></li>
</ul></li>
</ul></li>
<li><a href="non-linear-regression.html#non-linear-regression" id="toc-non-linear-regression"><span class="toc-section-number">6</span> Non-linear Regression</a>
<ul>
<li><a href="inference-1.html#inference-1" id="toc-inference-1"><span class="toc-section-number">6.1</span> Inference</a>
<ul>
<li><a href="inference-1.html#linear-function-of-the-parameters" id="toc-linear-function-of-the-parameters"><span class="toc-section-number">6.1.1</span> Linear Function of the Parameters</a></li>
<li><a href="inference-1.html#nonlinear" id="toc-nonlinear"><span class="toc-section-number">6.1.2</span> Nonlinear</a></li>
</ul></li>
<li><a href="non-linear-least-squares.html#non-linear-least-squares" id="toc-non-linear-least-squares"><span class="toc-section-number">6.2</span> Non-linear Least Squares</a>
<ul>
<li><a href="non-linear-least-squares.html#alternative-of-gauss-newton-algorithm" id="toc-alternative-of-gauss-newton-algorithm"><span class="toc-section-number">6.2.1</span> Alternative of Gauss-Newton Algorithm</a></li>
<li><a href="non-linear-least-squares.html#practical-considerations" id="toc-practical-considerations"><span class="toc-section-number">6.2.2</span> Practical Considerations</a></li>
<li><a href="non-linear-least-squares.html#modelestiamtion-adequcy" id="toc-modelestiamtion-adequcy"><span class="toc-section-number">6.2.3</span> Model/Estiamtion Adequcy</a></li>
<li><a href="non-linear-least-squares.html#application-1" id="toc-application-1"><span class="toc-section-number">6.2.4</span> Application</a></li>
</ul></li>
</ul></li>
<li><a href="generalized-linear-models.html#generalized-linear-models" id="toc-generalized-linear-models"><span class="toc-section-number">7</span> Generalized Linear Models</a>
<ul>
<li><a href="logistic-regression-1.html#logistic-regression-1" id="toc-logistic-regression-1"><span class="toc-section-number">7.1</span> Logistic Regression</a>
<ul>
<li><a href="logistic-regression-1.html#application-2" id="toc-application-2"><span class="toc-section-number">7.1.1</span> Application</a></li>
</ul></li>
<li><a href="probit-regression.html#probit-regression" id="toc-probit-regression"><span class="toc-section-number">7.2</span> Probit Regression</a></li>
<li><a href="binomial-regression.html#binomial-regression" id="toc-binomial-regression"><span class="toc-section-number">7.3</span> Binomial Regression</a></li>
<li><a href="poisson-regression.html#poisson-regression" id="toc-poisson-regression"><span class="toc-section-number">7.4</span> Poisson Regression</a>
<ul>
<li><a href="poisson-regression.html#application-3" id="toc-application-3"><span class="toc-section-number">7.4.1</span> Application</a></li>
</ul></li>
<li><a href="negative-binomial-regression.html#negative-binomial-regression" id="toc-negative-binomial-regression"><span class="toc-section-number">7.5</span> Negative Binomial Regression</a></li>
<li><a href="multinomial.html#multinomial" id="toc-multinomial"><span class="toc-section-number">7.6</span> Multinomial</a></li>
<li><a href="generalization.html#generalization" id="toc-generalization"><span class="toc-section-number">7.7</span> Generalization</a>
<ul>
<li><a href="generalization.html#estimation-1" id="toc-estimation-1"><span class="toc-section-number">7.7.1</span> Estimation</a></li>
<li><a href="generalization.html#inference-2" id="toc-inference-2"><span class="toc-section-number">7.7.2</span> Inference</a></li>
<li><a href="generalization.html#deviance" id="toc-deviance"><span class="toc-section-number">7.7.3</span> Deviance</a></li>
<li><a href="generalization.html#diagnostic-plots" id="toc-diagnostic-plots"><span class="toc-section-number">7.7.4</span> Diagnostic Plots</a></li>
<li><a href="generalization.html#goodness-of-fit" id="toc-goodness-of-fit"><span class="toc-section-number">7.7.5</span> Goodness of Fit</a></li>
<li><a href="generalization.html#over-dispersion" id="toc-over-dispersion"><span class="toc-section-number">7.7.6</span> Over-Dispersion</a></li>
</ul></li>
</ul></li>
<li><a href="linear-mixed-models.html#linear-mixed-models" id="toc-linear-mixed-models"><span class="toc-section-number">8</span> Linear Mixed Models</a>
<ul>
<li><a href="dependent-data.html#dependent-data" id="toc-dependent-data"><span class="toc-section-number">8.1</span> Dependent Data</a>
<ul>
<li><a href="dependent-data.html#random-intercepts-model" id="toc-random-intercepts-model"><span class="toc-section-number">8.1.1</span> Random-Intercepts Model</a></li>
<li><a href="dependent-data.html#covariance-models" id="toc-covariance-models"><span class="toc-section-number">8.1.2</span> Covariance Models</a></li>
</ul></li>
<li><a href="estimation-2.html#estimation-2" id="toc-estimation-2"><span class="toc-section-number">8.2</span> Estimation</a>
<ul>
<li><a href="estimation-2.html#estimating-mathbfv" id="toc-estimating-mathbfv"><span class="toc-section-number">8.2.1</span> Estimating <span class="math inline">\(\mathbf{V}\)</span></a></li>
</ul></li>
<li><a href="inference-3.html#inference-3" id="toc-inference-3"><span class="toc-section-number">8.3</span> Inference</a>
<ul>
<li><a href="inference-3.html#parameters-beta" id="toc-parameters-beta"><span class="toc-section-number">8.3.1</span> Parameters <span class="math inline">\(\beta\)</span></a></li>
<li><a href="inference-3.html#variance-components" id="toc-variance-components"><span class="toc-section-number">8.3.2</span> Variance Components</a></li>
</ul></li>
<li><a href="information-criteria.html#information-criteria" id="toc-information-criteria"><span class="toc-section-number">8.4</span> Information Criteria</a>
<ul>
<li><a href="information-criteria.html#akaikes-information-criteria-aic" id="toc-akaikes-information-criteria-aic"><span class="toc-section-number">8.4.1</span> Akaike’s Information Criteria (AIC)</a></li>
<li><a href="information-criteria.html#corrected-aic-aicc" id="toc-corrected-aic-aicc"><span class="toc-section-number">8.4.2</span> Corrected AIC (AICC)</a></li>
<li><a href="information-criteria.html#bayesian-information-criteria-bic" id="toc-bayesian-information-criteria-bic"><span class="toc-section-number">8.4.3</span> Bayesian Information Criteria (BIC)</a></li>
</ul></li>
<li><a href="split-plot-designs.html#split-plot-designs" id="toc-split-plot-designs"><span class="toc-section-number">8.5</span> Split-Plot Designs</a>
<ul>
<li><a href="split-plot-designs.html#application-4" id="toc-application-4"><span class="toc-section-number">8.5.1</span> Application</a></li>
</ul></li>
<li><a href="repeated-measures-in-mixed-models.html#repeated-measures-in-mixed-models" id="toc-repeated-measures-in-mixed-models"><span class="toc-section-number">8.6</span> Repeated Measures in Mixed Models</a></li>
<li><a href="unbalanced-or-unequally-spaced-data.html#unbalanced-or-unequally-spaced-data" id="toc-unbalanced-or-unequally-spaced-data"><span class="toc-section-number">8.7</span> Unbalanced or Unequally Spaced Data</a></li>
<li><a href="application-5.html#application-5" id="toc-application-5"><span class="toc-section-number">8.8</span> Application</a>
<ul>
<li><a href="application-5.html#example-1-pulps" id="toc-example-1-pulps"><span class="toc-section-number">8.8.1</span> Example 1 (Pulps)</a></li>
<li><a href="application-5.html#example-2-rats" id="toc-example-2-rats"><span class="toc-section-number">8.8.2</span> Example 2 (Rats)</a></li>
<li><a href="application-5.html#example-3-agridat" id="toc-example-3-agridat"><span class="toc-section-number">8.8.3</span> Example 3 (Agridat)</a></li>
</ul></li>
</ul></li>
<li><a href="nonlinear-and-generalized-linear-mixed-models.html#nonlinear-and-generalized-linear-mixed-models" id="toc-nonlinear-and-generalized-linear-mixed-models"><span class="toc-section-number">9</span> Nonlinear and Generalized Linear Mixed Models</a>
<ul>
<li><a href="estimation-3.html#estimation-3" id="toc-estimation-3"><span class="toc-section-number">9.1</span> Estimation</a>
<ul>
<li><a href="estimation-3.html#estimation-by-numerical-integration" id="toc-estimation-by-numerical-integration"><span class="toc-section-number">9.1.1</span> Estimation by Numerical Integration</a></li>
<li><a href="estimation-3.html#estimation-by-linearization" id="toc-estimation-by-linearization"><span class="toc-section-number">9.1.2</span> Estimation by Linearization</a></li>
<li><a href="estimation-3.html#estimation-by-bayesian-hierarchical-models" id="toc-estimation-by-bayesian-hierarchical-models"><span class="toc-section-number">9.1.3</span> Estimation by Bayesian Hierarchical Models</a></li>
</ul></li>
<li><a href="application-6.html#application-6" id="toc-application-6"><span class="toc-section-number">9.2</span> Application</a>
<ul>
<li><a href="application-6.html#binomial-cbpp-data" id="toc-binomial-cbpp-data"><span class="toc-section-number">9.2.1</span> Binomial (CBPP Data)</a></li>
<li><a href="application-6.html#count-owl-data" id="toc-count-owl-data"><span class="toc-section-number">9.2.2</span> Count (Owl Data)</a></li>
<li><a href="application-6.html#binomial-1" id="toc-binomial-1"><span class="toc-section-number">9.2.3</span> Binomial</a></li>
<li><a href="application-6.html#example-from-schabenberger_2001-section-8.4.1" id="toc-example-from-schabenberger_2001-section-8.4.1"><span class="toc-section-number">9.2.4</span> Example from <span class="citation">(<span>Schabenberger and Pierce 2001</span>)</span> section 8.4.1</a></li>
</ul></li>
<li><a href="summary-2.html#summary-2" id="toc-summary-2"><span class="toc-section-number">9.3</span> Summary</a></li>
</ul></li>
<li><a href="#part-iii.-ramifications" id="toc-part-iii.-ramifications">(PART*) III. RAMIFICATIONS</a></li>
<li><a href="model-specification.html#model-specification" id="toc-model-specification"><span class="toc-section-number">10</span> Model Specification</a>
<ul>
<li><a href="nested-model.html#nested-model" id="toc-nested-model"><span class="toc-section-number">10.1</span> Nested Model</a>
<ul>
<li><a href="nested-model.html#chow-test" id="toc-chow-test"><span class="toc-section-number">10.1.1</span> Chow test</a></li>
</ul></li>
<li><a href="non-nested-model.html#non-nested-model" id="toc-non-nested-model"><span class="toc-section-number">10.2</span> Non-Nested Model</a>
<ul>
<li><a href="non-nested-model.html#davidson-mackinnon-test" id="toc-davidson-mackinnon-test"><span class="toc-section-number">10.2.1</span> Davidson-Mackinnon test</a></li>
</ul></li>
<li><a href="heteroskedasticity-1.html#heteroskedasticity-1" id="toc-heteroskedasticity-1"><span class="toc-section-number">10.3</span> Heteroskedasticity</a>
<ul>
<li><a href="heteroskedasticity-1.html#breusch-pagan-test" id="toc-breusch-pagan-test"><span class="toc-section-number">10.3.1</span> Breusch-Pagan test</a></li>
<li><a href="heteroskedasticity-1.html#white-test" id="toc-white-test"><span class="toc-section-number">10.3.2</span> White test</a></li>
</ul></li>
</ul></li>
<li><a href="imputation-missing-data.html#imputation-missing-data" id="toc-imputation-missing-data"><span class="toc-section-number">11</span> Imputation (Missing Data)</a>
<ul>
<li><a href="assumptions-1.html#assumptions-1" id="toc-assumptions-1"><span class="toc-section-number">11.1</span> Assumptions</a>
<ul>
<li><a href="assumptions-1.html#missing-completely-at-random-mcar" id="toc-missing-completely-at-random-mcar"><span class="toc-section-number">11.1.1</span> Missing Completely at Random (MCAR)</a></li>
<li><a href="assumptions-1.html#missing-at-random-mar" id="toc-missing-at-random-mar"><span class="toc-section-number">11.1.2</span> Missing at Random (MAR)</a></li>
<li><a href="assumptions-1.html#ignorable" id="toc-ignorable"><span class="toc-section-number">11.1.3</span> Ignorable</a></li>
<li><a href="assumptions-1.html#nonignorable" id="toc-nonignorable"><span class="toc-section-number">11.1.4</span> Nonignorable</a></li>
</ul></li>
<li><a href="solutions-to-missing-data.html#solutions-to-missing-data" id="toc-solutions-to-missing-data"><span class="toc-section-number">11.2</span> Solutions to Missing data</a>
<ul>
<li><a href="solutions-to-missing-data.html#listwise-deletion" id="toc-listwise-deletion"><span class="toc-section-number">11.2.1</span> Listwise Deletion</a></li>
<li><a href="solutions-to-missing-data.html#pairwise-deletion" id="toc-pairwise-deletion"><span class="toc-section-number">11.2.2</span> Pairwise Deletion</a></li>
<li><a href="solutions-to-missing-data.html#dummy-variable-adjustment" id="toc-dummy-variable-adjustment"><span class="toc-section-number">11.2.3</span> Dummy Variable Adjustment</a></li>
<li><a href="solutions-to-missing-data.html#imputation" id="toc-imputation"><span class="toc-section-number">11.2.4</span> Imputation</a></li>
<li><a href="solutions-to-missing-data.html#other-methods" id="toc-other-methods"><span class="toc-section-number">11.2.5</span> Other methods</a></li>
</ul></li>
<li><a href="criteria-for-choosing-an-effective-approach.html#criteria-for-choosing-an-effective-approach" id="toc-criteria-for-choosing-an-effective-approach"><span class="toc-section-number">11.3</span> Criteria for Choosing an Effective Approach</a></li>
<li><a href="another-perspective.html#another-perspective" id="toc-another-perspective"><span class="toc-section-number">11.4</span> Another Perspective</a></li>
<li><a href="diagnosing-the-mechanism.html#diagnosing-the-mechanism" id="toc-diagnosing-the-mechanism"><span class="toc-section-number">11.5</span> Diagnosing the Mechanism</a>
<ul>
<li><a href="diagnosing-the-mechanism.html#mar-vs.-mnar" id="toc-mar-vs.-mnar"><span class="toc-section-number">11.5.1</span> MAR vs. MNAR</a></li>
<li><a href="diagnosing-the-mechanism.html#mcar-vs.-mar" id="toc-mcar-vs.-mar"><span class="toc-section-number">11.5.2</span> MCAR vs. MAR</a></li>
</ul></li>
<li><a href="application-7.html#application-7" id="toc-application-7"><span class="toc-section-number">11.6</span> Application</a>
<ul>
<li><a href="application-7.html#imputation-with-mean-median-mode" id="toc-imputation-with-mean-median-mode"><span class="toc-section-number">11.6.1</span> Imputation with mean / median / mode</a></li>
<li><a href="application-7.html#knn" id="toc-knn"><span class="toc-section-number">11.6.2</span> KNN</a></li>
<li><a href="application-7.html#rpart" id="toc-rpart"><span class="toc-section-number">11.6.3</span> rpart</a></li>
<li><a href="application-7.html#mice-multivariate-imputation-via-chained-equations" id="toc-mice-multivariate-imputation-via-chained-equations"><span class="toc-section-number">11.6.4</span> MICE (Multivariate Imputation via Chained Equations)</a></li>
<li><a href="application-7.html#amelia" id="toc-amelia"><span class="toc-section-number">11.6.5</span> Amelia</a></li>
<li><a href="application-7.html#missforest" id="toc-missforest"><span class="toc-section-number">11.6.6</span> missForest</a></li>
<li><a href="application-7.html#hmisc" id="toc-hmisc"><span class="toc-section-number">11.6.7</span> Hmisc</a></li>
<li><a href="application-7.html#mi" id="toc-mi"><span class="toc-section-number">11.6.8</span> mi</a></li>
</ul></li>
</ul></li>
<li><a href="data.html#data" id="toc-data"><span class="toc-section-number">12</span> Data</a>
<ul>
<li><a href="cross-sectional.html#cross-sectional" id="toc-cross-sectional"><span class="toc-section-number">12.1</span> Cross-Sectional</a></li>
<li><a href="time-series-1.html#time-series-1" id="toc-time-series-1"><span class="toc-section-number">12.2</span> Time Series</a>
<ul>
<li><a href="time-series-1.html#deterministic-time-trend" id="toc-deterministic-time-trend"><span class="toc-section-number">12.2.1</span> Deterministic Time trend</a></li>
<li><a href="time-series-1.html#feedback-effect" id="toc-feedback-effect"><span class="toc-section-number">12.2.2</span> Feedback Effect</a></li>
<li><a href="time-series-1.html#dynamic-specification" id="toc-dynamic-specification"><span class="toc-section-number">12.2.3</span> Dynamic Specification</a></li>
<li><a href="time-series-1.html#dynamically-complete" id="toc-dynamically-complete"><span class="toc-section-number">12.2.4</span> Dynamically Complete</a></li>
<li><a href="time-series-1.html#highly-persistent-data" id="toc-highly-persistent-data"><span class="toc-section-number">12.2.5</span> Highly Persistent Data</a></li>
</ul></li>
<li><a href="repeated-cross-sections.html#repeated-cross-sections" id="toc-repeated-cross-sections"><span class="toc-section-number">12.3</span> Repeated Cross Sections</a>
<ul>
<li><a href="repeated-cross-sections.html#pooled-cross-section" id="toc-pooled-cross-section"><span class="toc-section-number">12.3.1</span> Pooled Cross Section</a></li>
</ul></li>
<li><a href="panel-data.html#panel-data" id="toc-panel-data"><span class="toc-section-number">12.4</span> Panel Data</a>
<ul>
<li><a href="panel-data.html#pooled-ols-estimator" id="toc-pooled-ols-estimator"><span class="toc-section-number">12.4.1</span> Pooled OLS Estimator</a></li>
<li><a href="panel-data.html#individual-specific-effects-model" id="toc-individual-specific-effects-model"><span class="toc-section-number">12.4.2</span> Individual-specific effects model</a></li>
<li><a href="panel-data.html#tests-for-assumptions" id="toc-tests-for-assumptions"><span class="toc-section-number">12.4.3</span> Tests for Assumptions</a></li>
<li><a href="panel-data.html#model-selection" id="toc-model-selection"><span class="toc-section-number">12.4.4</span> Model Selection</a></li>
<li><a href="panel-data.html#summary-3" id="toc-summary-3"><span class="toc-section-number">12.4.5</span> Summary</a></li>
<li><a href="panel-data.html#application-8" id="toc-application-8"><span class="toc-section-number">12.4.6</span> Application</a></li>
<li><a href="panel-data.html#other-estimators" id="toc-other-estimators"><span class="toc-section-number">12.4.7</span> Other Estimators</a></li>
</ul></li>
</ul></li>
<li><a href="hypothesis-testing.html#hypothesis-testing" id="toc-hypothesis-testing"><span class="toc-section-number">13</span> Hypothesis Testing</a>
<ul>
<li><a href="types-of-hypothesis-testing.html#types-of-hypothesis-testing" id="toc-types-of-hypothesis-testing"><span class="toc-section-number">13.1</span> Types of hypothesis testing</a></li>
<li><a href="wald-test.html#wald-test" id="toc-wald-test"><span class="toc-section-number">13.2</span> Wald test</a>
<ul>
<li><a href="wald-test.html#multiple-hypothesis" id="toc-multiple-hypothesis"><span class="toc-section-number">13.2.1</span> Multiple Hypothesis</a></li>
<li><a href="wald-test.html#linear-combination" id="toc-linear-combination"><span class="toc-section-number">13.2.2</span> Linear Combination</a></li>
<li><a href="wald-test.html#estimate-difference-in-coefficients" id="toc-estimate-difference-in-coefficients"><span class="toc-section-number">13.2.3</span> Estimate Difference in Coefficients</a></li>
<li><a href="wald-test.html#application-9" id="toc-application-9"><span class="toc-section-number">13.2.4</span> Application</a></li>
<li><a href="wald-test.html#nonlinear-1" id="toc-nonlinear-1"><span class="toc-section-number">13.2.5</span> Nonlinear</a></li>
</ul></li>
<li><a href="the-likelihood-ratio-test.html#the-likelihood-ratio-test" id="toc-the-likelihood-ratio-test"><span class="toc-section-number">13.3</span> The likelihood ratio test</a></li>
<li><a href="lagrange-multiplier-score.html#lagrange-multiplier-score" id="toc-lagrange-multiplier-score"><span class="toc-section-number">13.4</span> Lagrange Multiplier (Score)</a></li>
</ul></li>
<li><a href="prediction-and-estimation.html#prediction-and-estimation" id="toc-prediction-and-estimation"><span class="toc-section-number">14</span> Prediction and Estimation</a></li>
<li><a href="moderation.html#moderation" id="toc-moderation"><span class="toc-section-number">15</span> Moderation</a>
<ul>
<li><a href="emmeans-package.html#emmeans-package" id="toc-emmeans-package"><span class="toc-section-number">15.1</span> emmeans package</a>
<ul>
<li><a href="emmeans-package.html#continuous-by-continuous" id="toc-continuous-by-continuous"><span class="toc-section-number">15.1.1</span> Continuous by continuous</a></li>
<li><a href="emmeans-package.html#continuous-by-categorical" id="toc-continuous-by-categorical"><span class="toc-section-number">15.1.2</span> Continuous by categorical</a></li>
<li><a href="emmeans-package.html#categorical-by-categorical" id="toc-categorical-by-categorical"><span class="toc-section-number">15.1.3</span> Categorical by categorical</a></li>
</ul></li>
<li><a href="probmod-package.html#probmod-package" id="toc-probmod-package"><span class="toc-section-number">15.2</span> probmod package</a></li>
<li><a href="interactions-package.html#interactions-package" id="toc-interactions-package"><span class="toc-section-number">15.3</span> interactions package</a>
<ul>
<li><a href="interactions-package.html#continuous-interaction" id="toc-continuous-interaction"><span class="toc-section-number">15.3.1</span> Continuous interaction</a></li>
<li><a href="interactions-package.html#categorical-interaction" id="toc-categorical-interaction"><span class="toc-section-number">15.3.2</span> Categorical interaction</a></li>
</ul></li>
<li><a href="interactionr-package.html#interactionr-package" id="toc-interactionr-package"><span class="toc-section-number">15.4</span> interactionR package</a></li>
<li><a href="sjplot-package.html#sjplot-package" id="toc-sjplot-package"><span class="toc-section-number">15.5</span> sjPlot package</a></li>
</ul></li>
<li><a href="#part-iv.-causal-inference" id="toc-part-iv.-causal-inference">(PART*) IV. CAUSAL INFERENCE</a></li>
<li><a href="causal-inference.html#causal-inference" id="toc-causal-inference"><span class="toc-section-number">16</span> Causal Inference</a>
<ul>
<li><a href="treatment-effect-types.html#treatment-effect-types" id="toc-treatment-effect-types"><span class="toc-section-number">16.1</span> Treatment effect types</a>
<ul>
<li><a href="treatment-effect-types.html#average-treatment-effects" id="toc-average-treatment-effects"><span class="toc-section-number">16.1.1</span> Average Treatment Effects</a></li>
<li><a href="treatment-effect-types.html#conditional-average-treatment-effects" id="toc-conditional-average-treatment-effects"><span class="toc-section-number">16.1.2</span> Conditional Average Treatment Effects</a></li>
<li><a href="treatment-effect-types.html#intent-to-treat-effects" id="toc-intent-to-treat-effects"><span class="toc-section-number">16.1.3</span> Intent-to-treat Effects</a></li>
<li><a href="treatment-effect-types.html#local-average-treatment-effects" id="toc-local-average-treatment-effects"><span class="toc-section-number">16.1.4</span> Local Average Treatment Effects</a></li>
<li><a href="treatment-effect-types.html#population-vs.-sample-average-treatment-effects" id="toc-population-vs.-sample-average-treatment-effects"><span class="toc-section-number">16.1.5</span> Population vs. Sample Average Treatment Effects</a></li>
<li><a href="treatment-effect-types.html#average-treatment-effects-on-the-treated-and-control" id="toc-average-treatment-effects-on-the-treated-and-control"><span class="toc-section-number">16.1.6</span> Average Treatment Effects on the Treated and Control</a></li>
<li><a href="treatment-effect-types.html#quantile-average-treatment-effects" id="toc-quantile-average-treatment-effects"><span class="toc-section-number">16.1.7</span> Quantile Average Treatment Effects</a></li>
<li><a href="treatment-effect-types.html#mediation-effects" id="toc-mediation-effects"><span class="toc-section-number">16.1.8</span> Mediation Effects</a></li>
<li><a href="treatment-effect-types.html#log-odds-treatment-effects" id="toc-log-odds-treatment-effects"><span class="toc-section-number">16.1.9</span> Log-odds Treatment Effects</a></li>
</ul></li>
</ul></li>
<li><a href="#part-a.-experimental-design" id="toc-part-a.-experimental-design">(PART*) A. EXPERIMENTAL DESIGN</a></li>
<li><a href="experimental-design.html#experimental-design" id="toc-experimental-design"><span class="toc-section-number">17</span> Experimental Design</a>
<ul>
<li><a href="semi-random-experiment.html#semi-random-experiment" id="toc-semi-random-experiment"><span class="toc-section-number">17.1</span> Semi-random Experiment</a></li>
<li><a href="rerandomization.html#rerandomization" id="toc-rerandomization"><span class="toc-section-number">17.2</span> Rerandomization</a></li>
</ul></li>
<li><a href="sampling.html#sampling" id="toc-sampling"><span class="toc-section-number">18</span> Sampling</a>
<ul>
<li><a href="simple-sampling.html#simple-sampling" id="toc-simple-sampling"><span class="toc-section-number">18.1</span> Simple Sampling</a></li>
<li><a href="stratified-sampling.html#stratified-sampling" id="toc-stratified-sampling"><span class="toc-section-number">18.2</span> Stratified Sampling</a></li>
<li><a href="unequal-probability-sampling.html#unequal-probability-sampling" id="toc-unequal-probability-sampling"><span class="toc-section-number">18.3</span> Unequal Probability Sampling</a></li>
<li><a href="balanced-sampling.html#balanced-sampling" id="toc-balanced-sampling"><span class="toc-section-number">18.4</span> Balanced Sampling</a>
<ul>
<li><a href="balanced-sampling.html#cube" id="toc-cube"><span class="toc-section-number">18.4.1</span> Cube</a></li>
<li><a href="balanced-sampling.html#stratification" id="toc-stratification"><span class="toc-section-number">18.4.2</span> Stratification</a></li>
<li><a href="balanced-sampling.html#cluster-1" id="toc-cluster-1"><span class="toc-section-number">18.4.3</span> Cluster</a></li>
<li><a href="balanced-sampling.html#two-stage" id="toc-two-stage"><span class="toc-section-number">18.4.4</span> Two-stage</a></li>
</ul></li>
</ul></li>
<li><a href="analysis-of-variance-anova.html#analysis-of-variance-anova" id="toc-analysis-of-variance-anova"><span class="toc-section-number">19</span> Analysis of Variance (ANOVA)</a>
<ul>
<li><a href="completely-randomized-design-crd.html#completely-randomized-design-crd" id="toc-completely-randomized-design-crd"><span class="toc-section-number">19.1</span> Completely Randomized Design (CRD)</a>
<ul>
<li><a href="completely-randomized-design-crd.html#single-factor-fixed-effects-model" id="toc-single-factor-fixed-effects-model"><span class="toc-section-number">19.1.1</span> Single Factor Fixed Effects Model</a></li>
<li><a href="completely-randomized-design-crd.html#single-factor-random-effects-model" id="toc-single-factor-random-effects-model"><span class="toc-section-number">19.1.2</span> Single Factor Random Effects Model</a></li>
<li><a href="completely-randomized-design-crd.html#two-factor-fixed-effect-anova" id="toc-two-factor-fixed-effect-anova"><span class="toc-section-number">19.1.3</span> Two Factor Fixed Effect ANOVA</a></li>
<li><a href="completely-randomized-design-crd.html#two-way-random-effects-anova" id="toc-two-way-random-effects-anova"><span class="toc-section-number">19.1.4</span> Two-Way Random Effects ANOVA</a></li>
<li><a href="completely-randomized-design-crd.html#two-way-mixed-effects-anova" id="toc-two-way-mixed-effects-anova"><span class="toc-section-number">19.1.5</span> Two-Way Mixed Effects ANOVA</a></li>
</ul></li>
<li><a href="nonparametric-anova.html#nonparametric-anova" id="toc-nonparametric-anova"><span class="toc-section-number">19.2</span> Nonparametric ANOVA</a>
<ul>
<li><a href="nonparametric-anova.html#kruskal-wallis" id="toc-kruskal-wallis"><span class="toc-section-number">19.2.1</span> Kruskal-Wallis</a></li>
<li><a href="nonparametric-anova.html#friedman-test" id="toc-friedman-test"><span class="toc-section-number">19.2.2</span> Friedman Test</a></li>
</ul></li>
<li><a href="sample-size-planning-for-anova.html#sample-size-planning-for-anova" id="toc-sample-size-planning-for-anova"><span class="toc-section-number">19.3</span> Sample Size Planning for ANOVA</a>
<ul>
<li><a href="sample-size-planning-for-anova.html#balanced-designs" id="toc-balanced-designs"><span class="toc-section-number">19.3.1</span> Balanced Designs</a></li>
<li><a href="sample-size-planning-for-anova.html#randomized-block-experiments" id="toc-randomized-block-experiments"><span class="toc-section-number">19.3.2</span> Randomized Block Experiments</a></li>
</ul></li>
<li><a href="randomized-block-designs.html#randomized-block-designs" id="toc-randomized-block-designs"><span class="toc-section-number">19.4</span> Randomized Block Designs</a>
<ul>
<li><a href="randomized-block-designs.html#tukey-test-of-additivity" id="toc-tukey-test-of-additivity"><span class="toc-section-number">19.4.1</span> Tukey Test of Additivity</a></li>
</ul></li>
<li><a href="nested-designs.html#nested-designs" id="toc-nested-designs"><span class="toc-section-number">19.5</span> Nested Designs</a>
<ul>
<li><a href="nested-designs.html#two-factor-nested-designs" id="toc-two-factor-nested-designs"><span class="toc-section-number">19.5.1</span> Two-Factor Nested Designs</a></li>
</ul></li>
<li><a href="single-factor-covariance-model.html#single-factor-covariance-model" id="toc-single-factor-covariance-model"><span class="toc-section-number">19.6</span> Single Factor Covariance Model</a></li>
</ul></li>
<li><a href="multivariate-methods.html#multivariate-methods" id="toc-multivariate-methods"><span class="toc-section-number">20</span> Multivariate Methods</a>
<ul>
<li><a href="multivariate-methods.html#properties-of-mvn" id="toc-properties-of-mvn"><span class="toc-section-number">20.0.1</span> Properties of MVN</a></li>
<li><a href="multivariate-methods.html#mean-vector-inference" id="toc-mean-vector-inference"><span class="toc-section-number">20.0.2</span> Mean Vector Inference</a></li>
<li><a href="multivariate-methods.html#general-hypothesis-testing" id="toc-general-hypothesis-testing"><span class="toc-section-number">20.0.3</span> General Hypothesis Testing</a></li>
<li><a href="manova.html#manova" id="toc-manova"><span class="toc-section-number">20.1</span> MANOVA</a>
<ul>
<li><a href="manova.html#testing-general-hypotheses" id="toc-testing-general-hypotheses"><span class="toc-section-number">20.1.1</span> Testing General Hypotheses</a></li>
<li><a href="manova.html#profile-analysis" id="toc-profile-analysis"><span class="toc-section-number">20.1.2</span> Profile Analysis</a></li>
<li><a href="manova.html#summary-5" id="toc-summary-5"><span class="toc-section-number">20.1.3</span> Summary</a></li>
</ul></li>
<li><a href="principal-components.html#principal-components" id="toc-principal-components"><span class="toc-section-number">20.2</span> Principal Components</a>
<ul>
<li><a href="principal-components.html#population-principal-components" id="toc-population-principal-components"><span class="toc-section-number">20.2.1</span> Population Principal Components</a></li>
<li><a href="principal-components.html#sample-principal-components" id="toc-sample-principal-components"><span class="toc-section-number">20.2.2</span> Sample Principal Components</a></li>
<li><a href="principal-components.html#application-10" id="toc-application-10"><span class="toc-section-number">20.2.3</span> Application</a></li>
</ul></li>
<li><a href="factor-analysis.html#factor-analysis" id="toc-factor-analysis"><span class="toc-section-number">20.3</span> Factor Analysis</a>
<ul>
<li><a href="factor-analysis.html#methods-of-estimation" id="toc-methods-of-estimation"><span class="toc-section-number">20.3.1</span> Methods of Estimation</a></li>
<li><a href="factor-analysis.html#factor-rotation" id="toc-factor-rotation"><span class="toc-section-number">20.3.2</span> Factor Rotation</a></li>
<li><a href="factor-analysis.html#estimation-of-factor-scores" id="toc-estimation-of-factor-scores"><span class="toc-section-number">20.3.3</span> Estimation of Factor Scores</a></li>
<li><a href="factor-analysis.html#model-diagnostic" id="toc-model-diagnostic"><span class="toc-section-number">20.3.4</span> Model Diagnostic</a></li>
<li><a href="factor-analysis.html#application-11" id="toc-application-11"><span class="toc-section-number">20.3.5</span> Application</a></li>
</ul></li>
<li><a href="discriminant-analysis.html#discriminant-analysis" id="toc-discriminant-analysis"><span class="toc-section-number">20.4</span> Discriminant Analysis</a>
<ul>
<li><a href="discriminant-analysis.html#known-populations" id="toc-known-populations"><span class="toc-section-number">20.4.1</span> Known Populations</a></li>
<li><a href="discriminant-analysis.html#probabilities-of-misclassification" id="toc-probabilities-of-misclassification"><span class="toc-section-number">20.4.2</span> Probabilities of Misclassification</a></li>
<li><a href="discriminant-analysis.html#unknown-populations-nonparametric-discrimination" id="toc-unknown-populations-nonparametric-discrimination"><span class="toc-section-number">20.4.3</span> Unknown Populations/ Nonparametric Discrimination</a></li>
<li><a href="discriminant-analysis.html#application-12" id="toc-application-12"><span class="toc-section-number">20.4.4</span> Application</a></li>
</ul></li>
</ul></li>
<li><a href="#part-b.-quasi-experimental-design" id="toc-part-b.-quasi-experimental-design">(PART*) B. QUASI-EXPERIMENTAL DESIGN</a></li>
<li><a href="quasi-experimental.html#quasi-experimental" id="toc-quasi-experimental"><span class="toc-section-number">21</span> Quasi-experimental</a></li>
<li><a href="regression-discontinuity.html#regression-discontinuity" id="toc-regression-discontinuity"><span class="toc-section-number">22</span> Regression Discontinuity</a>
<ul>
<li><a href="specification-checks.html#specification-checks" id="toc-specification-checks"><span class="toc-section-number">22.1</span> Specification Checks</a>
<ul>
<li><a href="specification-checks.html#balance-checks" id="toc-balance-checks"><span class="toc-section-number">22.1.1</span> Balance Checks</a></li>
<li><a href="specification-checks.html#sortingbunchingmanipulation" id="toc-sortingbunchingmanipulation"><span class="toc-section-number">22.1.2</span> Sorting/Bunching/Manipulation</a></li>
<li><a href="specification-checks.html#placebo-tests" id="toc-placebo-tests"><span class="toc-section-number">22.1.3</span> Placebo Tests</a></li>
<li><a href="specification-checks.html#sensitivity-to-bandwidth-choice" id="toc-sensitivity-to-bandwidth-choice"><span class="toc-section-number">22.1.4</span> Sensitivity to Bandwidth Choice</a></li>
<li><a href="specification-checks.html#fuzzy-rd-design" id="toc-fuzzy-rd-design"><span class="toc-section-number">22.1.5</span> Fuzzy RD Design</a></li>
<li><a href="specification-checks.html#regression-kink-design" id="toc-regression-kink-design"><span class="toc-section-number">22.1.6</span> Regression Kink Design</a></li>
<li><a href="specification-checks.html#mutli-cutoff-multi-score-geographic-rd" id="toc-mutli-cutoff-multi-score-geographic-rd"><span class="toc-section-number">22.1.7</span> Mutli-cutoff, Multi-score, geographic RD</a></li>
</ul></li>
<li><a href="steps-for-sharp-rd.html#steps-for-sharp-rd" id="toc-steps-for-sharp-rd"><span class="toc-section-number">22.2</span> Steps for Sharp RD</a></li>
<li><a href="steps-for-fuzzy-rd.html#steps-for-fuzzy-rd" id="toc-steps-for-fuzzy-rd"><span class="toc-section-number">22.3</span> Steps for Fuzzy RD</a></li>
<li><a href="steps-for-rdit-regression-discontinuity-in-time.html#steps-for-rdit-regression-discontinuity-in-time" id="toc-steps-for-rdit-regression-discontinuity-in-time"><span class="toc-section-number">22.4</span> Steps for RDiT (Regression Discontinuity in Time)</a></li>
<li><a href="evaluation-of-an-rd.html#evaluation-of-an-rd" id="toc-evaluation-of-an-rd"><span class="toc-section-number">22.5</span> Evaluation of an RD</a></li>
<li><a href="applications.html#applications" id="toc-applications"><span class="toc-section-number">22.6</span> Applications</a>
<ul>
<li><a href="applications.html#example-1-1" id="toc-example-1-1"><span class="toc-section-number">22.6.1</span> Example 1</a></li>
<li><a href="applications.html#example-2" id="toc-example-2"><span class="toc-section-number">22.6.2</span> Example 2</a></li>
<li><a href="applications.html#example-3" id="toc-example-3"><span class="toc-section-number">22.6.3</span> Example 3</a></li>
<li><a href="applications.html#example-4" id="toc-example-4"><span class="toc-section-number">22.6.4</span> Example 4</a></li>
</ul></li>
</ul></li>
<li><a href="difference-in-differences.html#difference-in-differences" id="toc-difference-in-differences"><span class="toc-section-number">23</span> Difference-in-differences</a>
<ul>
<li><a href="simple-dif-n-dif.html#simple-dif-n-dif" id="toc-simple-dif-n-dif"><span class="toc-section-number">23.1</span> Simple Dif-n-dif</a>
<ul>
<li><a href="simple-dif-n-dif.html#assumptions-2" id="toc-assumptions-2"><span class="toc-section-number">23.1.1</span> Assumptions</a></li>
<li><a href="simple-dif-n-dif.html#examples" id="toc-examples"><span class="toc-section-number">23.1.2</span> Examples</a></li>
</ul></li>
<li><a href="multiple-periods-and-variation-in-treatment-timing.html#multiple-periods-and-variation-in-treatment-timing" id="toc-multiple-periods-and-variation-in-treatment-timing"><span class="toc-section-number">23.2</span> Multiple periods and variation in treatment timing</a></li>
<li><a href="staggered-dif-n-dif.html#staggered-dif-n-dif" id="toc-staggered-dif-n-dif"><span class="toc-section-number">23.3</span> Staggered Dif-n-dif</a>
<ul>
<li><a href="staggered-dif-n-dif.html#example-by-doleac2020" id="toc-example-by-doleac2020"><span class="toc-section-number">23.3.1</span> Example by <span class="citation">Doleac and Hansen (<span>2020</span>)</span></a></li>
</ul></li>
<li><a href="two-way-fixed-effects.html#two-way-fixed-effects" id="toc-two-way-fixed-effects"><span class="toc-section-number">23.4</span> Two-way Fixed-effects</a></li>
</ul></li>
<li><a href="synthetic-control.html#synthetic-control" id="toc-synthetic-control"><span class="toc-section-number">24</span> Synthetic Control</a>
<ul>
<li><a href="synthetic-control.html#example-1-2" id="toc-example-1-2"><span class="toc-section-number">24.0.1</span> Example 1</a></li>
<li><a href="synthetic-control.html#example-2-1" id="toc-example-2-1"><span class="toc-section-number">24.0.2</span> Example 2</a></li>
<li><a href="synthetic-control.html#example-3-1" id="toc-example-3-1"><span class="toc-section-number">24.0.3</span> Example 3</a></li>
<li><a href="synthetic-control.html#example-4-1" id="toc-example-4-1"><span class="toc-section-number">24.0.4</span> Example 4</a></li>
<li><a href="synthetic-difference-in-differences.html#synthetic-difference-in-differences" id="toc-synthetic-difference-in-differences"><span class="toc-section-number">24.1</span> Synthetic Difference-in-differences</a></li>
</ul></li>
<li><a href="event-studies.html#event-studies" id="toc-event-studies"><span class="toc-section-number">25</span> Event Studies</a>
<ul>
<li><a href="other-issues.html#other-issues" id="toc-other-issues"><span class="toc-section-number">25.1</span> Other Issues</a>
<ul>
<li><a href="other-issues.html#economic-significance" id="toc-economic-significance"><span class="toc-section-number">25.1.1</span> Economic significance</a></li>
<li><a href="other-issues.html#statistical-power" id="toc-statistical-power"><span class="toc-section-number">25.1.2</span> Statistical Power</a></li>
<li><a href="other-issues.html#testing" id="toc-testing"><span class="toc-section-number">25.1.3</span> Testing</a></li>
<li><a href="other-issues.html#confounders" id="toc-confounders"><span class="toc-section-number">25.1.4</span> Confounders</a></li>
<li><a href="other-issues.html#biases" id="toc-biases"><span class="toc-section-number">25.1.5</span> Biases</a></li>
<li><a href="other-issues.html#long-run-event-studies" id="toc-long-run-event-studies"><span class="toc-section-number">25.1.6</span> Long-run event studies</a></li>
</ul></li>
<li><a href="aggregation.html#aggregation" id="toc-aggregation"><span class="toc-section-number">25.2</span> Aggregation</a>
<ul>
<li><a href="aggregation.html#over-time" id="toc-over-time"><span class="toc-section-number">25.2.1</span> Over Time</a></li>
<li><a href="aggregation.html#across-firms-over-time" id="toc-across-firms-over-time"><span class="toc-section-number">25.2.2</span> Across Firms + Over Time</a></li>
</ul></li>
<li><a href="heterogeneity-in-the-event-effect.html#heterogeneity-in-the-event-effect" id="toc-heterogeneity-in-the-event-effect"><span class="toc-section-number">25.3</span> Heterogeneity in the event effect</a></li>
<li><a href="expected-return-calculation.html#expected-return-calculation" id="toc-expected-return-calculation"><span class="toc-section-number">25.4</span> Expected Return Calculation</a>
<ul>
<li><a href="expected-return-calculation.html#statistical-models" id="toc-statistical-models"><span class="toc-section-number">25.4.1</span> Statistical Models</a></li>
<li><a href="expected-return-calculation.html#economic-model" id="toc-economic-model"><span class="toc-section-number">25.4.2</span> Economic Model</a></li>
</ul></li>
<li><a href="application-13.html#application-13" id="toc-application-13"><span class="toc-section-number">25.5</span> Application</a></li>
</ul></li>
<li><a href="matching-methods.html#matching-methods" id="toc-matching-methods"><span class="toc-section-number">26</span> Matching Methods</a>
<ul>
<li><a href="matchit.html#matchit" id="toc-matchit"><span class="toc-section-number">26.1</span> MatchIt</a></li>
<li><a href="matchingfrontier.html#matchingfrontier" id="toc-matchingfrontier"><span class="toc-section-number">26.2</span> MatchingFrontier</a></li>
<li><a href="propensity-scores.html#propensity-scores" id="toc-propensity-scores"><span class="toc-section-number">26.3</span> Propensity Scores</a></li>
<li><a href="mahalanobis-distance.html#mahalanobis-distance" id="toc-mahalanobis-distance"><span class="toc-section-number">26.4</span> Mahalanobis Distance</a></li>
<li><a href="coarsened-exact-matching.html#coarsened-exact-matching" id="toc-coarsened-exact-matching"><span class="toc-section-number">26.5</span> Coarsened Exact Matching</a></li>
<li><a href="genetic-matching.html#genetic-matching" id="toc-genetic-matching"><span class="toc-section-number">26.6</span> Genetic Matching</a></li>
<li><a href="matching-for-time-series-cross-section-data.html#matching-for-time-series-cross-section-data" id="toc-matching-for-time-series-cross-section-data"><span class="toc-section-number">26.7</span> Matching for time series-cross-section data</a></li>
</ul></li>
<li><a href="interrupted-time-series.html#interrupted-time-series" id="toc-interrupted-time-series"><span class="toc-section-number">27</span> Interrupted Time Series</a>
<ul>
<li><a href="autocorrelation.html#autocorrelation" id="toc-autocorrelation"><span class="toc-section-number">27.1</span> Autocorrelation</a></li>
<li><a href="multiple-groups.html#multiple-groups" id="toc-multiple-groups"><span class="toc-section-number">27.2</span> Multiple Groups</a></li>
</ul></li>
<li><a href="#part-c.-other-concerns" id="toc-part-c.-other-concerns">(PART*) C. OTHER CONCERNS</a></li>
<li><a href="endogeneity.html#endogeneity" id="toc-endogeneity"><span class="toc-section-number">28</span> Endogeneity</a>
<ul>
<li><a href="measurement-error.html#measurement-error" id="toc-measurement-error"><span class="toc-section-number">28.1</span> Measurement Error</a>
<ul>
<li><a href="measurement-error.html#classical-measurement-errors" id="toc-classical-measurement-errors"><span class="toc-section-number">28.1.1</span> Classical Measurement Errors</a></li>
<li><a href="measurement-error.html#non-classical-measurement-errors" id="toc-non-classical-measurement-errors"><span class="toc-section-number">28.1.2</span> Non-classical Measurement Errors</a></li>
<li><a href="measurement-error.html#solution-to-measurement-errors" id="toc-solution-to-measurement-errors"><span class="toc-section-number">28.1.3</span> Solution to Measurement Errors</a></li>
</ul></li>
<li><a href="simultaneity.html#simultaneity" id="toc-simultaneity"><span class="toc-section-number">28.2</span> Simultaneity</a></li>
<li><a href="endogenous-treatment.html#endogenous-treatment" id="toc-endogenous-treatment"><span class="toc-section-number">28.3</span> Endogenous Treatment</a>
<ul>
<li><a href="endogenous-treatment.html#instrumental-variable" id="toc-instrumental-variable"><span class="toc-section-number">28.3.1</span> Instrumental Variable</a></li>
<li><a href="endogenous-treatment.html#internal-instrumental-variable" id="toc-internal-instrumental-variable"><span class="toc-section-number">28.3.2</span> Internal instrumental variable</a></li>
<li><a href="endogenous-treatment.html#proxy-variables" id="toc-proxy-variables"><span class="toc-section-number">28.3.3</span> Proxy Variables</a></li>
</ul></li>
<li><a href="endogenous-sample-selection.html#endogenous-sample-selection" id="toc-endogenous-sample-selection"><span class="toc-section-number">28.4</span> Endogenous Sample Selection</a>
<ul>
<li><a href="endogenous-sample-selection.html#tobit-2" id="toc-tobit-2"><span class="toc-section-number">28.4.1</span> Tobit-2</a></li>
<li><a href="endogenous-sample-selection.html#tobit-5" id="toc-tobit-5"><span class="toc-section-number">28.4.2</span> Tobit-5</a></li>
</ul></li>
</ul></li>
<li><a href="mediation.html#mediation" id="toc-mediation"><span class="toc-section-number">29</span> Mediation</a>
<ul>
<li><a href="traditional.html#traditional" id="toc-traditional"><span class="toc-section-number">29.1</span> Traditional</a>
<ul>
<li><a href="traditional.html#example-1-mediation-traditional" id="toc-example-1-mediation-traditional"><span class="toc-section-number">29.1.1</span> Example 1</a></li>
</ul></li>
<li><a href="model-based-causal-mediation-analysis.html#model-based-causal-mediation-analysis" id="toc-model-based-causal-mediation-analysis"><span class="toc-section-number">29.2</span> Model-based causal mediation analysis</a></li>
</ul></li>
<li><a href="directed-acyclic-graph.html#directed-acyclic-graph" id="toc-directed-acyclic-graph"><span class="toc-section-number">30</span> Directed Acyclic Graph</a></li>
<li><a href="#part-v.-miscellaneous" id="toc-part-v.-miscellaneous">(PART*) V. MISCELLANEOUS</a></li>
<li><a href="report.html#report" id="toc-report"><span class="toc-section-number">31</span> Report</a>
<ul>
<li><a href="one-summary-table.html#one-summary-table" id="toc-one-summary-table"><span class="toc-section-number">31.1</span> One summary table</a></li>
<li><a href="model-comparison.html#model-comparison" id="toc-model-comparison"><span class="toc-section-number">31.2</span> Model Comparison</a></li>
<li><a href="changes-in-an-estimate.html#changes-in-an-estimate" id="toc-changes-in-an-estimate"><span class="toc-section-number">31.3</span> Changes in an estimate</a></li>
</ul></li>
<li><a href="exploratory-data-analysis.html#exploratory-data-analysis" id="toc-exploratory-data-analysis"><span class="toc-section-number">32</span> Exploratory Data Analysis</a></li>
<li><a href="sensitivity-analysis-robustness-check.html#sensitivity-analysis-robustness-check" id="toc-sensitivity-analysis-robustness-check"><span class="toc-section-number">33</span> Sensitivity Analysis/ Robustness Check</a>
<ul>
<li><a href="specification-curve.html#specification-curve" id="toc-specification-curve"><span class="toc-section-number">33.1</span> Specification curve</a>
<ul>
<li><a href="specification-curve.html#starbility" id="toc-starbility"><span class="toc-section-number">33.1.1</span> starbility</a></li>
<li><a href="specification-curve.html#rdfanalysis" id="toc-rdfanalysis"><span class="toc-section-number">33.1.2</span> rdfanalysis</a></li>
</ul></li>
<li><a href="coefficient-stability.html#coefficient-stability" id="toc-coefficient-stability"><span class="toc-section-number">33.2</span> Coefficient stability</a></li>
</ul></li>
<li><a href="#appendix-appendix" id="toc-appendix-appendix">(APPENDIX) APPENDIX</a></li>
<li><a href="appendix.html#appendix" id="toc-appendix"><span class="toc-section-number">34</span> Appendix</a>
<ul>
<li><a href="git.html#git" id="toc-git"><span class="toc-section-number">34.1</span> Git</a></li>
<li><a href="short-cut.html#short-cut" id="toc-short-cut"><span class="toc-section-number">34.2</span> Short-cut</a></li>
<li><a href="function-short-cut.html#function-short-cut" id="toc-function-short-cut"><span class="toc-section-number">34.3</span> Function short-cut</a></li>
<li><a href="citation.html#citation" id="toc-citation"><span class="toc-section-number">34.4</span> Citation</a></li>
<li><a href="install-all-necessary-packageslibaries-on-your-local-machine.html#install-all-necessary-packageslibaries-on-your-local-machine" id="toc-install-all-necessary-packageslibaries-on-your-local-machine"><span class="toc-section-number">34.5</span> Install all necessary packages/libaries on your local machine</a></li>
</ul></li>
<li><a href="bookdown-cheat-sheet.html#bookdown-cheat-sheet" id="toc-bookdown-cheat-sheet"><span class="toc-section-number">35</span> Bookdown cheat sheet</a>
<ul>
<li><a href="operation.html#operation" id="toc-operation"><span class="toc-section-number">35.1</span> Operation</a></li>
<li><a href="math-expresssion-syntax.html#math-expresssion-syntax" id="toc-math-expresssion-syntax"><span class="toc-section-number">35.2</span> Math Expresssion/ Syntax</a>
<ul>
<li><a href="math-expresssion-syntax.html#statistics-notation" id="toc-statistics-notation"><span class="toc-section-number">35.2.1</span> Statistics Notation</a></li>
</ul></li>
<li><a href="table.html#table" id="toc-table"><span class="toc-section-number">35.3</span> Table</a></li>
</ul></li>
<li><a href="references.html#references" id="toc-references">References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A Guide on Data Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="principal-components" class="section level2" number="20.2">
<h2><span class="header-section-number">20.2</span> Principal Components</h2>
<ul>
<li>Unsupervised learning</li>
<li>find important features</li>
<li>reduce the dimensions of the data set</li>
<li>“decorrelate” multivariate vectors that have dependence.</li>
<li>uses eigenvector/eigvenvalue decomposition of covariance (correlation) matrices.</li>
</ul>
<p>According to the “spectral decomposition theorem”, if <span class="math inline">\(\mathbf{\Sigma}_{p \times p}\)</span> i s a positive semi-definite, symmetric, real matrix, then there exists an orthogonal matrix <span class="math inline">\(\mathbf{A}\)</span> such that <span class="math inline">\(\mathbf{A&#39;\Sigma A} = \Lambda\)</span> where <span class="math inline">\(\Lambda\)</span> is a diagonal matrix containing the eigenvalues <span class="math inline">\(\mathbf{\Sigma}\)</span></p>
<p><span class="math display">\[
\mathbf{\Lambda} =
\left(
\begin{array}
{cccc}
\lambda_1 &amp; 0 &amp; \ldots &amp; 0 \\
0 &amp; \lambda_2 &amp; \ldots &amp; 0 \\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
0 &amp; 0 &amp; \ldots &amp; \lambda_p
\end{array}
\right)
\]</span></p>
<p><span class="math display">\[
\mathbf{A} =
\left(
\begin{array}
{cccc}
\mathbf{a}_1 &amp; \mathbf{a}_2 &amp; \ldots &amp; \mathbf{a}_p
\end{array}
\right)
\]</span></p>
<p>the i-th column of <span class="math inline">\(\mathbf{A}\)</span> , <span class="math inline">\(\mathbf{a}_i\)</span>, is the i-th <span class="math inline">\(p \times 1\)</span> eigenvector of <span class="math inline">\(\mathbf{\Sigma}\)</span> that corresponds to the eigenvalue, <span class="math inline">\(\lambda_i\)</span> , where <span class="math inline">\(\lambda_1 \ge \lambda_2 \ge \ldots \ge \lambda_p\)</span> . Alternatively, express in matrix decomposition:</p>
<p><span class="math display">\[
\mathbf{\Sigma} = \mathbf{A \Lambda A}&#39;
\]</span></p>
<p><span class="math display">\[
\mathbf{\Sigma} = \mathbf{A}
\left(
\begin{array}
{cccc}
\lambda_1 &amp; 0 &amp; \ldots &amp; 0 \\
0 &amp; \lambda_2 &amp; \ldots &amp; 0 \\
\vdots &amp; \vdots&amp; \ddots &amp; \vdots \\
0 &amp; 0 &amp; \ldots &amp; \lambda_p
\end{array}
\right)
\mathbf{A}&#39;
= \sum_{i=1}^p \lambda_i \mathbf{a}_i \mathbf{a}_i&#39;
\]</span></p>
<p>where the outer product <span class="math inline">\(\mathbf{a}_i \mathbf{a}_i&#39;\)</span> is a <span class="math inline">\(p \times p\)</span> matrix of rank 1.</p>
<p>For example,</p>
<p><span class="math inline">\(\mathbf{x} \sim N_2(\mathbf{\mu}, \mathbf{\Sigma})\)</span></p>
<p><span class="math display">\[
\mathbf{\mu} =
\left(
\begin{array}
{c}
5 \\
12
\end{array}
\right);
\mathbf{\Sigma} =
\left(
\begin{array}
{cc}
4 &amp; 1 \\
1 &amp; 2
\end{array}
\right)
\]</span></p>
<div class="sourceCode" id="cb347"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb347-1"><a href="principal-components.html#cb347-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb347-2"><a href="principal-components.html#cb347-2" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">=</span> <span class="fu">as.matrix</span>(<span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">12</span>))</span>
<span id="cb347-3"><a href="principal-components.html#cb347-3" aria-hidden="true" tabindex="-1"></a>Sigma <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>),<span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">byrow =</span> T)</span>
<span id="cb347-4"><a href="principal-components.html#cb347-4" aria-hidden="true" tabindex="-1"></a>sim <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(<span class="at">n =</span> <span class="dv">1000</span>, <span class="at">mu =</span> mu, <span class="at">Sigma =</span> Sigma)</span>
<span id="cb347-5"><a href="principal-components.html#cb347-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sim[,<span class="dv">1</span>],sim[,<span class="dv">2</span>])</span></code></pre></div>
<p><img src="20-multivariate_files/figure-html/unnamed-chunk-12-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Here,</p>
<p><span class="math display">\[
\mathbf{A} =
\left(
\begin{array}
{cc}
0.9239 &amp; -0.3827 \\
0.3827 &amp; 0.9239 \\
\end{array}
\right)
\]</span></p>
<p>Columns of <span class="math inline">\(\mathbf{A}\)</span> are the eigenvectors for the decomposition</p>
<p>Under matrix multiplication (<span class="math inline">\(\mathbf{A&#39;\Sigma A}\)</span> or <span class="math inline">\(\mathbf{A&#39;A}\)</span> ), the off-diagonal elements equal to 0</p>
<p>Multiplying data by this matrix (i.e., projecting the data onto the orthogonal axes); the distriubiton of the resulting data (i.e., “scores”) is</p>
<p><span class="math display">\[
N_2 (\mathbf{A&#39;\mu,A&#39;\Sigma A}) = N_2 (\mathbf{A&#39;\mu, \Lambda})
\]</span></p>
<p>Equivalently,</p>
<p><span class="math display">\[
\mathbf{y} = \mathbf{A&#39;x} \sim N
\left[
\left(
\begin{array}
{c}
9.2119 \\
9.1733
\end{array}
\right),
\left(
\begin{array}
{cc}
4.4144 &amp; 0 \\
0 &amp; 1.5859
\end{array}
\right)
\right]
\]</span></p>
<div class="sourceCode" id="cb348"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb348-1"><a href="principal-components.html#cb348-1" aria-hidden="true" tabindex="-1"></a>A_matrix <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fl">0.9239</span>,<span class="sc">-</span><span class="fl">0.3827</span>,<span class="fl">0.3827</span>,<span class="fl">0.9239</span>),<span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">byrow =</span> T)</span>
<span id="cb348-2"><a href="principal-components.html#cb348-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t</span>(A_matrix) <span class="sc">%*%</span> A_matrix</span>
<span id="cb348-3"><a href="principal-components.html#cb348-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          [,1]     [,2]</span></span>
<span id="cb348-4"><a href="principal-components.html#cb348-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1,] 1.000051 0.000000</span></span>
<span id="cb348-5"><a href="principal-components.html#cb348-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [2,] 0.000000 1.000051</span></span>
<span id="cb348-6"><a href="principal-components.html#cb348-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb348-7"><a href="principal-components.html#cb348-7" aria-hidden="true" tabindex="-1"></a>sim1 <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(<span class="at">n =</span> <span class="dv">1000</span>, <span class="at">mu =</span> <span class="fu">t</span>(A_matrix) <span class="sc">%*%</span> mu, <span class="at">Sigma =</span> <span class="fu">t</span>(A_matrix) <span class="sc">%*%</span> Sigma <span class="sc">%*%</span> A_matrix)</span>
<span id="cb348-8"><a href="principal-components.html#cb348-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sim1[,<span class="dv">1</span>],sim1[,<span class="dv">2</span>])</span></code></pre></div>
<p><img src="20-multivariate_files/figure-html/unnamed-chunk-13-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>No more dependence in the data structure, plot</p>
<p>Notes:</p>
<ul>
<li><p>The i-th eigenvalue is the variance of a linear combination of the elements of <span class="math inline">\(\mathbf{x}\)</span> ; <span class="math inline">\(var(y_i) = var(\mathbf{a&#39;_i x}) = \lambda_i\)</span></p></li>
<li><p>The values on the transformed set of axes (i.e., the <span class="math inline">\(y_i\)</span>’s) are called the scores. These are the orthogonal projections of the data onto the “new principal component axes</p></li>
<li><p>Variances of <span class="math inline">\(y_1\)</span> are greater than those for any other possible projection</p></li>
</ul>
<p>Covariance matrix decomposition and projection onto orthogonal axes = PCA</p>
<p><br></p>
<div id="population-principal-components" class="section level3" number="20.2.1">
<h3><span class="header-section-number">20.2.1</span> Population Principal Components</h3>
<p><span class="math inline">\(p \times 1\)</span> vectors <span class="math inline">\(\mathbf{x}_1, \dots , \mathbf{x}_n\)</span> which are iid with <span class="math inline">\(var(\mathbf{x}_i) = \mathbf{\Sigma}\)</span></p>
<ul>
<li><p>The first PC is the linear combination <span class="math inline">\(y_1 = \mathbf{a}_1&#39; \mathbf{x} = a_{11}x_1 + \dots + a_{1p}x_p\)</span> with <span class="math inline">\(\mathbf{a}_1&#39; \mathbf{a}_1 = 1\)</span> such that <span class="math inline">\(var(y_1)\)</span> is the maximum of all linear combinations of <span class="math inline">\(\mathbf{x}\)</span> which have unit length</p></li>
<li><p>The second PC is the linear combination <span class="math inline">\(y_1 = \mathbf{a}_2&#39; \mathbf{x} = a_{21}x_1 + \dots + a_{2p}x_p\)</span> with <span class="math inline">\(\mathbf{a}_2&#39; \mathbf{a}_2 = 1\)</span> such that <span class="math inline">\(var(y_1)\)</span> is the maximum of all linear combinations of <span class="math inline">\(\mathbf{x}\)</span> which have unit length and uncorrelated with <span class="math inline">\(y_1\)</span> (i.e., <span class="math inline">\(cov(\mathbf{a}_1&#39; \mathbf{x}, \mathbf{a}&#39;_2 \mathbf{x}) =0\)</span></p></li>
<li><p>continues for all <span class="math inline">\(y_i\)</span> to <span class="math inline">\(y_p\)</span></p></li>
</ul>
<p><span class="math inline">\(\mathbf{a}_i\)</span>’s are those that make up the matrix <span class="math inline">\(\mathbf{A}\)</span> in the symmetric decomposition <span class="math inline">\(\mathbf{A&#39;\Sigma A} = \mathbf{\Lambda}\)</span> , where <span class="math inline">\(var(y_1) = \lambda_1, \dots , var(y_p) = \lambda_p\)</span> And the total variance of <span class="math inline">\(\mathbf{x}\)</span> is</p>
<p><span class="math display">\[
\begin{aligned}
var(x_1) + \dots + var(x_p) &amp;= tr(\Sigma) = \lambda_1 + \dots + \lambda_p \\
&amp;= var(y_1) + \dots + var(y_p)
\end{aligned}
\]</span></p>
<p><br></p>
<p>Data Reduction</p>
<p>To reduce the dimension of data from p (original) to k dimensions without much “loss of information”, we can use properties of the population principal components</p>
<ul>
<li><p>Suppose <span class="math inline">\(\mathbf{\Sigma} \approx \sum_{i=1}^k \lambda_i \mathbf{a}_i \mathbf{a}_i&#39;\)</span> . Even thought the true variance-covariance matrix has rank <span class="math inline">\(p\)</span> , it can be be well approximate by a matrix of rank k (k &lt;p)</p></li>
<li><p>New “traits” are linear combinations of the measured traits. We can attempt to make meaningful interpretation fo the combinations (with orthogonality constraints).</p></li>
<li><p>The proportion of the total variance accounted for by the j-th principal component is</p></li>
</ul>
<p><span class="math display">\[
\frac{var(y_j)}{\sum_{i=1}^p var(y_i)} = \frac{\lambda_j}{\sum_{i=1}^p \lambda_i}
\]</span></p>
<ul>
<li><p>The proportion of the total variation accounted for by the first k principal components is <span class="math inline">\(\frac{\sum_{i=1}^k \lambda_i}{\sum_{i=1}^p \lambda_i}\)</span></p></li>
<li><p>Above example , we have <span class="math inline">\(4.4144/(4+2) = .735\)</span> of the total variability can be explained by the first principal component</p></li>
</ul>
<p><br></p>
</div>
<div id="sample-principal-components" class="section level3" number="20.2.2">
<h3><span class="header-section-number">20.2.2</span> Sample Principal Components</h3>
<p>Since <span class="math inline">\(\mathbf{\Sigma}\)</span> is unknown, we use</p>
<p><span class="math display">\[
\mathbf{S} = \frac{1}{n-1}\sum_{i=1}^n (\mathbf{x}_i - \bar{\mathbf{x}})(\mathbf{x}_i - \bar{\mathbf{x}})&#39;
\]</span></p>
<p>Let <span class="math inline">\(\hat{\lambda}_1 \ge \hat{\lambda}_2 \ge \dots \ge \hat{\lambda}_p \ge 0\)</span> be the eigenvalues of <span class="math inline">\(\mathbf{S}\)</span> and <span class="math inline">\(\hat{\mathbf{a}}_1, \hat{\mathbf{a}}_2, \dots, \hat{\mathbf{a}}_p\)</span> denote the eigenvectors of <span class="math inline">\(\mathbf{S}\)</span></p>
<p>Then, the i-th sample principal component score (or principal component or score) is</p>
<p><span class="math display">\[
\hat{y}_{ij} = \sum_{k=1}^p \hat{a}_{ik}x_{kj} = \hat{\mathbf{a}}_i&#39;\mathbf{x}_j
\]</span></p>
<p><strong>Properties of Sample Principal Components</strong></p>
<ul>
<li><p>The estimated variance of <span class="math inline">\(y_i = \hat{\mathbf{a}}_i&#39;\mathbf{x}_j\)</span> is <span class="math inline">\(\hat{\lambda}_i\)</span></p></li>
<li><p>The sample covariance between <span class="math inline">\(\hat{y}_i\)</span> and <span class="math inline">\(\hat{y}_{i&#39;}\)</span> is 0 when <span class="math inline">\(i \neq i&#39;\)</span></p></li>
<li><p>The proportion of the total sample variance accounted for by the i-th sample principal component is <span class="math inline">\(\frac{\hat{\lambda}_i}{\sum_{k=1}^p \hat{\lambda}_k}\)</span></p></li>
<li><p>The estimated correlation between the i-th principal component score and the l-th attribute of <span class="math inline">\(\mathbf{x}\)</span> is</p></li>
</ul>
<p><span class="math display">\[
r_{x_l , \hat{y}_i} = \frac{\hat{a}_{il}\sqrt{\lambda_i}}{\sqrt{s_{ll}}}
\]</span></p>
<ul>
<li><p>The correlation coefficient is typically used to interpret the components (i.e., if this correlation is high then it suggests that the l-th original trait is important in the i-th principle component). According to <span class="math display">\[@Johnson_1988, pp.433-434\]</span>, <span class="math inline">\(r_{x_l, \hat{y}_i}\)</span> only measures the univariate contribution of an individual X to a component Y without taking into account the presence of the other X’s. Hence, some prefer <span class="math inline">\(\hat{a}_{il}\)</span> coefficient to interpret the principal component.</p></li>
<li><p><span class="math inline">\(r_{x_l, \hat{y}_i} ; \hat{a}_{il}\)</span> are referred to as “loadings”</p></li>
</ul>
<p>To use k principal components, we must calculate the scores for each data vector in the sample</p>
<p><span class="math display">\[
\mathbf{y}_j =
\left(
\begin{array}
{c}
y_{1j} \\
y_{2j} \\
\vdots \\
y_{kj}
\end{array}
\right) =
\left(
\begin{array}
{c}
\hat{\mathbf{a}}_1&#39; \mathbf{x}_j \\
\hat{\mathbf{a}}_2&#39; \mathbf{x}_j \\
\vdots \\
\hat{\mathbf{a}}_k&#39; \mathbf{x}_j
\end{array}
\right) =
\left(
\begin{array}
{c}
\hat{\mathbf{a}}_1&#39; \\
\hat{\mathbf{a}}_2&#39; \\
\vdots \\
\hat{\mathbf{a}}_k&#39;
\end{array}
\right) \mathbf{x}_j
\]</span></p>
<p>Issues:</p>
<ul>
<li><p>Large sample theory exists for eigenvalues and eigenvectors of sample covariance matrices if inference is necessary. But we do not do inference with PCA, we only use it as exploratory or descriptive analysis.</p></li>
<li><p>PC is not invariant to changes in scale (Exception: if all trait are resecaled by multiplying by the same constant, such as feet to inches).</p>
<ul>
<li><p>PCA based on the correlation matrix <span class="math inline">\(\mathbf{R}\)</span> is different than that based on the covariance matrix <span class="math inline">\(\mathbf{\Sigma}\)</span></p></li>
<li><p>PCA for the correlation matrix is just rescaling each trait to have unit variance</p></li>
<li><p>Transform <span class="math inline">\(\mathbf{x}\)</span> to <span class="math inline">\(\mathbf{z}\)</span> where <span class="math inline">\(z_{ij} = (x_{ij} - \bar{x}_i)/\sqrt{s_{ii}}\)</span> where the denominator affects the PCA</p></li>
<li><p>After transformation, <span class="math inline">\(cov(\mathbf{z}) = \mathbf{R}\)</span></p></li>
<li><p>PCA on <span class="math inline">\(\mathbf{R}\)</span> is calculated in the same way as that on <span class="math inline">\(\mathbf{S}\)</span> (where <span class="math inline">\(\hat{\lambda}{}_1 + \dots + \hat{\lambda}{}_p = p\)</span> )</p></li>
<li><p>The use of <span class="math inline">\(\mathbf{R}, \mathbf{S}\)</span> depends on the purpose of PCA.</p>
<ul>
<li>If the scale of the observations if different, covariance matrix is more preferable. but if they are dramatically different, analysis can still be dominated by the large variance traits.</li>
</ul></li>
<li><p>How many PCs to use can be guided by</p>
<ul>
<li><p>Scree Graphs: plot the eigenvalues against their indices. Look for the “elbow” where the steep decline in the graph suddenly flattens out; or big gaps.</p></li>
<li><p>minimum Percent of total variation (e.g., choose enough components to have 50% or 90%). can be used for interpretations.</p></li>
<li><p>Kaiser’s rule: use only those PC with eigenvalues larger than 1 (applied to PCA on the correlation matrix) - ad hoc</p></li>
<li><p>Compare to the eigenvalue scree plot of data to the scree plot when the data are randomized.</p></li>
</ul></li>
</ul></li>
</ul>
<p><br></p>
</div>
<div id="application-10" class="section level3" number="20.2.3">
<h3><span class="header-section-number">20.2.3</span> Application</h3>
<p>PCA on the covariance matrix is usually not preferred due to the fact that PCA is not invariant to changes in scale. Hence, PCA on the correlation matrix is more preferred</p>
<p>This also addresses the problem of multicollinearity</p>
<p>The eigvenvectors may differ by a multiplication of -1 for different implementation, but same interpretation.</p>
<div class="sourceCode" id="cb349"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb349-1"><a href="principal-components.html#cb349-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb349-2"><a href="principal-components.html#cb349-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Read in and check data</span></span>
<span id="cb349-3"><a href="principal-components.html#cb349-3" aria-hidden="true" tabindex="-1"></a>stock <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;images/stock.dat&quot;</span>)</span>
<span id="cb349-4"><a href="principal-components.html#cb349-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(stock) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;allied&quot;</span>, <span class="st">&quot;dupont&quot;</span>, <span class="st">&quot;carbide&quot;</span>, <span class="st">&quot;exxon&quot;</span>, <span class="st">&quot;texaco&quot;</span>)</span>
<span id="cb349-5"><a href="principal-components.html#cb349-5" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(stock)</span>
<span id="cb349-6"><a href="principal-components.html#cb349-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &#39;data.frame&#39;:    100 obs. of  5 variables:</span></span>
<span id="cb349-7"><a href="principal-components.html#cb349-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ allied : num  0 0.027 0.1228 0.057 0.0637 ...</span></span>
<span id="cb349-8"><a href="principal-components.html#cb349-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ dupont : num  0 -0.04485 0.06077 0.02995 -0.00379 ...</span></span>
<span id="cb349-9"><a href="principal-components.html#cb349-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ carbide: num  0 -0.00303 0.08815 0.06681 -0.03979 ...</span></span>
<span id="cb349-10"><a href="principal-components.html#cb349-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ exxon  : num  0.0395 -0.0145 0.0862 0.0135 -0.0186 ...</span></span>
<span id="cb349-11"><a href="principal-components.html#cb349-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ texaco : num  0 0.0435 0.0781 0.0195 -0.0242 ...</span></span>
<span id="cb349-12"><a href="principal-components.html#cb349-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb349-13"><a href="principal-components.html#cb349-13" aria-hidden="true" tabindex="-1"></a><span class="do">## Covariance matrix of data</span></span>
<span id="cb349-14"><a href="principal-components.html#cb349-14" aria-hidden="true" tabindex="-1"></a><span class="fu">cov</span>(stock)</span>
<span id="cb349-15"><a href="principal-components.html#cb349-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;               allied       dupont      carbide        exxon       texaco</span></span>
<span id="cb349-16"><a href="principal-components.html#cb349-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; allied  0.0016299269 0.0008166676 0.0008100713 0.0004422405 0.0005139715</span></span>
<span id="cb349-17"><a href="principal-components.html#cb349-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; dupont  0.0008166676 0.0012293759 0.0008276330 0.0003868550 0.0003109431</span></span>
<span id="cb349-18"><a href="principal-components.html#cb349-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; carbide 0.0008100713 0.0008276330 0.0015560763 0.0004872816 0.0004624767</span></span>
<span id="cb349-19"><a href="principal-components.html#cb349-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; exxon   0.0004422405 0.0003868550 0.0004872816 0.0008023323 0.0004084734</span></span>
<span id="cb349-20"><a href="principal-components.html#cb349-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; texaco  0.0005139715 0.0003109431 0.0004624767 0.0004084734 0.0007587370</span></span>
<span id="cb349-21"><a href="principal-components.html#cb349-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb349-22"><a href="principal-components.html#cb349-22" aria-hidden="true" tabindex="-1"></a><span class="do">## Correlation matrix of data</span></span>
<span id="cb349-23"><a href="principal-components.html#cb349-23" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(stock)</span>
<span id="cb349-24"><a href="principal-components.html#cb349-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            allied    dupont   carbide     exxon    texaco</span></span>
<span id="cb349-25"><a href="principal-components.html#cb349-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; allied  1.0000000 0.5769244 0.5086555 0.3867206 0.4621781</span></span>
<span id="cb349-26"><a href="principal-components.html#cb349-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; dupont  0.5769244 1.0000000 0.5983841 0.3895191 0.3219534</span></span>
<span id="cb349-27"><a href="principal-components.html#cb349-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; carbide 0.5086555 0.5983841 1.0000000 0.4361014 0.4256266</span></span>
<span id="cb349-28"><a href="principal-components.html#cb349-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; exxon   0.3867206 0.3895191 0.4361014 1.0000000 0.5235293</span></span>
<span id="cb349-29"><a href="principal-components.html#cb349-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; texaco  0.4621781 0.3219534 0.4256266 0.5235293 1.0000000</span></span>
<span id="cb349-30"><a href="principal-components.html#cb349-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb349-31"><a href="principal-components.html#cb349-31" aria-hidden="true" tabindex="-1"></a><span class="co"># cov(scale(stock)) # give the same result</span></span>
<span id="cb349-32"><a href="principal-components.html#cb349-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb349-33"><a href="principal-components.html#cb349-33" aria-hidden="true" tabindex="-1"></a><span class="do">## PCA with covariance</span></span>
<span id="cb349-34"><a href="principal-components.html#cb349-34" aria-hidden="true" tabindex="-1"></a>cov_pca <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(stock) <span class="co"># uses singular value decomposition for calculation and an N -1 divisor</span></span>
<span id="cb349-35"><a href="principal-components.html#cb349-35" aria-hidden="true" tabindex="-1"></a><span class="co"># alternatively, princomp can do PCA via spectral decomposition, but it has worse numerical accuracy</span></span>
<span id="cb349-36"><a href="principal-components.html#cb349-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb349-37"><a href="principal-components.html#cb349-37" aria-hidden="true" tabindex="-1"></a><span class="co"># eigen values</span></span>
<span id="cb349-38"><a href="principal-components.html#cb349-38" aria-hidden="true" tabindex="-1"></a>cov_results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">eigen_values =</span> cov_pca<span class="sc">$</span>sdev <span class="sc">^</span> <span class="dv">2</span>)</span>
<span id="cb349-39"><a href="principal-components.html#cb349-39" aria-hidden="true" tabindex="-1"></a>cov_results <span class="sc">%&gt;%</span></span>
<span id="cb349-40"><a href="principal-components.html#cb349-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">proportion =</span> eigen_values <span class="sc">/</span> <span class="fu">sum</span>(eigen_values),</span>
<span id="cb349-41"><a href="principal-components.html#cb349-41" aria-hidden="true" tabindex="-1"></a>           <span class="at">cumulative =</span> <span class="fu">cumsum</span>(proportion)) <span class="co"># first 2 PCs account for 73% variance in the data</span></span>
<span id="cb349-42"><a href="principal-components.html#cb349-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   eigen_values proportion cumulative</span></span>
<span id="cb349-43"><a href="principal-components.html#cb349-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 0.0035953867 0.60159252  0.6015925</span></span>
<span id="cb349-44"><a href="principal-components.html#cb349-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 0.0007921798 0.13255027  0.7341428</span></span>
<span id="cb349-45"><a href="principal-components.html#cb349-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 0.0007364426 0.12322412  0.8573669</span></span>
<span id="cb349-46"><a href="principal-components.html#cb349-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 0.0005086686 0.08511218  0.9424791</span></span>
<span id="cb349-47"><a href="principal-components.html#cb349-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 0.0003437707 0.05752091  1.0000000</span></span>
<span id="cb349-48"><a href="principal-components.html#cb349-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb349-49"><a href="principal-components.html#cb349-49" aria-hidden="true" tabindex="-1"></a><span class="co"># eigen vectors</span></span>
<span id="cb349-50"><a href="principal-components.html#cb349-50" aria-hidden="true" tabindex="-1"></a>cov_pca<span class="sc">$</span>rotation <span class="co"># prcomp calls rotation</span></span>
<span id="cb349-51"><a href="principal-components.html#cb349-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;               PC1         PC2        PC3         PC4         PC5</span></span>
<span id="cb349-52"><a href="principal-components.html#cb349-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; allied  0.5605914  0.73884565 -0.1260222  0.28373183 -0.20846832</span></span>
<span id="cb349-53"><a href="principal-components.html#cb349-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; dupont  0.4698673 -0.09286987 -0.4675066 -0.68793190  0.28069055</span></span>
<span id="cb349-54"><a href="principal-components.html#cb349-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; carbide 0.5473322 -0.65401929 -0.1140581  0.50045312 -0.09603973</span></span>
<span id="cb349-55"><a href="principal-components.html#cb349-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; exxon   0.2908932 -0.11267353  0.6099196 -0.43808002 -0.58203935</span></span>
<span id="cb349-56"><a href="principal-components.html#cb349-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; texaco  0.2842017  0.07103332  0.6168831  0.06227778  0.72784638</span></span>
<span id="cb349-57"><a href="principal-components.html#cb349-57" aria-hidden="true" tabindex="-1"></a><span class="co"># princomp calls loadings.</span></span>
<span id="cb349-58"><a href="principal-components.html#cb349-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb349-59"><a href="principal-components.html#cb349-59" aria-hidden="true" tabindex="-1"></a><span class="co"># first PC = overall average</span></span>
<span id="cb349-60"><a href="principal-components.html#cb349-60" aria-hidden="true" tabindex="-1"></a><span class="co"># second PC compares Allied to Carbide</span></span>
<span id="cb349-61"><a href="principal-components.html#cb349-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb349-62"><a href="principal-components.html#cb349-62" aria-hidden="true" tabindex="-1"></a><span class="do">## PCA with correlation</span></span>
<span id="cb349-63"><a href="principal-components.html#cb349-63" aria-hidden="true" tabindex="-1"></a><span class="co">#same as scale(stock) %&gt;% prcomp</span></span>
<span id="cb349-64"><a href="principal-components.html#cb349-64" aria-hidden="true" tabindex="-1"></a>cor_pca <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(stock, <span class="at">scale =</span> T)</span>
<span id="cb349-65"><a href="principal-components.html#cb349-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb349-66"><a href="principal-components.html#cb349-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb349-67"><a href="principal-components.html#cb349-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb349-68"><a href="principal-components.html#cb349-68" aria-hidden="true" tabindex="-1"></a><span class="co"># eigen values</span></span>
<span id="cb349-69"><a href="principal-components.html#cb349-69" aria-hidden="true" tabindex="-1"></a>cor_results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">eigen_values =</span> cor_pca<span class="sc">$</span>sdev <span class="sc">^</span> <span class="dv">2</span>)</span>
<span id="cb349-70"><a href="principal-components.html#cb349-70" aria-hidden="true" tabindex="-1"></a>cor_results <span class="sc">%&gt;%</span></span>
<span id="cb349-71"><a href="principal-components.html#cb349-71" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">proportion =</span> eigen_values <span class="sc">/</span> <span class="fu">sum</span>(eigen_values),</span>
<span id="cb349-72"><a href="principal-components.html#cb349-72" aria-hidden="true" tabindex="-1"></a>           <span class="at">cumulative =</span> <span class="fu">cumsum</span>(proportion))</span>
<span id="cb349-73"><a href="principal-components.html#cb349-73" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   eigen_values proportion cumulative</span></span>
<span id="cb349-74"><a href="principal-components.html#cb349-74" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1    2.8564869 0.57129738  0.5712974</span></span>
<span id="cb349-75"><a href="principal-components.html#cb349-75" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2    0.8091185 0.16182370  0.7331211</span></span>
<span id="cb349-76"><a href="principal-components.html#cb349-76" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3    0.5400440 0.10800880  0.8411299</span></span>
<span id="cb349-77"><a href="principal-components.html#cb349-77" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4    0.4513468 0.09026936  0.9313992</span></span>
<span id="cb349-78"><a href="principal-components.html#cb349-78" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5    0.3430038 0.06860076  1.0000000</span></span>
<span id="cb349-79"><a href="principal-components.html#cb349-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb349-80"><a href="principal-components.html#cb349-80" aria-hidden="true" tabindex="-1"></a><span class="co"># first egiven values corresponds to less variance than PCA based on the covariance matrix</span></span>
<span id="cb349-81"><a href="principal-components.html#cb349-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb349-82"><a href="principal-components.html#cb349-82" aria-hidden="true" tabindex="-1"></a><span class="co"># eigen vectors</span></span>
<span id="cb349-83"><a href="principal-components.html#cb349-83" aria-hidden="true" tabindex="-1"></a>cor_pca<span class="sc">$</span>rotation</span>
<span id="cb349-84"><a href="principal-components.html#cb349-84" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;               PC1        PC2        PC3        PC4        PC5</span></span>
<span id="cb349-85"><a href="principal-components.html#cb349-85" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; allied  0.4635405 -0.2408499  0.6133570 -0.3813727  0.4532876</span></span>
<span id="cb349-86"><a href="principal-components.html#cb349-86" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; dupont  0.4570764 -0.5090997 -0.1778996 -0.2113068 -0.6749814</span></span>
<span id="cb349-87"><a href="principal-components.html#cb349-87" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; carbide 0.4699804 -0.2605774 -0.3370355  0.6640985  0.3957247</span></span>
<span id="cb349-88"><a href="principal-components.html#cb349-88" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; exxon   0.4216770  0.5252647 -0.5390181 -0.4728036  0.1794482</span></span>
<span id="cb349-89"><a href="principal-components.html#cb349-89" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; texaco  0.4213291  0.5822416  0.4336029  0.3812273 -0.3874672</span></span>
<span id="cb349-90"><a href="principal-components.html#cb349-90" aria-hidden="true" tabindex="-1"></a><span class="co"># interpretation of PC2 is different from above: it is a comparison of Allied, Dupont and Carbid to Exxon and Texaco </span></span></code></pre></div>
<p>Covid Example</p>
<p>To reduce collinearity problem in this dataset, we can use principal components as regressors.</p>
<div class="sourceCode" id="cb350"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb350-1"><a href="principal-components.html#cb350-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&#39;images/MOcovid.RData&#39;</span>)</span>
<span id="cb350-2"><a href="principal-components.html#cb350-2" aria-hidden="true" tabindex="-1"></a>covidpca <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(ndat[,<span class="sc">-</span><span class="dv">1</span>],<span class="at">scale =</span> T,<span class="at">center =</span> T)</span>
<span id="cb350-3"><a href="principal-components.html#cb350-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb350-4"><a href="principal-components.html#cb350-4" aria-hidden="true" tabindex="-1"></a>covidpca<span class="sc">$</span>rotation[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span>
<span id="cb350-5"><a href="principal-components.html#cb350-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                                          PC1         PC2</span></span>
<span id="cb350-6"><a href="principal-components.html#cb350-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X..Population.in.Rural.Areas                      0.32865838  0.05090955</span></span>
<span id="cb350-7"><a href="principal-components.html#cb350-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Area..sq..miles.                                  0.12014444 -0.28579183</span></span>
<span id="cb350-8"><a href="principal-components.html#cb350-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Population.density..sq..miles.                   -0.29670124  0.28312922</span></span>
<span id="cb350-9"><a href="principal-components.html#cb350-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Literacy.rate                                    -0.12517700 -0.08999542</span></span>
<span id="cb350-10"><a href="principal-components.html#cb350-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Families                                         -0.25856941  0.16485752</span></span>
<span id="cb350-11"><a href="principal-components.html#cb350-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Area.of.farm.land..sq..miles.                     0.02101106 -0.31070363</span></span>
<span id="cb350-12"><a href="principal-components.html#cb350-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number.of.farms                                  -0.03814582 -0.44809679</span></span>
<span id="cb350-13"><a href="principal-components.html#cb350-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Average.value.of.all.property.per.farm..dollars. -0.05410709  0.14404306</span></span>
<span id="cb350-14"><a href="principal-components.html#cb350-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Estimation.of.rurality..                         -0.19040210  0.12089501</span></span>
<span id="cb350-15"><a href="principal-components.html#cb350-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Male..                                            0.02182394 -0.09568768</span></span>
<span id="cb350-16"><a href="principal-components.html#cb350-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number.of.Physcians.per.100.000                  -0.31451606  0.13598026</span></span>
<span id="cb350-17"><a href="principal-components.html#cb350-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; average.age                                       0.29414708  0.35593459</span></span>
<span id="cb350-18"><a href="principal-components.html#cb350-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X0.4.age.proportion                              -0.11431336 -0.23574057</span></span>
<span id="cb350-19"><a href="principal-components.html#cb350-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X20.44.age.proportion                            -0.32802128 -0.22718550</span></span>
<span id="cb350-20"><a href="principal-components.html#cb350-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X65.and.over.age.proportion                       0.30585033  0.32201626</span></span>
<span id="cb350-21"><a href="principal-components.html#cb350-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; prop..White..nonHisp                              0.35627561 -0.14142646</span></span>
<span id="cb350-22"><a href="principal-components.html#cb350-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; prop..Hispanic                                   -0.16655381 -0.15105342</span></span>
<span id="cb350-23"><a href="principal-components.html#cb350-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; prop..Black                                      -0.33333359  0.24405802</span></span>
<span id="cb350-24"><a href="principal-components.html#cb350-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb350-25"><a href="principal-components.html#cb350-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb350-26"><a href="principal-components.html#cb350-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb350-27"><a href="principal-components.html#cb350-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb350-28"><a href="principal-components.html#cb350-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Variability of each principal component: pr.var</span></span>
<span id="cb350-29"><a href="principal-components.html#cb350-29" aria-hidden="true" tabindex="-1"></a>pr.var <span class="ot">&lt;-</span> covidpca<span class="sc">$</span>sdev <span class="sc">^</span> <span class="dv">2</span></span>
<span id="cb350-30"><a href="principal-components.html#cb350-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Variance explained by each principal component: pve</span></span>
<span id="cb350-31"><a href="principal-components.html#cb350-31" aria-hidden="true" tabindex="-1"></a>pve <span class="ot">&lt;-</span> pr.var <span class="sc">/</span> <span class="fu">sum</span>(pr.var)</span>
<span id="cb350-32"><a href="principal-components.html#cb350-32" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb350-33"><a href="principal-components.html#cb350-33" aria-hidden="true" tabindex="-1"></a>    pve,</span>
<span id="cb350-34"><a href="principal-components.html#cb350-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">&quot;Principal Component&quot;</span>,</span>
<span id="cb350-35"><a href="principal-components.html#cb350-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">&quot;Proportion of Variance Explained&quot;</span>,</span>
<span id="cb350-36"><a href="principal-components.html#cb350-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>),</span>
<span id="cb350-37"><a href="principal-components.html#cb350-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">&quot;b&quot;</span></span>
<span id="cb350-38"><a href="principal-components.html#cb350-38" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="20-multivariate_files/figure-html/unnamed-chunk-15-1.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb351"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb351-1"><a href="principal-components.html#cb351-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb351-2"><a href="principal-components.html#cb351-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb351-3"><a href="principal-components.html#cb351-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cumsum</span>(pve),</span>
<span id="cb351-4"><a href="principal-components.html#cb351-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">&quot;Principal Component&quot;</span>,</span>
<span id="cb351-5"><a href="principal-components.html#cb351-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">&quot;Cumulative Proportion of Variance Explained&quot;</span>,</span>
<span id="cb351-6"><a href="principal-components.html#cb351-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb351-7"><a href="principal-components.html#cb351-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">&quot;b&quot;</span></span>
<span id="cb351-8"><a href="principal-components.html#cb351-8" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="20-multivariate_files/figure-html/unnamed-chunk-15-2.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb352"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb352-1"><a href="principal-components.html#cb352-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb352-2"><a href="principal-components.html#cb352-2" aria-hidden="true" tabindex="-1"></a><span class="co"># the first six principe account for around 80% of the variance. </span></span>
<span id="cb352-3"><a href="principal-components.html#cb352-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb352-4"><a href="principal-components.html#cb352-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb352-5"><a href="principal-components.html#cb352-5" aria-hidden="true" tabindex="-1"></a><span class="co">#using base lm function for PC regression</span></span>
<span id="cb352-6"><a href="principal-components.html#cb352-6" aria-hidden="true" tabindex="-1"></a>pcadat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(covidpca<span class="sc">$</span>x[, <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>])</span>
<span id="cb352-7"><a href="principal-components.html#cb352-7" aria-hidden="true" tabindex="-1"></a>pcadat<span class="sc">$</span>y <span class="ot">&lt;-</span> ndat<span class="sc">$</span>Y</span>
<span id="cb352-8"><a href="principal-components.html#cb352-8" aria-hidden="true" tabindex="-1"></a>pcr.man <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> ., pcadat)</span>
<span id="cb352-9"><a href="principal-components.html#cb352-9" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(pcr.man<span class="sc">$</span>residuals <span class="sc">^</span> <span class="dv">2</span>)</span>
<span id="cb352-10"><a href="principal-components.html#cb352-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.03453371</span></span>
<span id="cb352-11"><a href="principal-components.html#cb352-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb352-12"><a href="principal-components.html#cb352-12" aria-hidden="true" tabindex="-1"></a><span class="co">#comparison to lm w/o prin comps</span></span>
<span id="cb352-13"><a href="principal-components.html#cb352-13" aria-hidden="true" tabindex="-1"></a>lm.fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(Y) <span class="sc">~</span> ., <span class="at">data =</span> ndat)</span>
<span id="cb352-14"><a href="principal-components.html#cb352-14" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(lm.fit<span class="sc">$</span>residuals <span class="sc">^</span> <span class="dv">2</span>)</span>
<span id="cb352-15"><a href="principal-components.html#cb352-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.02335128</span></span></code></pre></div>
<p>MSE for the PC-based model is larger than regular regression, because models with a large degree of collinearity can still perform well.</p>
<p><code>pcr</code> function in <code>pls</code> can be used for fitting PC regression (it will select the optimal number of components in the model).</p>
<p><br></p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="manova.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="factor-analysis.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/mikenguyen13/data_analysis/edit/main/20-multivariate.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/mikenguyen13/data_analysis/blob/main/20-multivariate.Rmd",
"text": null
},
"download": ["data_analysis.pdf", "data_analysis.epub", "data_analysis.mobi"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true,
"sharing": {
"facebook": true,
"github": true,
"twitter": true,
"linkedin": true
},
"info": true,
"edit": "https://github.com/mikenguyen13/data_analysis/edit/main/%s"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
